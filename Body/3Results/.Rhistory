form=form[!is.na(form$TG_ACSkew),]
form=form[!is.na(form$TemperatureK),]
form$TG_ACSkew=form$TG_ACSkew * (-1)
form$x = (1/log(form$GenerationLength_d))*(log(form$TG_ACSkew)+0.2/((8.617*10^-5)*form$TemperatureK))
form$x = (1/log(form$GenerationLength_d))*(log(form$TG_ACSkew)+0.2/((8.617*10^-5)*form$TemperatureK))
form$x
summary(form$x)
form$x = log(form$TG_ACSkew * exp(0.62/((8.617*10^-5)*form$TemperatureK))) / log(bodymassgenlpred)
bodymassgenlpred=((form$GenerationLength_d/365)/(6.10*10^6))^(1/0.2)
form$x = log(form$TG_ACSkew * exp(0.62/((8.617*10^-5)*form$TemperatureK))) / log(bodymassgenlpred)
summary(form$x)
form$x
###################################
######
###################################
rm(list=ls(all=TRUE))
library(ggpubr)
############ Syn mut
unzip("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt.zip")
SynNuc = read.table("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
if (file.exists("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")) {file.remove("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")}
kuptsovtable = read.table("../../Body/2Derived/EcologyMammalianTable01_KuptsovA_ver2_Full.txt", sep='\t', header=TRUE)
SynNuc = SynNuc[SynNuc$Gene != 'ND6',]
SynNuc = aggregate(list(SynNuc$NeutralA,SynNuc$NeutralT,SynNuc$NeutralG,SynNuc$NeutralC), by = list(SynNuc$Species), FUN = sum)
names(SynNuc) = c('Species','NeutralA','NeutralT','NeutralG','NeutralC')
SynNuc$FrA = SynNuc$NeutralA / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
SynNuc$FrT = SynNuc$NeutralT / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
SynNuc$FrG = SynNuc$NeutralG / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
SynNuc$FrC = SynNuc$NeutralC / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
kuptsovtable$FrT= NULL
allparameters = merge(kuptsovtable, SynNuc, by="Species")
allparameters$Temper = as.numeric(gsub(",", ".", allparameters$Temperature.C._White2003.2006.other.close.species))
allparameters$GenerationLength_d = as.numeric(gsub(",", ".", allparameters$GenerationLength_d))
allparameters$TG = allparameters$FrT+allparameters$FrG
allparameters$AC = allparameters$FrA+allparameters$FrC
allparameters$TG_ACSkew = (allparameters$TG-allparameters$AC)/(allparameters$TG+allparameters$AC); summary(allparameters$TG_ACSkew)
allparameters$TtoCSkew = (allparameters$FrT-allparameters$FrC)/(allparameters$FrT+allparameters$FrC); summary(allparameters$TtoCSkew)
summary(lm(TG_ACSkew ~ scale(Temper)+scale(GenerationLength_d), data = allparameters))
summary(lm(TG_ACSkew ~ log2(Temper)+log2(GenerationLength_d), data = allparameters))
summary(lm(TtoCSkew ~ scale(Temper)+scale(GenerationLength_d), data = allparameters))
summary(allparameters$Temper)
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(Hib), data = allparameters))
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(Hib.unconfirmedHib), data = allparameters))
ltest = lm(formula = FrT ~ scale(GenerationLength_d)+scale(Daily), data = allparameters)
summary(ltest)
#######Lm ~ Daily
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(Daily.unconfirmedDaily), data = allparameters))
allparameters$MarsMono = allparameters$Mars + allparameters$Mono
table(allparameters$MarsMono)
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(MarsMono), data = allparameters))
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(Temper), data = allparameters))
#######Lm ~ cold
formediantemperature = allparameters[!is.na(allparameters$Temper),]$Temper
coldspeciesnames = allparameters[allparameters$Temper <= mean(formediantemperature) & !is.na(allparameters$Temper),]$Species
allparameters$colddummy = 0
allparameters[allparameters$Species %in% coldspeciesnames,]$colddummy = 1
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(colddummy), data = allparameters))
allparameters$allcolddummy = allparameters$Hib.unconfirmedHib + allparameters$Daily.unconfirmedDaily + allparameters$MarsMono + allparameters$colddummy
table(allparameters$allcolddummy)
allparameters[allparameters$allcolddummy > 0,]$allcolddummy = 1
summary(lm(formula = FrT ~ log2(GenerationLength_d)+scale(allcolddummy), data = allparameters))
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(allcolddummy), data = allparameters))
ltest = lm(formula = FrT  ~ log2(GenerationLength_d), data = allparameters)
summary(ltest)
allparameters$residuals = ltest$residuals ## residuals added
summary(lm(formula = TG_ACSkew ~ log2(GenerationLength_d)+scale(allcolddummy), data = allparameters))
summary(lm(formula = TG_ACSkew ~ scale(GenerationLength_d)+scale(allcolddummy), data = allparameters))
nrow(allparameters[!is.na(allparameters$Temper),]) #224
#################Lm ~ Xen
allparameters$Xen = 0
allparameters[allparameters$Superorder == "Xenarthra", ]$Xen = 1
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(Xen), data = allparameters))
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(Xen)+scale(allcolddummy), data = allparameters))
ltest = lm(formula = FrG ~ scale(GenerationLength_d), data = allparameters)
summary(ltest)
ltest = lm(formula = FrG ~ scale(GenerationLength_d)+scale(Hib.unconfirmedHib), data = allparameters)
summary(ltest)
ltest = lm(formula = FrG ~ scale(allcolddummy), data = allparameters)
summary(ltest)
ltest = lm(formula = FrG ~ scale(GenerationLength_d)*scale(allcolddummy), data = allparameters)
summary(ltest)
allparameters$TwoMammaliaGroups = as.character(allparameters$allcolddummy)
for (i in 1:nrow(allparameters)){
if(allparameters$TwoMammaliaGroups[i] == 0){
allparameters$TwoMammaliaGroups[i] = "Warmer mammals"
}else{
allparameters$TwoMammaliaGroups[i] = "Colder mammals"
}
}
pdf("../../Body/4Figures/WholeGenomeAnalyses.EcologyAndMutSpecChordata.Mammals.KuptsovData.TemperatureHist.pdf", width = 9, height = 5.5)
gghistogram(allparameters, x = "Temper", fill = "red", ylab = " ", xlab = "Body temperature, °C",
add = "mean", rug = TRUE)
dev.off()
ggscatter(allparameters, x = "GenerationLength_d", y = "TG_ACSkew",
color = "TwoMammaliaGroups", shape = "TwoMammaliaGroups",
palette = c("#08519c", "#de6a85"),
ellipse = TRUE,  add = "reg.line", xscale = "log2", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", )
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c")
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", xlab="Generation Length, log2", ylab="Fraction of A")
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew")
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 13.5))
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 13.5))
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew, col="#de6a85", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 13.5))
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 14))
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew, col="#de6a85", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 14))
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew, col="#de6a85", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew")
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew, col="#de6a85", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 14.5))
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 14.5))
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew, col="#de6a85", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 14.5))
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 14.5))
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew, col="#de6a85", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 14.5), ylim = c(-0.75, -0.25))
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 14.5), ylim = c(-0.75, -0.25))
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 14.5), ylim = c(-0.75, -0.25))
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 14.5), ylim = c(-0.75, -0.25))
par(new=TRUE)
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew, col="#de6a85", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 14.5), ylim = c(-0.75, -0.25))
summary(lm(formula = TG_ACSkew ~ scale(GenerationLength_d)+scale(allcolddummy), data = allparameters))
summary(lm(formula = TG_ACSkew ~ log2(GenerationLength_d)+scale(allcolddummy), data = allparameters))
summary(lm(formula = TG_ACSkew ~ log2(GenerationLength_d)+allcolddummy, data = allparameters))
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 14.5), ylim = c(-0.75, -0.25))
par(new=TRUE)
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew, col="#de6a85", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 14.5), ylim = c(-0.75, -0.25))
abline(-0.323919, -0.018255, col="#de6a85")
abline(-0.323919, -0.018255, col="#de6a85", lwd = 2)
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 14.5), ylim = c(-0.75, -0.25))
abline((-0.323919+0.043515), -0.018255, col="#de6a85", lwd = 2)
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 14.5), ylim = c(-0.75, -0.25))
abline((-0.323919+0.043515), -0.018255, col="#08519c", lwd = 2)
par(new=TRUE)
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew, col="#de6a85", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 14.5), ylim = c(-0.75, -0.25))
abline(-0.323919, -0.018255, col="#de6a85", lwd = 2)
pdf("../../Body/4Figures/WholeGenomeAnalyses.EcologyAndMutSpecChordata.Mammals.KuptsovData.FIGURE2B.withoutEllipse.pdf", width = 9, height = 5.5)
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 14.5), ylim = c(-0.75, -0.25))
abline((-0.323919+0.043515), -0.018255, col="#08519c", lwd = 2)
par(new=TRUE)
plot(log2(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$GenerationLength_d), allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew, col="#de6a85", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", xlim = c(8, 14.5), ylim = c(-0.75, -0.25))
abline(-0.323919, -0.018255, col="#de6a85", lwd = 2)
dev.off()
hist(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew)
hist(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, "#08519c")
hist(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c")
hist(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", breakes=100)
hist(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", breaks=100)
hist(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", breaks=70)
hist(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", breaks=70)
hist(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", breaks = 100)
hist(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", breaks = 50)
hist(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew, col="#08519c", breaks = 50)
par(mfrow = c(2,1))
hist(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", breaks = 50)
par(mfrow = c(2,1))
hist(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew, col="#de6a85", breaks = 50)
par(mfrow = c(2,1))
hist(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", breaks = 50)
hist(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew, col="#de6a85", breaks = 50)
par(mfrow = c(2,1))
hist(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", breaks = 50, xlim = c(-0.75, -0.25))
hist(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew, col="#de6a85", breaks = 50, xlim = c(-0.75, -0.25))
par(mfrow = c(2,1))
hist(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", breaks = 30, xlim = c(-0.75, -0.25))
hist(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew, col="#de6a85", breaks = 30, xlim = c(-0.75, -0.25))
breaks = seq(-0.75, -0.25, 0.02)
breaks
par(mfrow = c(2,1))
hist(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", breaks = breaks, xlim = c(-0.75, -0.25), ylim = c(0, 30))
hist(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew, col="#de6a85", breaks = breaks, xlim = c(-0.75, -0.25), ylim = c(0, 30))
breaks = seq(-0.75, -0.25, 0.01)
par(mfrow = c(2,1))
hist(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", breaks = breaks, xlim = c(-0.75, -0.25), ylim = c(0, 30))
hist(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew, col="#de6a85", breaks = breaks, xlim = c(-0.75, -0.25), ylim = c(0, 30))
#par(mfrow = c(2,1))
hist(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew, col="#de6a85", breaks = breaks, xlim = c(-0.75, -0.25), ylim = c(0, 30))
par(new=TRUE)
hist(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew, col="#08519c", breaks = breaks, xlim = c(-0.75, -0.25), ylim = c(0, 30))
density(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew, col="#de6a85", breaks = breaks, xlim = c(-0.75, -0.25), ylim = c(0, 30))
density(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew)
plot(density(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew))
plot(density(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew), col="#de6a85")
plot(density(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew), col="#08519c")
plot(density(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew), col="#de6a85")
par(new=TRUE)
plot(density(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew), col="#08519c")
plot(density(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew), col="#de6a85")
plot(density(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew), col="#de6a85", xlim = c(-0.75, -0.25), ylim = c(0, 4))
par(new=TRUE)
plot(density(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew), col="#08519c", xlim = c(-0.75, -0.25), ylim = c(0, 4))
plot(density(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew), col="#de6a85", xlim = c(-0.75, -0.25), ylim = c(0, 6))
par(new=TRUE)
plot(density(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew), col="#08519c", xlim = c(-0.75, -0.25), ylim = c(0, 6))
pdf("../../Body/4Figures/WholeGenomeAnalyses.EcologyAndMutSpecChordata.Mammals.KuptsovData.FIGURE2C.pdf", width = 9, height = 5.5)
plot(density(allparameters[allparameters$TwoMammaliaGroups == "Warmer mammals",]$TG_ACSkew), col="#de6a85", xlim = c(-0.75, -0.25), ylim = c(0, 6))
par(new=TRUE)
plot(density(allparameters[allparameters$TwoMammaliaGroups == "Colder mammals",]$TG_ACSkew), col="#08519c", xlim = c(-0.75, -0.25), ylim = c(0, 6))
dev.off()
plot(allparameters[allparameters$GLgroups == "LongGL",]$Temper, allparameters[allparameters$GLgroups == "LongGL",]$TG_ACSkew*-1, col="#121d2e", xlab="Temperature", ylab="STG-SAC", xlim = c(0, 41), ylim = c (0.1, 0.75),  pch = 16)
abline(0.362350, 0.004390, col="black", lwd = 2)
par(new=TRUE)
plot(allparameters[allparameters$GLgroups == "ShortGL",]$Temper, allparameters[allparameters$GLgroups == "ShortGL",]$TG_ACSkew*-1, col="#d7badb", xlab=" ", ylab="", xlim = c(0, 41), ylim = c (0.1, 0.75),  pch = 16)
abline((0.362350-0.043854), 0.004390, col="#d7badb", lwd = 2)
par(new=TRUE)
plot(temp[temp$Lifespan == "ShortMaturated",]$Temperature, temp[temp$Lifespan == "ShortMaturated",]$TG_ACSkew*-1, col="#4da36c", xlab=" ", ylab="  ", xlim = c(0, 41), ylim = c(0.1, 0.75),  pch = 16)
abline((0.272616+0.006709 ), 0.006184 , col="#4da36c", lwd = 2)
par(new=TRUE)
plot(temp[temp$Lifespan == "LongMaturated",]$Temperature, temp[temp$Lifespan == "LongMaturated",]$TG_ACSkew*-1, col="#42cbf5", xlab=" ", ylab= "", xlim = c(0, 41), ylim = c(0.1, 0.75),  pch = 16)
abline(0.272616, 0.006184 , col="#42cbf5", lwd = 2)
legend(1, 95, legend=c("LongGL", "ShortGL", "ShortMaturated","LongMaturated"), col=c("black", "#d7badb", "#4da36c", "#4da36c"))
legend(1, 95, legend=c("LongGL", "ShortGL", "ShortMaturated","LongMaturated"), col=c("black", "#d7badb", "#4da36c", "#4da36c"), pch = 16)
par(new=TRUE)
legend(1, 95, legend=c("LongGL", "ShortGL", "ShortMaturated","LongMaturated"), col=c("black", "#d7badb", "#4da36c", "#4da36c"), pch = 16)
plot(allparameters[allparameters$GLgroups == "LongGL",]$Temper, allparameters[allparameters$GLgroups == "LongGL",]$TG_ACSkew*-1, col="#121d2e", xlab="Temperature", ylab="STG-SAC", xlim = c(0, 41), ylim = c (0.1, 0.75),  pch = 16)
legend(1, 95, legend=c("LongGL", "ShortGL", "ShortMaturated","LongMaturated"), col=c("black", "#d7badb", "#4da36c", "#4da36c"), pch = 16)
###################################
######
###################################
rm(list=ls(all=TRUE))
library(ggpubr)
############ Syn mut
unzip("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt.zip")
SynNuc = read.table("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
if (file.exists("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")) {file.remove("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")}
kuptsovtable = read.table("../../Body/2Derived/EcologyMammalianTable01_KuptsovA_ver2_Full.txt", sep='\t', header=TRUE)
SynNuc = SynNuc[SynNuc$Gene != 'ND6',]
SynNuc = aggregate(list(SynNuc$NeutralA,SynNuc$NeutralT,SynNuc$NeutralG,SynNuc$NeutralC), by = list(SynNuc$Species), FUN = sum)
names(SynNuc) = c('Species','NeutralA','NeutralT','NeutralG','NeutralC')
SynNuc$FrA = SynNuc$NeutralA / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
SynNuc$FrT = SynNuc$NeutralT / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
SynNuc$FrG = SynNuc$NeutralG / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
SynNuc$FrC = SynNuc$NeutralC / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
kuptsovtable$FrT= NULL
allparameters = merge(kuptsovtable, SynNuc, by="Species")
allparameters$Temper = as.numeric(gsub(",", ".", allparameters$Temperature.C._White2003.2006.other.close.species))
allparameters$GenerationLength_d = as.numeric(gsub(",", ".", allparameters$GenerationLength_d))
allparameters$TG = allparameters$FrT+allparameters$FrG
allparameters$AC = allparameters$FrA+allparameters$FrC
allparameters$TG_ACSkew = (allparameters$TG-allparameters$AC)/(allparameters$TG+allparameters$AC); summary(allparameters$TG_ACSkew)
allparameters$TtoCSkew = (allparameters$FrT-allparameters$FrC)/(allparameters$FrT+allparameters$FrC); summary(allparameters$TtoCSkew)
summary(lm(TG_ACSkew ~ scale(Temper)+scale(GenerationLength_d), data = allparameters))
summary(lm(TG_ACSkew ~ log2(Temper)+log2(GenerationLength_d), data = allparameters))
summary(lm(TtoCSkew ~ scale(Temper)+scale(GenerationLength_d), data = allparameters))
summary(allparameters$Temper)
#Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's
#30.70   35.90   37.00   36.80   38.08   40.10     425
#######Lm ~ hiber
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(Hib), data = allparameters))
#######Lm ~ Hib.unconfirmedHib
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(Hib.unconfirmedHib), data = allparameters))
#######Lm ~ Daily
ltest = lm(formula = FrT ~ scale(GenerationLength_d)+scale(Daily), data = allparameters)
summary(ltest)
#######Lm ~ Daily
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(Daily.unconfirmedDaily), data = allparameters))
#######Lm ~ MarsMono
allparameters$MarsMono = allparameters$Mars + allparameters$Mono
table(allparameters$MarsMono)
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(MarsMono), data = allparameters))
#######Lm ~ Temperature
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(Temper), data = allparameters))
#######Lm ~ cold
formediantemperature = allparameters[!is.na(allparameters$Temper),]$Temper
coldspeciesnames = allparameters[allparameters$Temper <= mean(formediantemperature) & !is.na(allparameters$Temper),]$Species
allparameters$colddummy = 0
allparameters[allparameters$Species %in% coldspeciesnames,]$colddummy = 1
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(colddummy), data = allparameters))
#######Lm ~ allcold
allparameters$allcolddummy = allparameters$Hib.unconfirmedHib + allparameters$Daily.unconfirmedDaily + allparameters$MarsMono + allparameters$colddummy
table(allparameters$allcolddummy)
allparameters[allparameters$allcolddummy > 0,]$allcolddummy = 1
summary(lm(formula = FrT ~ log2(GenerationLength_d)+scale(allcolddummy), data = allparameters))
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(allcolddummy), data = allparameters))
ltest = lm(formula = FrT  ~ log2(GenerationLength_d), data = allparameters)
summary(ltest)
allparameters$residuals = ltest$residuals ## residuals added
summary(lm(formula = TG_ACSkew ~ log2(GenerationLength_d)+allcolddummy, data = allparameters))
summary(lm(formula = TG_ACSkew ~ scale(GenerationLength_d)+scale(allcolddummy), data = allparameters))
summary(lm(formula = TG_ACSkew ~ GenerationLength_d+allcolddummy, data = allparameters))
nrow(allparameters[!is.na(allparameters$Temper),]) #224
#################Lm ~ Xen
allparameters$Xen = 0
allparameters[allparameters$Superorder == "Xenarthra", ]$Xen = 1
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(Xen), data = allparameters))
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(Xen)+scale(allcolddummy), data = allparameters))
##############################
####Fraction G
##############################
ltest = lm(formula = FrG ~ scale(GenerationLength_d), data = allparameters)
summary(ltest)
#######Lm ~ hiber
ltest = lm(formula = FrG ~ scale(GenerationLength_d)+scale(Hib.unconfirmedHib), data = allparameters)
summary(ltest)
#########Lm ~ allcold
ltest = lm(formula = FrG ~ scale(allcolddummy), data = allparameters)
summary(ltest)
ltest = lm(formula = FrG ~ scale(GenerationLength_d)*scale(allcolddummy), data = allparameters)
summary(ltest)
allparameters$TwoMammaliaGroups = as.character(allparameters$allcolddummy)
for (i in 1:nrow(allparameters)){
if(allparameters$TwoMammaliaGroups[i] == 0){
allparameters$TwoMammaliaGroups[i] = "Warmer mammals"
}else{
allparameters$TwoMammaliaGroups[i] = "Colder mammals"
}
}
pdf("../../Body/4Figures/WholeGenomeAnalyses.EcologyAndMutSpecChordata.Mammals.KuptsovData.TemperatureHist.pdf", width = 9, height = 5.5)
gghistogram(allparameters, x = "Temper", fill = "red", ylab = " ", xlab = "Body temperature, °C",
add = "mean", rug = TRUE)
dev.off()
pdf("../../Body/4Figures/WholeGenomeAnalyses.EcologyAndMutSpecChordata.Mammals.KuptsovData.FIGURE2D.pdf", width = 9, height = 5.5)
ggscatter(allparameters, x = "GenerationLength_d", y = "FrT",
color = "TwoMammaliaGroups", shape = "TwoMammaliaGroups",
palette = c("#08519c", "#de6a85"),
ellipse = TRUE,  xscale = "log2", xlab="Generation Length, log2", ylab="Fraction of A")
dev.off()
pdf("../../Body/4Figures/WholeGenomeAnalyses.EcologyAndMutSpecChordata.Mammals.KuptsovData.FIGURE2E.pdf", width = 9, height = 5.5)
ggscatter(allparameters, x = "GenerationLength_d", y = "TG_ACSkew",
color = "TwoMammaliaGroups", shape = "TwoMammaliaGroups",
palette = c("#08519c", "#de6a85"),
ellipse = TRUE,  add = "reg.line", xscale = "log2", xlab="Generation Length, log2", ylab="Fraction of AC_TCSkew", )
dev.off()
colfunc<-colorRampPalette(c("red","yellow","springgreen","royalblue"))
plot(allparameters$Temper, allparameters$GenerationLength_d, col="#42cbf5", xlab="Temperature", ylab="GL, days", pch = 1, cex = (allparameters$TG_ACSkew*-7), ylim = c(0, 11000))
medGL = median(allparameters$GenerationLength_d)
allparameters$GLgroups = "LongGL"
allparameters[allparameters$GenerationLength_d < medGL,]$GLgroups = "ShortGL"
allparameters$DummyGL = 0
allparameters[allparameters$GenerationLength_d < medGL,]$DummyGL = 1
###################################
rm(list=ls(all=TRUE))
library(ggpubr)
setwd("../../Body/3Results")
unzip("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt.zip")
SynNuc = read.table("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
if (file.exists("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")) {file.remove("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")}
# SynNuc = read.table("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt", header = TRUE)
names(SynNuc)
SynNuc = SynNuc[SynNuc$Gene != 'ND6',]
SynNuc = aggregate(list(SynNuc$NeutralA,SynNuc$NeutralT,SynNuc$NeutralG,SynNuc$NeutralC), by = list(SynNuc$Species), FUN = sum)
names(SynNuc) = c('Species','NeutralA','NeutralT','NeutralG','NeutralC')
SynNuc$FrA = SynNuc$NeutralA / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
SynNuc$FrT = SynNuc$NeutralT / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
SynNuc$FrG = SynNuc$NeutralG / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
SynNuc$FrC = SynNuc$NeutralC / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
### merge with temperature
TEMPE = read.table('../../Body/1Raw/FishBaseTemperature.txt', header = TRUE)
TEMPE = aggregate(Temperature ~ ., median, data = TEMPE); summary(TEMPE$Temperature)
SynNuc = merge(TEMPE,SynNuc, by = 'Species', all = TRUE); summary(SynNuc$Temperature)
###### merge with fishbase maturation
MATUTM = read.table('../../Body/1Raw/FishBaseMaturity_Tm.txt',  header = TRUE)
MATUTM = aggregate(Tm ~ ., median, data = MATUTM)
SynNuc = merge(MATUTM,SynNuc, by = 'Species', all = TRUE); nrow(SynNuc)
SynNuc$CtoTSkew = (SynNuc$FrC-SynNuc$FrT)/(SynNuc$FrC+SynNuc$FrT); summary(SynNuc$CtoTSkew)
SynNuc$GtoASkew = (SynNuc$FrG-SynNuc$FrA)/(SynNuc$FrG+SynNuc$FrA); summary(SynNuc$GtoASkew)
SynNuc$AtoGSkew = (SynNuc$FrA-SynNuc$FrG)/(SynNuc$FrA+SynNuc$FrG); summary(SynNuc$AtoGSkew)
SynNuc$TtoCSkew = (SynNuc$FrT-SynNuc$FrC)/(SynNuc$FrT+SynNuc$FrC); summary(SynNuc$TtoCSkew)
SynNuc$TG = SynNuc$FrT+SynNuc$FrG
SynNuc$AC = SynNuc$FrA+SynNuc$FrC
SynNuc$TG_ACSkew = (SynNuc$TG-SynNuc$AC)/(SynNuc$TG+SynNuc$AC); summary(SynNuc$TG_ACSkew)
summary(SynNuc$TG_ACSkew *-1)
### ANALYSES:
summary(SynNuc$Temperature)
summary(SynNuc$Tm)
summary(lm(FrT ~ scale(Temperature)+scale(Tm), data = SynNuc))
summary(lm(FrT ~ log2(Temperature + 2)*log2(Tm), data = SynNuc))  # keep it for presentation!!!
summary(lm(FrT ~ log2(Temperature + 2)+log2(Tm), data = SynNuc))
summary(lm(FrG ~ log2(Temperature + 2)+log2(Tm), data = SynNuc)) # strong
summary(lm(FrA ~ log2(Temperature + 2)+log2(Tm), data = SynNuc)) # strong
summary(lm(GtoASkew ~ log2(Temperature + 2)+log2(Tm), data = SynNuc)) # the highest R^2 = 0.17
summary(lm(CtoTSkew ~ log2(Temperature + 2)+log2(Tm), data = SynNuc))
summary(lm(TtoCSkew ~ log2(Temperature + 2)+log2(Tm), data = SynNuc))
summary(lm(TG_ACSkew ~ log2(Temperature + 2)+log2(Tm), data = SynNuc))
summary(lm(TG_ACSkew ~ scale(Temperature + 2)+scale(Tm), data = SynNuc))
summary(lm(-TG_ACSkew ~ Temperature + Tm, data = SynNuc))
summary(lm(TG_ACSkew ~ Temperature * Tm, data = SynNuc))
#xlim = c(8, 14.5), ylim = c(-0.75, -0.25)
medianTm = median(SynNuc[!is.na(SynNuc$Tm),]$Tm)
SynNuc$Lifespan = "Na"
for (i in 1:nrow(SynNuc)){
if (SynNuc$Tm[i] < medianTm & !is.na(SynNuc$Tm[i])){
SynNuc$Lifespan[i] = "ShortMaturated"
}
if (SynNuc$Tm[i] > medianTm & !is.na(SynNuc$Tm[i])){
SynNuc$Lifespan[i] = "LongMaturated"
}
}
temp = SynNuc[!SynNuc$Lifespan == "Na",]
plot(allparameters[allparameters$GLgroups == "LongGL",]$Temper, allparameters[allparameters$GLgroups == "LongGL",]$TG_ACSkew*-1, col="#121d2e", xlab="Temperature", ylab="STG-SAC", xlim = c(0, 41), ylim = c (0.1, 0.75),  pch = 16)
medGL = median(allparameters$GenerationLength_d)
allparameters$GLgroups = "LongGL"
allparameters[allparameters$GenerationLength_d < medGL,]$GLgroups = "ShortGL"
allparameters$DummyGL = 0
allparameters[allparameters$GenerationLength_d < medGL,]$DummyGL = 1
plot(allparameters[allparameters$GLgroups == "LongGL",]$Temper, allparameters[allparameters$GLgroups == "LongGL",]$TG_ACSkew*-1, col="#121d2e", xlab="Temperature", ylab="STG-SAC", xlim = c(0, 41), ylim = c (0.1, 0.75),  pch = 16)
############ Syn mut
unzip("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt.zip")
SynNuc = read.table("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
if (file.exists("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")) {file.remove("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")}
kuptsovtable = read.table("../../Body/2Derived/EcologyMammalianTable01_KuptsovA_ver2_Full.txt", sep='\t', header=TRUE)
SynNuc = SynNuc[SynNuc$Gene != 'ND6',]
SynNuc = aggregate(list(SynNuc$NeutralA,SynNuc$NeutralT,SynNuc$NeutralG,SynNuc$NeutralC), by = list(SynNuc$Species), FUN = sum)
names(SynNuc) = c('Species','NeutralA','NeutralT','NeutralG','NeutralC')
SynNuc$FrA = SynNuc$NeutralA / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
SynNuc$FrT = SynNuc$NeutralT / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
SynNuc$FrG = SynNuc$NeutralG / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
SynNuc$FrC = SynNuc$NeutralC / (SynNuc$NeutralA + SynNuc$NeutralT + SynNuc$NeutralG + SynNuc$NeutralC)
kuptsovtable$FrT= NULL
allparameters = merge(kuptsovtable, SynNuc, by="Species")
allparameters$Temper = as.numeric(gsub(",", ".", allparameters$Temperature.C._White2003.2006.other.close.species))
allparameters$GenerationLength_d = as.numeric(gsub(",", ".", allparameters$GenerationLength_d))
allparameters$TG = allparameters$FrT+allparameters$FrG
allparameters$AC = allparameters$FrA+allparameters$FrC
allparameters$TG_ACSkew = (allparameters$TG-allparameters$AC)/(allparameters$TG+allparameters$AC); summary(allparameters$TG_ACSkew)
allparameters$TtoCSkew = (allparameters$FrT-allparameters$FrC)/(allparameters$FrT+allparameters$FrC); summary(allparameters$TtoCSkew)
summary(lm(TG_ACSkew ~ scale(Temper)+scale(GenerationLength_d), data = allparameters))
summary(lm(TG_ACSkew ~ log2(Temper)+log2(GenerationLength_d), data = allparameters))
summary(lm(TtoCSkew ~ scale(Temper)+scale(GenerationLength_d), data = allparameters))
summary(allparameters$Temper)
#Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's
#30.70   35.90   37.00   36.80   38.08   40.10     425
#######Lm ~ hiber
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(Hib), data = allparameters))
#######Lm ~ Hib.unconfirmedHib
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(Hib.unconfirmedHib), data = allparameters))
#######Lm ~ Daily
ltest = lm(formula = FrT ~ scale(GenerationLength_d)+scale(Daily), data = allparameters)
summary(ltest)
#######Lm ~ Daily
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(Daily.unconfirmedDaily), data = allparameters))
#######Lm ~ MarsMono
allparameters$MarsMono = allparameters$Mars + allparameters$Mono
table(allparameters$MarsMono)
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(MarsMono), data = allparameters))
#######Lm ~ Temperature
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(Temper), data = allparameters))
#######Lm ~ cold
formediantemperature = allparameters[!is.na(allparameters$Temper),]$Temper
coldspeciesnames = allparameters[allparameters$Temper <= mean(formediantemperature) & !is.na(allparameters$Temper),]$Species
allparameters$colddummy = 0
allparameters[allparameters$Species %in% coldspeciesnames,]$colddummy = 1
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(colddummy), data = allparameters))
#######Lm ~ allcold
allparameters$allcolddummy = allparameters$Hib.unconfirmedHib + allparameters$Daily.unconfirmedDaily + allparameters$MarsMono + allparameters$colddummy
table(allparameters$allcolddummy)
allparameters[allparameters$allcolddummy > 0,]$allcolddummy = 1
summary(lm(formula = FrT ~ log2(GenerationLength_d)+scale(allcolddummy), data = allparameters))
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(allcolddummy), data = allparameters))
ltest = lm(formula = FrT  ~ log2(GenerationLength_d), data = allparameters)
summary(ltest)
allparameters$residuals = ltest$residuals ## residuals added
summary(lm(formula = TG_ACSkew ~ log2(GenerationLength_d)+allcolddummy, data = allparameters))
summary(lm(formula = TG_ACSkew ~ scale(GenerationLength_d)+scale(allcolddummy), data = allparameters))
summary(lm(formula = TG_ACSkew ~ GenerationLength_d+allcolddummy, data = allparameters))
nrow(allparameters[!is.na(allparameters$Temper),]) #224
#################Lm ~ Xen
allparameters$Xen = 0
allparameters[allparameters$Superorder == "Xenarthra", ]$Xen = 1
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(Xen), data = allparameters))
summary(lm(formula = FrT ~ scale(GenerationLength_d)+scale(Xen)+scale(allcolddummy), data = allparameters))
##############################
####Fraction G
##############################
ltest = lm(formula = FrG ~ scale(GenerationLength_d), data = allparameters)
summary(ltest)
#######Lm ~ hiber
ltest = lm(formula = FrG ~ scale(GenerationLength_d)+scale(Hib.unconfirmedHib), data = allparameters)
summary(ltest)
#########Lm ~ allcold
ltest = lm(formula = FrG ~ scale(allcolddummy), data = allparameters)
summary(ltest)
ltest = lm(formula = FrG ~ scale(GenerationLength_d)*scale(allcolddummy), data = allparameters)
summary(ltest)
allparameters$TwoMammaliaGroups = as.character(allparameters$allcolddummy)
for (i in 1:nrow(allparameters)){
if(allparameters$TwoMammaliaGroups[i] == 0){
allparameters$TwoMammaliaGroups[i] = "Warmer mammals"
}else{
allparameters$TwoMammaliaGroups[i] = "Colder mammals"
}
}
medGL = median(allparameters$GenerationLength_d)
allparameters$GLgroups = "LongGL"
allparameters[allparameters$GenerationLength_d < medGL,]$GLgroups = "ShortGL"
allparameters$DummyGL = 0
allparameters[allparameters$GenerationLength_d < medGL,]$DummyGL = 1
plot(allparameters[allparameters$GLgroups == "LongGL",]$Temper, allparameters[allparameters$GLgroups == "LongGL",]$TG_ACSkew*-1, col="#121d2e", xlab="Temperature", ylab="STG-SAC", xlim = c(0, 41), ylim = c (0.1, 0.75),  pch = 16)
abline(0.362350, 0.004390, col="black", lwd = 2)
par(new=TRUE)
plot(allparameters[allparameters$GLgroups == "ShortGL",]$Temper, allparameters[allparameters$GLgroups == "ShortGL",]$TG_ACSkew*-1, col="#d7badb", xlab=" ", ylab="", xlim = c(0, 41), ylim = c (0.1, 0.75),  pch = 16)
abline((0.362350-0.043854), 0.004390, col="#d7badb", lwd = 2)
par(new=TRUE)
plot(temp[temp$Lifespan == "ShortMaturated",]$Temperature, temp[temp$Lifespan == "ShortMaturated",]$TG_ACSkew*-1, col="#4da36c", xlab=" ", ylab="  ", xlim = c(0, 41), ylim = c(0.1, 0.75),  pch = 16)
abline((0.272616+0.006709 ), 0.006184 , col="#4da36c", lwd = 2)
par(new=TRUE)
plot(temp[temp$Lifespan == "LongMaturated",]$Temperature, temp[temp$Lifespan == "LongMaturated",]$TG_ACSkew*-1, col="#42cbf5", xlab=" ", ylab= "", xlim = c(0, 41), ylim = c(0.1, 0.75),  pch = 16)
abline(0.272616, 0.006184 , col="#42cbf5", lwd = 2)
legend(1, 95, legend=c("LongGL", "ShortGL", "ShortMaturated","LongMaturated"), col=c("black", "#d7badb", "#4da36c", "#4da36c"), pch = 16)
legend(1, 2, legend=c("LongGL", "ShortGL", "ShortMaturated","LongMaturated"), col=c("black", "#d7badb", "#4da36c", "#4da36c"), pch = 16)
legend("bottomright", legend=c("LongGL", "ShortGL", "ShortMaturated","LongMaturated"), col=c("black", "#d7badb", "#4da36c", "#4da36c"), pch = c(15:18))
legend("bottomright", legend=c("LongGL", "ShortGL", "ShortMaturated","LongMaturated"), col=c("black", "#d7badb", "#4da36c", "#42cbf5"), pch = c(15:18))
legend("bottomright", legend=c("Mammals, Long GL", "Mammals, Short GL", "Fishes, Short TM","Fishes, Long TM"), col=c("black", "#d7badb", "#4da36c", "#42cbf5"), pch = c(15:18))
pdf("../../Body/4Figures/WholeGenomeAnalyses.EcologyAndMutSpecChordata.FIGURE.AllVertebrates.pdf", width = 10, height = 11)
plot(allparameters[allparameters$GLgroups == "LongGL",]$Temper, allparameters[allparameters$GLgroups == "LongGL",]$TG_ACSkew*-1, col="#121d2e", xlab="Temperature", ylab="STG-SAC", xlim = c(0, 41), ylim = c (0.1, 0.75),  pch = 16)
abline(0.362350, 0.004390, col="black", lwd = 2)
par(new=TRUE)
plot(allparameters[allparameters$GLgroups == "ShortGL",]$Temper, allparameters[allparameters$GLgroups == "ShortGL",]$TG_ACSkew*-1, col="#d7badb", xlab=" ", ylab="", xlim = c(0, 41), ylim = c (0.1, 0.75),  pch = 16)
abline((0.362350-0.043854), 0.004390, col="#d7badb", lwd = 2)
par(new=TRUE)
plot(temp[temp$Lifespan == "ShortMaturated",]$Temperature, temp[temp$Lifespan == "ShortMaturated",]$TG_ACSkew*-1, col="#4da36c", xlab=" ", ylab="  ", xlim = c(0, 41), ylim = c(0.1, 0.75),  pch = 16)
abline((0.272616+0.006709 ), 0.006184 , col="#4da36c", lwd = 2)
par(new=TRUE)
plot(temp[temp$Lifespan == "LongMaturated",]$Temperature, temp[temp$Lifespan == "LongMaturated",]$TG_ACSkew*-1, col="#42cbf5", xlab=" ", ylab= "", xlim = c(0, 41), ylim = c(0.1, 0.75),  pch = 16)
abline(0.272616, 0.006184 , col="#42cbf5", lwd = 2)
legend("bottomright", legend=c("Mammals, Long GL", "Mammals, Short GL", "Fishes, Short TM","Fishes, Long TM"), col=c("black", "#d7badb", "#4da36c", "#42cbf5"), pch = c(15:18))
dev.off()
