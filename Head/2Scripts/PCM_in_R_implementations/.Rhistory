flying_tree = read.tree('flying_birds_tree.tre')
name.check(flying_tree, df_flight)
df_flight$ability_to_fly = as.character(df_flight$ability_to_fly)
df_flight$GhAhSkew = as.numeric(as.character(df_flight$GhAhSkew))
df_flight$fAn = as.numeric(as.character(df_flight$fAn))
df_flight$fGn = as.numeric(as.character(df_flight$fGn))
df_flight$flight_num = as.numeric(as.character(df_flight$flight_num))
df_fly_peng = df_flight[df_flight$ability_to_fly == 'Flying' | df_flight$ability_to_fly =='Sphenisciformes',]
df_fly_not = df_flight[df_flight$ability_to_fly !='Sphenisciformes',]
peng_fly_tree = read.tree('flying_and_peng.tre')
no_peng_fly_tree = read.tree('flying_and_no_peng.tre')
spp = rownames(df_fly_peng)
corBM = corBrownian(phy=peng_fly_tree,form=~spp)
pgls_flying = gls(GhAhSkew~ability_to_fly,
data=df_fly_peng,correlation=corBM)
summary(pgls_flying)
anova(pgls_flying)
df_fly_not[df_fly_not$ability_to_fly != 'Flying',]$ability_to_fly = 'Non-flying'
spp = rownames(df_fly_not)
corBM = corBrownian(phy=no_peng_fly_tree,form=~spp)
#mutspec PGLS
df_mutspec = read.table('C:/Users/User/Desktop/mutspec12.tsv', header = TRUE, fill = TRUE)
df_ff = df_mutspec[df_mutspec$Label == 'ff',]
df_syn = df_mutspec[df_mutspec$Label == 'syn',]
df_ff = df_ff[!grepl('Node', df_ff$AltNode),]
df_ff = df_ff[,c(1,5,7)]
df_ff1 = reshape(data = df_ff, idvar = 'AltNode',
timevar = 'Mut',
direction = 'wide')
names(df_ff1) = c('species_name', 'Mutation_TG', 'Mutation_TC', 'Mutation_TA', 'Mutation_GT', 'Mutation_GC',
'Mutation_GA', 'Mutation_CT', 'Mutation_CG', 'Mutation_CA', 'Mutation_AT', 'Mutation_AG', 'Mutation_AC')
df_syn = df_syn[!grepl('Node', df_syn$AltNode),]
df_syn = df_syn[,c(1,5,7)]
df_syn1 = reshape(data = df_syn, idvar = 'AltNode',
timevar = 'Mut',
direction = 'wide')
names(df_syn1) = c('species_name', 'Mutation_TG_syn', 'Mutation_TC_syn', 'Mutation_TA_syn', 'Mutation_GT_syn', 'Mutation_GC_syn',
'Mutation_GA_syn', 'Mutation_CT_syn', 'Mutation_CG_syn', 'Mutation_CA_syn', 'Mutation_AT_syn', 'Mutation_AG_syn', 'Mutation_AC_syn')
df_fly_peng1 = merge(df_fly_peng, df_ff1)
df_fly_peng1 = merge(df_fly_peng1, df_syn1)
need_species = setdiff(df_fly_peng$species_name, df_fly_peng1$species_name)
correct_need_species = setdiff(df_fly_peng$species_name, need_species)
peng_fly_tree1<-keep.tip(peng_fly_tree,correct_need_species)
df_fly_peng1$Mutation_AG = as.numeric(df_fly_peng1$Mutation_AG)
df_fly_peng1$Mutation_AG_syn = as.numeric(df_fly_peng1$Mutation_AG_syn)
df_fly_peng1$Mutation_CT = as.numeric(df_fly_peng1$Mutation_CT)
df_fly_peng1$Mutation_CT_syn = as.numeric(df_fly_peng1$Mutation_CT_syn)
df_fly_peng1$ability_to_fly_binar = 0
df_fly_peng1[df_fly_peng1$ability_to_fly == 'Sphenisciformes',]$ability_to_fly_binar = 1
df_fly_peng1$ability_to_fly_binar_extra = 1
df_fly_peng1[df_fly_peng1$ability_to_fly == 'Sphenisciformes',]$ability_to_fly_binar_extra = 0
row.names(df_fly_peng1) = df_fly_peng1$species_name
df_fly_not1 = merge(df_fly_not, df_ff1)
df_fly_not1 = merge(df_fly_not1, df_syn1)
need_species = setdiff(df_fly_not$species_name, df_fly_not1$species_name)
correct_need_species = setdiff(df_fly_not$species_name, need_species)
not_fly_tree = read.tree('flying_and_no_peng.tre')
not_fly_tree1<-keep.tip(not_fly_tree,correct_need_species)
df_fly_not1$Mutation_AG = as.numeric(df_fly_not1$Mutation_AG)
df_fly_not1$Mutation_AG_syn = as.numeric(df_fly_not1$Mutation_AG_syn)
df_fly_not1$Mutation_CT = as.numeric(df_fly_not1$Mutation_CT)
df_fly_not1$Mutation_CT_syn = as.numeric(df_fly_not1$Mutation_CT_syn)
df_fly_not2 = df_fly_not1
df_fly_not2[df_fly_not2$ability_to_fly != 'Flying',]$ability_to_fly = 'Non-flying'
df_fly_not1$ability_to_fly_binar = 0
df_fly_not1[df_fly_not1$ability_to_fly != 'Flying',]$ability_to_fly_binar = 1
df_fly_not1$ability_to_fly_binar_extra = 1
df_fly_not1[df_fly_not1$ability_to_fly != 'Flying',]$ability_to_fly_binar_extra = 0
row.names(df_fly_not1) = df_fly_not1$species_name
spp2 = rownames(df_fly_not1)
#dive pgls
df_dive = read.csv('dive_and_gene.csv')
df_dive = df_dive[,c(2:6)]
dive_tree = read.tree('diving_birds_tree.tre')
row.names(df_dive) = df_dive$species_name
df_dive1 = merge(df_dive, df_syn1)
unique(df_dive1$ability_to_dive)
df_dive2 = df_dive1
df_dive1[df_dive1$ability_to_dive == 'Anseriformes',]$ability_to_dive = 'Diving_all_species'
df_dive1[df_dive1$ability_to_dive == "Sphenisciformes",]$ability_to_dive = 'Diving_all_species'
df_dive1[df_dive1$ability_to_dive == "Podicipediformes",]$ability_to_dive = 'Diving_all_species'
df_dive1[df_dive1$ability_to_dive == "Gaviiformes",]$ability_to_dive = 'Diving_all_species'
df_dive1[df_dive1$ability_to_dive == "Suliformes",]$ability_to_dive = 'Diving_all_species'
df_dive1[df_dive1$ability_to_dive == "Charadriiformes",]$ability_to_dive = 'Diving_some_species'
df_dive1[df_dive1$ability_to_dive == "Coraciiformes",]$ability_to_dive = 'Diving_some_species'
df_dive1[df_dive1$ability_to_dive == "Passeriformes",]$ability_to_dive = 'Diving_some_species'
df_dive1[df_dive1$ability_to_dive == "Procellariiformes",]$ability_to_dive = 'Diving_some_species'
df_dive1[df_dive1$ability_to_dive == "Gruiformes",]$ability_to_dive = 'Diving_some_species'
df_dive1$GhAhSkew = as.numeric(as.character(df_dive1$GhAhSkew))
df_dive1$Mutation_AG_syn = as.numeric(as.character(df_dive1$Mutation_AG_syn))
row.names(df_dive1) = df_dive1$species_name
need_species = setdiff(df_dive$species_name, df_dive1$species_name)
correct_need_species = setdiff(df_dive$species_name, need_species)
dive_tree1 = keep.tip(dive_tree,correct_need_species)
df_dive1$ability_to_dive_binar = 0
df_dive1[df_dive1$ability_to_dive != 'Non-diving',]$ability_to_dive_binar = 1
#TR_TS
df_tr_ts = read.csv('TR_TS_dataset.csv')
df_tr_ts = df_tr_ts[,c(2:19)]
df_tr_ts = df_tr_ts[,c(1,16:18)]
df_dive11 = df_dive1[df_dive1$ability_to_dive != 'Diving_some_species',]
row.names(df_dive11) = df_dive11$species_name
need_species = setdiff(df_dive1$species_name, df_dive11$species_name)
correct_need_species = setdiff(df_dive1$species_name, need_species)
dive_tree11 = keep.tip(dive_tree1,correct_need_species)
df_dive12 = df_dive1[df_dive1$ability_to_dive != 'Diving_all_species',]
row.names(df_dive12) = df_dive12$species_name
need_species = setdiff(df_dive1$species_name, df_dive12$species_name)
correct_need_species = setdiff(df_dive1$species_name, need_species)
dive_tree12 = keep.tip(dive_tree1,correct_need_species)
spp1 = rownames(df_fly_peng1)
corBM1 = corBrownian(phy=peng_fly_tree1,form=~spp1)
pgls_mt_peng = gls(GhAhSkew~ability_to_fly_binar_extra,
data=df_fly_peng1,correlation=corBM1)
summary(pgls_mt_peng)
df_fly_peng1_tr = merge(df_fly_peng1, df_tr_ts)
View(df_fly_peng1_tr)
spp1 = rownames(df_fly_peng1_tr)
corBM1 = corBrownian(phy=peng_fly_tree1,form=~spp1)
pgls_mt_peng = gls(TR_TS~ability_to_fly_binar,
data=df_fly_peng1_tr,correlation=corBM1)
df_fly_peng1_tr$TR_TS = as.numeric(df_fly_peng1_tr$TR_TS)
spp1 = rownames(df_fly_peng1_tr)
row.names(df_fly_peng1_tr) = df_fly_peng1_tr$species_name
spp1 = rownames(df_fly_peng1_tr)
corBM1 = corBrownian(phy=peng_fly_tree1,form=~spp1)
pgls_mt_peng = gls(TR_TS~ability_to_fly_binar,
data=df_fly_peng1_tr,correlation=corBM1)
#new PGLS for birds
rm(list = ls(all=TRUE))
library(phytools)
library(nlme)
library(geiger)
#flying birds
df_flight = read.csv('flight_and_gene.csv')
df_flight = df_flight[,c(2,3,4,5,6)]
df_flight$flight_num = 0
df_flight[df_flight$ability_to_fly != 'Flying',]$flight_num = 1
rownames(df_flight) = df_flight$species_name
flying_tree = read.tree('flying_birds_tree.tre')
name.check(flying_tree, df_flight)
df_flight$ability_to_fly = as.character(df_flight$ability_to_fly)
df_flight$GhAhSkew = as.numeric(as.character(df_flight$GhAhSkew))
df_flight$fAn = as.numeric(as.character(df_flight$fAn))
df_flight$fGn = as.numeric(as.character(df_flight$fGn))
df_flight$flight_num = as.numeric(as.character(df_flight$flight_num))
df_fly_peng = df_flight[df_flight$ability_to_fly == 'Flying' | df_flight$ability_to_fly =='Sphenisciformes',]
df_fly_not = df_flight[df_flight$ability_to_fly !='Sphenisciformes',]
peng_fly_tree = read.tree('flying_and_peng.tre')
no_peng_fly_tree = read.tree('flying_and_no_peng.tre')
View(df_fly_peng)
#new PGLS for birds
rm(list = ls(all=TRUE))
library(ape)
library(phangorn)
library(phytools)
library(geiger)
#birds_tree<-read.tree(file="../../2Scripts/PCM_in_R_implementations/anc_kg.treefile")
df_mtdna = read.csv('Birds_dataset_paper.csv')
df_realms = unique(df_mtdna[,c('species_name', 'realm')])
df_realms$species_name = gsub(' ', '_', df_realms$species_name)
#df_char3 = merge(df_char1, df_char2)
#df_char1$species_name = gsub(' ', '_', df_char1$species_name)
#df_char3$species_name = gsub(' ', '_', df_char3$species_name)
#df_char3 = na.omit(df_char3)
#need_species = setdiff(df_char1$species_name, df_char3$species_name)
#correct_need_species = setdiff(df_char1$species_name, need_species)
#temp_tree<-keep.tip(birds_tree,correct_need_species)
#temp_tree
#write.tree(temp_tree ,file="temperature_birds_tree.tre")
#write.csv(df_char3, 'birds_metrics.csv')
df_temp_fly = read.csv('birds_metrics.csv')
rownames(df_temp_fly) = df_temp_fly$species_name
df_flight_names = read.csv('flight_and_gene.csv')
df_flight_names = df_flight_names[,c(2:3)]
df_flight_names = merge(df_flight_names, df_realms)
rownames(df_flight_names) = df_flight_names$species_name
df_temp_fly = df_temp_fly[,c(2:17)]
df_temp_fly = merge(df_temp_fly, df_flight_names)
rownames(df_temp_fly) = df_temp_fly$species_name
temp_tree = read.tree('flight_and_temp.tre')
df_temp_fly$Latitude = gsub(',', '.', df_temp_fly$Latitude)
df_temp_fly$AnnualTemp = gsub(',', '.', df_temp_fly$AnnualTemp)
df_temp_fly$TempRange = gsub(',', '.', df_temp_fly$TempRange)
df_temp_fly$AnnualPrecip = gsub(',', '.', df_temp_fly$AnnualPrecip)
df_temp_fly$PrecipRange= gsub(',', '.', df_temp_fly$PrecipRange)
df_temp_fly$Beak_length_Culmen = as.numeric(as.character(df_temp_fly$Beak_length_Culmen))
df_temp_fly$Beak_length_Nares = as.numeric(as.character(df_temp_fly$Beak_length_Nares))
df_temp_fly$Beak_width = as.numeric(as.character(df_temp_fly$Beak_width))
df_temp_fly$Beak_depth = as.numeric(as.character(df_temp_fly$Beak_depth))
df_temp_fly$Tarsus_length = as.numeric(as.character(df_temp_fly$Tarsus_length))
df_temp_fly$Wing_length = as.numeric(as.character(df_temp_fly$Wing_length))
df_temp_fly$Kipps_distance = as.numeric(as.character(df_temp_fly$Kipps_distance))
df_temp_fly$Hand_wing_index = as.numeric(as.character(df_temp_fly$Hand_wing_index))
df_temp_fly$Tail_length = as.numeric(as.character(df_temp_fly$Tail_length))
df_temp_fly$Mass = as.numeric(as.character(df_temp_fly$Mass))
df_temp_fly$Latitude = as.numeric(as.character(df_temp_fly$Latitude))
df_temp_fly$AnnualTemp = as.numeric(as.character(df_temp_fly$AnnualTemp))
df_temp_fly$TempRange = as.numeric(as.character(df_temp_fly$TempRange))
df_temp_fly$AnnualPrecip = as.numeric(as.character(df_temp_fly$AnnualPrecip))
df_temp_fly$PrecipRange = as.numeric(as.character(df_temp_fly$PrecipRange))
df_temp_fly$Beak_length_Culmen = log10(df_temp_fly$Beak_length_Culmen)
df_temp_fly$Beak_length_Nares = log10(df_temp_fly$Beak_length_Nares)
df_temp_fly$Beak_width = log10(df_temp_fly$Beak_width)
df_temp_fly$Beak_depth = log10(df_temp_fly$Beak_depth)
df_temp_fly$Tarsus_length = log10(df_temp_fly$Tarsus_length)
df_temp_fly$Wing_length = log10(df_temp_fly$Wing_length)
df_temp_fly$Kipps_distance = log10(df_temp_fly$Kipps_distance)
df_temp_fly$Hand_wing_index = log10(df_temp_fly$Hand_wing_index)
df_temp_fly$Tail_length = log10(df_temp_fly$Tail_length)
df_temp_fly$Mass = log10(df_temp_fly$Mass)
df_temp_fly$TempRange = log10(df_temp_fly$TempRange)
df_temp_fly$AnnualPrecip = log10(df_temp_fly$AnnualPrecip)
df_temp_fly$PrecipRange = log10(df_temp_fly$PrecipRange)
#adding everything to PCA
df_flight = read.csv('flight_and_gene.csv')
df_flight = df_flight[,c(2,4,5,6)]
df_temp_fly = merge(df_temp_fly, df_flight)
View(df_temp_fly)
#df_char3 = merge(df_char1, df_char2)
#df_char1$species_name = gsub(' ', '_', df_char1$species_name)
#df_char3$species_name = gsub(' ', '_', df_char3$species_name)
#df_char3 = na.omit(df_char3)
#need_species = setdiff(df_char1$species_name, df_char3$species_name)
#correct_need_species = setdiff(df_char1$species_name, need_species)
#temp_tree<-keep.tip(birds_tree,correct_need_species)
#temp_tree
#write.tree(temp_tree ,file="temperature_birds_tree.tre")
#write.csv(df_char3, 'birds_metrics.csv')
df_temp_fly = read.csv('birds_metrics.csv')
View(df_temp_fly)
#new PGLS for birds
rm(list = ls(all=TRUE))
library(phytools)
library(nlme)
library(geiger)
#flying birds
df_flight = read.csv('flight_and_gene.csv')
df_flight = df_flight[,c(2,3,4,5,6)]
df_flight$flight_num = 0
df_flight[df_flight$ability_to_fly != 'Flying',]$flight_num = 1
rownames(df_flight) = df_flight$species_name
flying_tree = read.tree('flying_birds_tree.tre')
name.check(flying_tree, df_flight)
df_flight$ability_to_fly = as.character(df_flight$ability_to_fly)
df_flight$GhAhSkew = as.numeric(as.character(df_flight$GhAhSkew))
df_flight$fAn = as.numeric(as.character(df_flight$fAn))
df_flight$fGn = as.numeric(as.character(df_flight$fGn))
df_flight$flight_num = as.numeric(as.character(df_flight$flight_num))
df_fly_peng = df_flight[df_flight$ability_to_fly == 'Flying' | df_flight$ability_to_fly =='Sphenisciformes',]
df_fly_not = df_flight[df_flight$ability_to_fly !='Sphenisciformes',]
peng_fly_tree = read.tree('flying_and_peng.tre')
no_peng_fly_tree = read.tree('flying_and_no_peng.tre')
df_temp_fly = read.csv('birds_metrics.csv')
View(df_temp_fly)
df_temp_fly = df_temp_fly[,c(2:17)]
df_peng_mass = merge(df_fly_peng, df_temp_fly)
View(df_flight)
View(df_peng_mass)
library(ggplot2)
df_peng_mass$Mass = as.numeric(df_peng_mass$Mass)
ggplot(df_peng_mass, aes(x = ability_to_fly, y = Mass))+
geom_boxplot()
ggplot(df_peng_mass, aes(x = ability_to_fly, y = Mass))+
geom_point()
df_peng_mass$logMass = log10(df_peng_mass$Mass)
ggplot(df_peng_mass, aes(x = ability_to_fly, y = logMass))+
geom_point()
ggplot(df_peng_mass, aes(x = GhAhSkew, y = logMass))+
geom_point(color = ability_to_fly)
ggplot(df_peng_mass, aes(x = GhAhSkew, y = logMass, color = ability_to_fly))+
geom_point()
df_paly_mass = merge(df_fly_not, df_temp_fly)
df_paly_mass$Mass = as.numeric(df_paly_mass$Mass)
df_paly_mass$logMass = log10(df_paly_mass$Mass)
ggplot(df_paly_mass, aes(x = GhAhSkew, y = logMass, color = ability_to_fly))+
geom_point()
#new PGLS for birds
rm(list = ls(all=TRUE))
#new PGLS for birds
rm(list = ls(all=TRUE))
library(phytools)
library(nlme)
library(geiger)
library(ggplot2)
#flying birds
df_flight = read.csv('flight_and_gene.csv')
df_flight = df_flight[,c(2,3,4,5,6)]
df_flight$flight_num = 0
df_flight[df_flight$ability_to_fly != 'Flying',]$flight_num = 1
rownames(df_flight) = df_flight$species_name
flying_tree = read.tree('flying_birds_tree.tre')
name.check(flying_tree, df_flight)
df_flight$ability_to_fly = as.character(df_flight$ability_to_fly)
df_flight$GhAhSkew = as.numeric(as.character(df_flight$GhAhSkew))
df_flight$fAn = as.numeric(as.character(df_flight$fAn))
df_flight$fGn = as.numeric(as.character(df_flight$fGn))
df_flight$flight_num = as.numeric(as.character(df_flight$flight_num))
df_fly_peng = df_flight[df_flight$ability_to_fly == 'Flying' | df_flight$ability_to_fly =='Sphenisciformes',]
df_fly_not = df_flight[df_flight$ability_to_fly !='Sphenisciformes',]
peng_fly_tree = read.tree('flying_and_peng.tre')
no_peng_fly_tree = read.tree('flying_and_no_peng.tre')
df_temp_fly = read.csv('birds_metrics.csv')
df_temp_fly = df_temp_fly[,c(2:17)]
df_peng_mass = merge(df_fly_peng, df_temp_fly)
df_peng_mass$Mass = as.numeric(df_peng_mass$Mass)
df_peng_mass$logMass = log10(df_peng_mass$Mass)
ggplot(df_peng_mass, aes(x = logMass, y = GhAhSkew, color = ability_to_fly))+
geom_point()
df_fly_not[df_fly_not$ability_to_fly != 'Flying',]$ability_to_fly = 'Non-flying'
df_paly_mass = merge(df_fly_not, df_temp_fly)
df_paly_mass$Mass = as.numeric(df_paly_mass$Mass)
df_paly_mass$logMass = log10(df_paly_mass$Mass)
ggplot(df_paly_mass, aes(x = GhAhSkew, y = logMass, color = ability_to_fly))+
geom_point()
ggplot(df_paly_mass, aes(x = logMass, y = GhAhSkew, color = ability_to_fly))+
geom_point()
df_fly_not = df_flight[df_flight$ability_to_fly !='Sphenisciformes',]
ggplot(df_paly_mass, aes(x = logMass, y = GhAhSkew, color = ability_to_fly))+
geom_point()
#new PGLS for birds
rm(list = ls(all=TRUE))
#flying birds
df_flight = read.csv('flight_and_gene.csv')
df_flight = df_flight[,c(2,3,4,5,6)]
df_flight$flight_num = 0
df_flight[df_flight$ability_to_fly != 'Flying',]$flight_num = 1
rownames(df_flight) = df_flight$species_name
flying_tree = read.tree('flying_birds_tree.tre')
name.check(flying_tree, df_flight)
df_flight$ability_to_fly = as.character(df_flight$ability_to_fly)
df_flight$GhAhSkew = as.numeric(as.character(df_flight$GhAhSkew))
df_flight$fAn = as.numeric(as.character(df_flight$fAn))
df_flight$fGn = as.numeric(as.character(df_flight$fGn))
df_flight$flight_num = as.numeric(as.character(df_flight$flight_num))
df_fly_peng = df_flight[df_flight$ability_to_fly == 'Flying' | df_flight$ability_to_fly =='Sphenisciformes',]
df_fly_not = df_flight[df_flight$ability_to_fly !='Sphenisciformes',]
peng_fly_tree = read.tree('flying_and_peng.tre')
no_peng_fly_tree = read.tree('flying_and_no_peng.tre')
spp = rownames(df_fly_peng)
corBM = corBrownian(phy=peng_fly_tree,form=~spp)
df_temp_fly = read.csv('birds_metrics.csv')
df_temp_fly = df_temp_fly[,c(2:17)]
df_peng_mass = merge(df_fly_peng, df_temp_fly)
df_peng_mass$Mass = as.numeric(df_peng_mass$Mass)
df_peng_mass$logMass = log10(df_peng_mass$Mass)
df_paly_mass = merge(df_fly_not, df_temp_fly)
df_paly_mass$Mass = as.numeric(df_paly_mass$Mass)
df_paly_mass$logMass = log10(df_paly_mass$Mass)
ggplot(df_paly_mass, aes(x = logMass, y = GhAhSkew, color = ability_to_fly))+
geom_point()
#dive pgls
df_dive = read.csv('dive_and_gene.csv')
df_dive = df_dive[,c(2:6)]
dive_tree = read.tree('diving_birds_tree.tre')
row.names(df_dive) = df_dive$species_name
df_dive1 = merge(df_dive, df_syn1)
View(df_temp_fly)
df_dive_mass = merge(df_dive, df_temp_fly)
View(df_dive_mass)
df_dive_mass$Mass = as.numeric(df_dive_mass$Mass)
df_dive_mass$logMass = log10(df_dive_mass$Mass)
ggplot(df_dive_mass, aes(x = logMass, y = GhAhSkew, color = ability_to_fly))+
geom_point()
ggplot(df_dive_mass, aes(x = logMass, y = GhAhSkew, color = ability_to_dive))+
geom_point()
df_paly_mass1 = df_paly_mass[df_paly_mass$ability_to_fly != "Charadriiformes" | df_paly_mass$ability_to_fly != "Coraciiformes" | df_paly_mass$ability_to_fly != "Passeriformes" | df_paly_mass$ability_to_fly != "Procellariiformes" | df_paly_mass$ability_to_fly != "Gruiformes",]
df_dive_mass1 = df_paly_mass[df_paly_mass$ability_to_fly != "Charadriiformes" | df_paly_mass$ability_to_fly != "Coraciiformes" | df_paly_mass$ability_to_fly != "Passeriformes" | df_paly_mass$ability_to_fly != "Procellariiformes" | df_paly_mass$ability_to_fly != "Gruiformes",]
df_dive_mass1 = df_dive_mass[df_dive_mass$ability_to_fly != "Charadriiformes" | df_dive_mass$ability_to_fly != "Coraciiformes" | df_dive_mass$ability_to_fly != "Passeriformes" | df_dive_mass$ability_to_fly != "Procellariiformes" | df_dive_mass$ability_to_fly != "Gruiformes",]
df_dive_mass1 = df_dive_mass[df_dive_mass$ability_to_dive != "Charadriiformes" | df_dive_mass$ability_to_dive != "Coraciiformes" | df_dive_mass$ability_to_dive != "Passeriformes" | df_dive_mass$ability_to_dive != "Procellariiformes" | df_dive_mass$ability_to_dive != "Gruiformes",]
df_dive_mass1 = df_dive_mass[df_dive_mass$ability_to_dive != "Charadriiformes" & df_dive_mass$ability_to_dive != "Coraciiformes" & df_dive_mass$ability_to_dive != "Passeriformes" & df_dive_mass$ability_to_dive != "Procellariiformes" & df_dive_mass$ability_to_dive != "Gruiformes",]
df_dive_mass2 = df_dive_mass[df_dive_mass$ability_to_dive == "Charadriiformes" & df_dive_mass$ability_to_dive == "Coraciiformes" & df_dive_mass$ability_to_dive == "Passeriformes" & df_dive_mass$ability_to_dive == "Procellariiformes" & df_dive_mass$ability_to_dive == "Gruiformes" & df_dive_mass$ability_to_dive == "Non-diving",]
df_dive_mass2 = df_dive_mass[df_dive_mass$ability_to_dive != 'Anseriformes' & df_dive_mass$ability_to_dive != "Sphenisciformes" & df_dive_mass$ability_to_dive != "Podicipediformes" & df_dive_mass$ability_to_dive != "Gaviiformes" & df_dive_mass$ability_to_dive != "Suliformes",]
ggplot(df_dive_mass1, aes(x = logMass, y = GhAhSkew, color = ability_to_fly))+
geom_point()
ggplot(df_dive_mass1, aes(x = logMass, y = GhAhSkew, color = ability_to_dive))+
geom_point()
ggplot(df_dive_mass2, aes(x = logMass, y = GhAhSkew, color = ability_to_dive))+
geom_point()
#new PGLS for birds
rm(list = ls(all=TRUE))
library(phytools)
library(nlme)
library(geiger)
library(ggplot2)
#flying birds
df_flight = read.csv('flight_and_gene.csv')
df_flight = df_flight[,c(2,3,4,5,6)]
df_flight$flight_num = 0
df_flight[df_flight$ability_to_fly != 'Flying',]$flight_num = 1
rownames(df_flight) = df_flight$species_name
flying_tree = read.tree('flying_birds_tree.tre')
name.check(flying_tree, df_flight)
df_flight$ability_to_fly = as.character(df_flight$ability_to_fly)
df_flight$GhAhSkew = as.numeric(as.character(df_flight$GhAhSkew))
df_flight$fAn = as.numeric(as.character(df_flight$fAn))
df_flight$fGn = as.numeric(as.character(df_flight$fGn))
df_flight$flight_num = as.numeric(as.character(df_flight$flight_num))
df_fly_peng = df_flight[df_flight$ability_to_fly == 'Flying' | df_flight$ability_to_fly =='Sphenisciformes',]
df_fly_not = df_flight[df_flight$ability_to_fly !='Sphenisciformes',]
peng_fly_tree = read.tree('flying_and_peng.tre')
no_peng_fly_tree = read.tree('flying_and_no_peng.tre')
df_temp_fly = read.csv('birds_metrics.csv')
df_temp_fly = df_temp_fly[,c(2:17)]
df_peng_mass = merge(df_fly_peng, df_temp_fly)
df_peng_mass$Mass = as.numeric(df_peng_mass$Mass)
df_peng_mass$logMass = log10(df_peng_mass$Mass)
View(df_fly_peng)
View(df_temp_fly)
View(df_fly_peng)
#nuclear work
df_nucl = read.csv('Chord_CU.csv')
View(df_nucl)
df_nucl$Species = gsub(' ', '_', df_nucl$Species)
colnames(df_nucl)[colnames(df_nucl) == "Species"] = "species_name"
df_peng_nucl = merge(df_fly_peng, df_nucl)
View(df_peng_nucl)
df_paleo_nucl = merge(df_fly_not, df_nucl)
View(df_paleo_nucl)
View(df_peng_nucl)
df_nucl = df_nucl[df_nucl$Class == 'Aves',]
View(df_nucl)
colnames(df_nucl)[colnames(df_nucl) == "Species"] = "species_name"
df_peng_nucl = merge(df_fly_peng, df_nucl)
df_paleo_nucl = merge(df_fly_not, df_nucl)
#nuclear work
df_nucl = read.csv('Chord_CU.csv')
#new PGLS for birds
rm(list = ls(all=TRUE))
library(phytools)
library(nlme)
library(geiger)
library(ggplot2)
#flying birds
df_flight = read.csv('flight_and_gene.csv')
df_flight = df_flight[,c(2,3,4,5,6)]
df_flight$flight_num = 0
df_flight[df_flight$ability_to_fly != 'Flying',]$flight_num = 1
rownames(df_flight) = df_flight$species_name
flying_tree = read.tree('flying_birds_tree.tre')
name.check(flying_tree, df_flight)
df_flight$ability_to_fly = as.character(df_flight$ability_to_fly)
df_flight$GhAhSkew = as.numeric(as.character(df_flight$GhAhSkew))
df_flight$fAn = as.numeric(as.character(df_flight$fAn))
df_flight$fGn = as.numeric(as.character(df_flight$fGn))
df_flight$flight_num = as.numeric(as.character(df_flight$flight_num))
df_fly_peng = df_flight[df_flight$ability_to_fly == 'Flying' | df_flight$ability_to_fly =='Sphenisciformes',]
df_fly_not = df_flight[df_flight$ability_to_fly !='Sphenisciformes',]
peng_fly_tree = read.tree('flying_and_peng.tre')
no_peng_fly_tree = read.tree('flying_and_no_peng.tre')
df_temp_fly = read.csv('birds_metrics.csv')
df_temp_fly = df_temp_fly[,c(2:17)]
df_peng_mass = merge(df_fly_peng, df_temp_fly)
df_peng_mass$Mass = as.numeric(df_peng_mass$Mass)
df_peng_mass$logMass = log10(df_peng_mass$Mass)
df_fly_not[df_fly_not$ability_to_fly != 'Flying',]$ability_to_fly = 'Non-flying'
df_paly_mass = merge(df_fly_not, df_temp_fly)
df_paly_mass$Mass = as.numeric(df_paly_mass$Mass)
df_paly_mass$logMass = log10(df_paly_mass$Mass)
#nuclear work
df_nucl = read.csv('Chord_CU.csv')
df_nucl$Species = gsub(' ', '_', df_nucl$Species)
df_nucl = df_nucl[df_nucl$Class == 'Aves',]
colnames(df_nucl)[colnames(df_nucl) == "Species"] = "species_name"
df_peng_nucl = merge(df_fly_peng, df_nucl)
df_paleo_nucl = merge(df_fly_not, df_nucl)
#nuclear work
data = read.csv('Chord_CU.csv')
data$NeutralA = as.numeric(data$GCA..Ala.) + as.numeric(data$CGA..Arg.) + as.numeric(data$GGA..Gly.) + as.numeric(data$CTA..Leu.)  + as.numeric(data$CTA..Leu.)  + as.numeric(data$CCA..Pro.)  + as.numeric(data$TCA..Ser.)  + as.numeric(data$ACA..Thr.) + as.numeric(data$GTA..Val.)
data$NeutralT = as.numeric(data$GCT..Ala.) + as.numeric(data$CGT..Arg.) + as.numeric(data$GGT..Gly.) + as.numeric(data$CTT..Leu.)  + as.numeric(data$CTT..Leu.)  + as.numeric(data$CCT..Pro.)  + as.numeric(data$TCT..Ser.)  + as.numeric(data$ACT..Thr.) + as.numeric(data$GTT..Val.)
data$NeutralG = as.numeric(data$GCG..Ala.) + as.numeric(data$CGG..Arg.) + as.numeric(data$GGG..Gly.) + as.numeric(data$CTG..Leu.)  + as.numeric(data$CTG..Leu.)  + as.numeric(data$CCG..Pro.)  + as.numeric(data$TCG..Ser.)  + as.numeric(data$ACG..Thr.) + as.numeric(data$GTG..Val.)
data$NeutralC = as.numeric(data$GCC..Ala.) + as.numeric(data$CGC..Arg.) + as.numeric(data$GGC..Gly.) + as.numeric(data$CTC..Leu.)  + as.numeric(data$CTC..Leu.)  + as.numeric(data$CCC..Pro.)  + as.numeric(data$TCC..Ser.)  + as.numeric(data$ACC..Thr.) + as.numeric(data$GTC..Val.)
sinnuccontentn = aggregate(list(data$NeutralA,data$NeutralT,data$NeutralG,data$NeutralC), by = list(data$Species, data$Class), FUN = sum)
View(sinnuccontentn)
names(sinnuccontentn) = c('Species', 'Class', 'NeutralA','NeutralT','NeutralG','NeutralC')
sinnuccontentn$FrA = sinnuccontentn$NeutralA / (sinnuccontentn$NeutralA + sinnuccontentn$NeutralT + sinnuccontentn$NeutralG + sinnuccontentn$NeutralC)
sinnuccontentn$FrT = sinnuccontentn$NeutralT / (sinnuccontentn$NeutralA + sinnuccontentn$NeutralT + sinnuccontentn$NeutralG + sinnuccontentn$NeutralC)
sinnuccontentn$FrG = sinnuccontentn$NeutralG / (sinnuccontentn$NeutralA + sinnuccontentn$NeutralT + sinnuccontentn$NeutralG + sinnuccontentn$NeutralC)
sinnuccontentn$FrC = sinnuccontentn$NeutralC / (sinnuccontentn$NeutralA + sinnuccontentn$NeutralT + sinnuccontentn$NeutralG + sinnuccontentn$NeutralC)
sinnuccontentn$TGskew = (sinnuccontentn$FrT-sinnuccontentn$FrG)/(sinnuccontentn$FrG+sinnuccontentn$FrT)
sinnuccontentn$Species = gsub(" ", "_", sinnuccontentn$Species)
table(sinnuccontentn$Class)
View(sinnuccontentn)
sinnuccontentn = sinnuccontentnl[sinnuccontentn$Class == 'Aves',]
sinnuccontentn = sinnuccontentn[sinnuccontentn$Class == 'Aves',]
colnames(sinnuccontentn)[colnames(sinnuccontentn) == "Species"] = "species_name"
df_peng_nucl = merge(df_fly_peng, df_nucl)
df_paleo_nucl = merge(df_fly_not, df_nucl)
View(df_peng_mass)
View(df_peng_nucl)
ggviolin(df_peng_nucl, x = "ability_to_fly", y = "FrT", ylab = "FrT",
add = "boxplot", fill="Class", palette=c("#6760db", "#7849bf", "#9145c4", "#c73a69", "#c2464c"), yscale = "log2")
library(ggplot2)
ggviolin(df_peng_nucl, x = "ability_to_fly", y = "FrT", ylab = "FrT",
add = "boxplot", fill="Class", palette=c("#6760db", "#7849bf", "#9145c4", "#c73a69", "#c2464c"), yscale = "log2")
ggplot(df_peng_nucl, aes(x = "ability_to_fly", y = "FrT"))+
geom_violin()+
ylab = "FrT"
ggplot(df_peng_nucl, aes(x = "ability_to_fly", y = "FrT"))+
geom_violin()
df_peng_nucl = merge(df_fly_peng, sinnuccontentn)
df_paleo_nucl = merge(df_fly_not, sinnuccontentn)
View(df_paleo_nucl)
ggplot(df_peng_nucl, aes(x = "ability_to_fly", y = "FrT"))+
geom_violin()
typeof(df_peng_nucl$FrT)
ggplot(df_peng_nucl, aes(x = ability_to_fly, y = FrT))+
geom_violin()
ggplot(df_paleo_nucl, aes(x = ability_to_fly, y = FrT))+
geom_violin()
#new PGLS for birds
rm(list = ls(all=TRUE))
