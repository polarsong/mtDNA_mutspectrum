ggtree(der, aes(color = der@data$MutSpec)) + geom_tiplab(size = 4, colour = "darkgray") +
scale_color_continuous(low="green", high="red")+
theme(legend.position="bottom")+
labs(col=label)+
scale_size(3)
ggtree(der, aes(color = der@data$MutSpec)) + geom_tiplab(size = 4, colour = "darkgray") +
scale_color_continuous(low="green", high="red")+
theme(legend.position="bottom")+
labs(col=label)+
scale_size_continuous(range = c(1,2))
ggtree(der, aes(color = der@data$MutSpec)) + geom_tiplab(size = 4, colour = "darkgray") +
scale_color_continuous(low="green", high="red")+
theme(legend.position="bottom")+
labs(col=label)+
scale_size_continuous(range = c(1,2))
pdf('Birds.pdf',
width = 20,height = 300)
ggtree(der, aes(color = der@data$MutSpec)) + geom_tiplab(size = 4, colour = "darkgray") +
scale_color_continuous(low="green", high="red")+
theme(legend.position="bottom")+
labs(col=label)
dev.off()
pdf('Birds.pdf',
width = 20,height = 300)
ggtree(der, aes(color = der@data$MutSpec)) + geom_tiplab(size = 4, colour = "darkgray") +
scale_color_continuous(low="yellow", high="blue")+
theme(legend.position="bottom")+
labs(col=label)
dev.off()
pdf('Birds.pdf',
width = 20,height = 200)
ggtree(der, aes(color = der@data$MutSpec)) + geom_tiplab(size = 4, colour = "darkgray") +
scale_color_continuous(low="yellow", high="blue")+
theme(legend.position="bottom")+
labs(col=label)
dev.off()
pdf('Birds.pdf',
width = 20,height = 100)
ggtree(der, aes(color = der@data$MutSpec)) + geom_tiplab(size = 4, colour = "darkgray") +
scale_color_continuous(low="yellow", high="blue")+
theme(legend.position="bottom")+
labs(col=label)
dev.off()
pdf('Birds.pdf',
width = 30,height = 100)
ggtree(der, aes(color = der@data$MutSpec)) + geom_tiplab(size = 4, colour = "darkgray") +
scale_color_continuous(low="yellow", high="blue")+
theme(legend.position="bottom")+
labs(col=label)
dev.off()
pdf('Birds.pdf',
width = 20,height = 100)
ggtree(der, aes(color = der@data$MutSpec)) + geom_tiplab(size = 4, colour = "darkgray") +
scale_color_continuous(low="yellow", high="blue")+
theme(legend.position="bottom")+
labs(col=label)
dev.off()
pdf('Birds.pdf',
width = 30,height = 100)
ggtree(der, aes(color = der@data$MutSpec)) + geom_tiplab(size = 4, colour = "darkgray") +
scale_color_continuous(low="yellow", high="blue")+
theme(legend.position="bottom")+
labs(col=label)
dev.off()
rm(list=ls(all=T))
library(phytools)
library(nlme)
library(geiger)
library(ggplot2)
#flying birds
df_flight = read.csv('flight_and_gene.csv')
df_flight = df_flight[,c(2,3,4,5,6)]
df_flight$flight_num = 0
df_flight[df_flight$ability_to_fly != 'Flying',]$flight_num = 1
rownames(df_flight) = df_flight$species_name
flying_tree = read.tree('flying_birds_tree.tre')
name.check(flying_tree, df_flight)
df_flight$ability_to_fly = as.character(df_flight$ability_to_fly)
df_flight$GhAhSkew = as.numeric(as.character(df_flight$GhAhSkew))
df_flight$fAn = as.numeric(as.character(df_flight$fAn))
df_flight$fGn = as.numeric(as.character(df_flight$fGn))
df_flight$flight_num = as.numeric(as.character(df_flight$flight_num))
df_fly_peng = df_flight[df_flight$ability_to_fly == 'Flying' | df_flight$ability_to_fly =='Sphenisciformes',]
df_fly_not = df_flight[df_flight$ability_to_fly !='Sphenisciformes',]
peng_fly_tree = read.tree('flying_and_peng.tre')
no_peng_fly_tree = read.tree('flying_and_no_peng.tre')
df_temp_fly = read.csv('birds_metrics.csv')
df_temp_fly = df_temp_fly[,c(2:17)]
df_peng_mass = merge(df_fly_peng, df_temp_fly)
df_peng_mass$Mass = as.numeric(df_peng_mass$Mass)
df_peng_mass$logMass = log10(df_peng_mass$Mass)
ggplot(df_peng_mass, aes(x = logMass, y = GhAhSkew, color = ability_to_fly))+
geom_point()
df_peng_mass1 = df_peng_mass[df_peng_mass$ability_to_fly == 'Sphenisciformes',]
View(df_peng_mass1)
ggplot(df_peng_mass1, aes(x = logMass, y = GhAhSkew))+
geom_point()
View(df_peng_mass)
fit <- lm(GhAhSkew ~ logMass + ability_to_fly, data=df_peng_mass)
summary(fit)
df_peng_mass$ability_to_fly_binar = 0
df_peng_mass[df_peng_mass$ability_to_fly == 'Sphenisciformes',]$ability_to_fly_binar = 1
ggplot(df_peng_mass, aes(x = logMass, y = GhAhSkew, color = ability_to_fly))+
geom_point()
df_peng_mass1 = df_peng_mass[df_peng_mass$ability_to_fly == 'Sphenisciformes',]
ggplot(df_peng_mass1, aes(x = logMass, y = GhAhSkew))+
geom_point()
fit <- lm(GhAhSkew ~ logMass + ability_to_fly_binar, data=df_peng_mass)
summary(fit)
fit <- lm(GhAhSkew ~ logMass, data=df_peng_mass1)
summary(fit)
fit <- lm(GhAhSkew ~ Mass, data=df_peng_mass1)
summary(fit)
fit <- lm(GhAhSkew ~ logMass, data=df_peng_mass1)
summary(fit)
df_fly_not[df_fly_not$ability_to_fly != 'Flying',]$ability_to_fly = 'Non-flying'
df_paly_mass = merge(df_fly_not, df_temp_fly)
df_paly_mass$Mass = as.numeric(df_paly_mass$Mass)
df_paly_mass$logMass = log10(df_paly_mass$Mass)
ggplot(df_paly_mass, aes(x = logMass, y = GhAhSkew, color = ability_to_fly))+
geom_point()
df_paly_mass[df_paly_mass$ability_to_fly == 'Non-flying',]$ability_to_fly_binar = 1
View(df_paly_mass)
df_paly_mass$ability_to_fly_binar = 0
df_paly_mass[df_paly_mass$ability_to_fly == 'Non-flying',]$ability_to_fly_binar = 1
ggplot(df_paly_mass, aes(x = logMass, y = GhAhSkew, color = ability_to_fly))+
geom_point()
df_paly_mass1 = df_paly_mass[df_paly_mass$ability_to_fly == 'Non-flying',]
ggplot(df_paly_mass1, aes(x = logMass, y = GhAhSkew))+
geom_point()
fit <- lm(GhAhSkew ~ logMass + ability_to_fly_binar, data=df_paly_mass)
summary(fit)
fit <- lm(GhAhSkew ~ logMass, data=df_paly_mass1)
summary(fit)
#dive pgls
df_dive = read.csv('dive_and_gene.csv')
df_dive = df_dive[,c(2:6)]
dive_tree = read.tree('diving_birds_tree.tre')
row.names(df_dive) = df_dive$species_name
df_dive_mass = merge(df_dive, df_temp_fly)
df_dive_mass$Mass = as.numeric(df_dive_mass$Mass)
df_dive_mass$logMass = log10(df_dive_mass$Mass)
ggplot(df_dive_mass, aes(x = logMass, y = GhAhSkew, color = ability_to_dive))+
geom_point()
df_paly_mass$Mass = as.numeric(df_paly_mass$Mass)
df_paly_mass$logMass = log10(df_paly_mass$Mass)
ggplot(df_paly_mass, aes(x = logMass, y = GhAhSkew, color = ability_to_fly))+
geom_point()
ggplot(df_dive_mass, aes(x = logMass, y = GhAhSkew, color = ability_to_dive))+
geom_point()
df_dive_mass1 = df_dive_mass[df_dive_mass$ability_to_dive != "Charadriiformes" & df_dive_mass$ability_to_dive != "Coraciiformes" & df_dive_mass$ability_to_dive != "Passeriformes" & df_dive_mass$ability_to_dive != "Procellariiformes" & df_dive_mass$ability_to_dive != "Gruiformes",]
df_dive_mass2 = df_dive_mass[df_dive_mass$ability_to_dive != 'Anseriformes' & df_dive_mass$ability_to_dive != "Sphenisciformes" & df_dive_mass$ability_to_dive != "Podicipediformes" & df_dive_mass$ability_to_dive != "Gaviiformes" & df_dive_mass$ability_to_dive != "Suliformes",]
ggplot(df_dive_mass1, aes(x = logMass, y = GhAhSkew, color = ability_to_dive))+
geom_point()
df_dive_mass11 = df_dive_mass1[df_dive_mass1$ability_to_dive == 'Anseriformes',]
ggplot(df_dive_mass11, aes(x = logMass, y = GhAhSkew))+
geom_point()
df_dive_mass$ability_to_dive_binar = 0
View(df_dive_mass)
df_dive_mass[df_dive_mass$ability_to_dive != 'Non-diving',]$ability_to_dive_binar = 1
df_dive_mass1 = df_dive_mass[df_dive_mass$ability_to_dive != "Charadriiformes" & df_dive_mass$ability_to_dive != "Coraciiformes" & df_dive_mass$ability_to_dive != "Passeriformes" & df_dive_mass$ability_to_dive != "Procellariiformes" & df_dive_mass$ability_to_dive != "Gruiformes",]
df_dive_mass2 = df_dive_mass[df_dive_mass$ability_to_dive != 'Anseriformes' & df_dive_mass$ability_to_dive != "Sphenisciformes" & df_dive_mass$ability_to_dive != "Podicipediformes" & df_dive_mass$ability_to_dive != "Gaviiformes" & df_dive_mass$ability_to_dive != "Suliformes",]
ggplot(df_dive_mass1, aes(x = logMass, y = GhAhSkew, color = ability_to_dive))+
geom_point()
df_dive_mass11 = df_dive_mass1[df_dive_mass1$ability_to_dive == 'Anseriformes',]
ggplot(df_dive_mass11, aes(x = logMass, y = GhAhSkew))+
geom_point()
fit <- lm(GhAhSkew ~ logMass + ability_to_fly_binar, data=df_paly_mass)
summary(fit)
fit <- lm(GhAhSkew ~ logMass + ability_to_dive_binar, data=df_dive_mass)
summary(fit)
fit <- lm(GhAhSkew ~ logMass + ability_to_dive_binar, data=df_dive_mass1)
summary(fit)
fit <- lm(GhAhSkew ~ logMass + ability_to_dive_binar, data=df_dive_mass11)
fit <- lm(GhAhSkew ~ logMass, data=df_dive_mass11)
summary(fit)
fit <- lm(GhAhSkew ~ logMass + ability_to_dive_binar, data=df_dive_mass2)
summary(fit)
#new PGLS for birds
rm(list = ls(all=TRUE))
library(phytools)
library(nlme)
library(geiger)
library(ggplot2)
#flying birds
df_flight = read.csv('flight_and_gene.csv')
df_flight = df_flight[,c(2,3,4,5,6)]
df_flight$flight_num = 0
df_flight[df_flight$ability_to_fly != 'Flying',]$flight_num = 1
rownames(df_flight) = df_flight$species_name
flying_tree = read.tree('flying_birds_tree.tre')
name.check(flying_tree, df_flight)
df_flight$ability_to_fly = as.character(df_flight$ability_to_fly)
df_flight$GhAhSkew = as.numeric(as.character(df_flight$GhAhSkew))
df_flight$fAn = as.numeric(as.character(df_flight$fAn))
df_flight$fGn = as.numeric(as.character(df_flight$fGn))
df_flight$flight_num = as.numeric(as.character(df_flight$flight_num))
df_fly_peng = df_flight[df_flight$ability_to_fly == 'Flying' | df_flight$ability_to_fly =='Sphenisciformes',]
df_fly_not = df_flight[df_flight$ability_to_fly !='Sphenisciformes',]
peng_fly_tree = read.tree('flying_and_peng.tre')
no_peng_fly_tree = read.tree('flying_and_no_peng.tre')
df_temp_fly = read.csv('birds_metrics.csv')
df_temp_fly = df_temp_fly[,c(2:17)]
df_peng_mass = merge(df_fly_peng, df_temp_fly)
df_peng_mass$Mass = as.numeric(df_peng_mass$Mass)
df_peng_mass$logMass = log10(df_peng_mass$Mass)
df_peng_mass$ability_to_fly_binar = 0
df_peng_mass[df_peng_mass$ability_to_fly == 'Sphenisciformes',]$ability_to_fly_binar = 1
ggplot(df_peng_mass, aes(x = logMass, y = GhAhSkew, color = ability_to_fly))+
geom_point()
df_peng_mass1 = df_peng_mass[df_peng_mass$ability_to_fly == 'Sphenisciformes',]
ggplot(df_peng_mass1, aes(x = logMass, y = GhAhSkew))+
geom_point()
View(df_peng_mass)
View(df_fly_not)
fit <- lm(GhAhSkew ~ logMass, data=df_peng_mass1)
summary(fit)
View(df_temp_fly)
unique(df_fly_not$ability_to_fly)
df_fly_not1 = df_fly_not[df_fly_not$ability_to_fly == "Apterygiformes",]
ggplot(df_fly_not1, aes(x = logMass, y = GhAhSkew))+
geom_point()
View(df_fly_not1)
df_fly_not2 = df_fly_not[df_fly_not$ability_to_fly == "Gruiformes",]
ggplot(df_fly_not1, aes(x = logMass, y = GhAhSkew))+
geom_point()
df_fly_not3 = df_fly_not[df_fly_not$ability_to_fly == "Casuariiformes",]
ggplot(df_fly_not1, aes(x = logMass, y = GhAhSkew))+
geom_point()
View(df_fly_not3)
df_paly_mass = merge(df_fly_not, df_temp_fly)
df_paly_mass$Mass = as.numeric(df_paly_mass$Mass)
df_paly_mass$logMass = log10(df_paly_mass$Mass)
df_paly_mass$ability_to_fly_binar = 0
df_fly_not1 = df_paly_mass[df_paly_mass$ability_to_fly == "Apterygiformes",]
ggplot(df_fly_not1, aes(x = logMass, y = GhAhSkew))+
geom_point()
ggplot(df_fly_not1, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
ggplot(df_fly_not1, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_fly_not2 = df_paly_mass[df_paly_mass$ability_to_fly == "Gruiformes",]
ggplot(df_fly_not2, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_fly_not3 = df_paly_mass[df_paly_mass$ability_to_fly == "Casuariiformes",]
ggplot(df_fly_not3, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_fly_not4 = df_paly_mass[df_paly_mass$ability_to_fly == "Tinamiformes",]
ggplot(df_fly_not4, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_fly_not5 = df_paly_mass[df_paly_mass$ability_to_fly == "Columbiformes",]
ggplot(df_fly_not5, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_fly_not6 = df_paly_mass[df_paly_mass$ability_to_fly == "Rheiformes",]
ggplot(df_fly_not6, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
View(df_fly_not6)
df_fly_not7 = df_paly_mass[df_paly_mass$ability_to_fly == "Eurypygiformes",]
ggplot(df_fly_not7, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_fly_not8 = df_paly_mass[df_paly_mass$ability_to_fly == "Psittaciformes",]
ggplot(df_fly_not8, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_fly_not9 = df_paly_mass[df_paly_mass$ability_to_fly == "Struthioniformes",]
ggplot(df_fly_not9, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_fly_not8 = df_paly_mass[df_paly_mass$ability_to_fly == "Psittaciformes",]
ggplot(df_fly_not8, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_fly_not9 = df_paly_mass[df_paly_mass$ability_to_fly == "Struthioniformes",]
ggplot(df_fly_not9, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
#dive pgls
df_dive = read.csv('dive_and_gene.csv')
df_dive = df_dive[,c(2:6)]
dive_tree = read.tree('diving_birds_tree.tre')
row.names(df_dive) = df_dive$species_name
df_dive_mass = merge(df_dive, df_temp_fly)
df_dive_mass$Mass = as.numeric(df_dive_mass$Mass)
df_dive_mass$logMass = log10(df_dive_mass$Mass)
ggplot(df_dive_mass, aes(x = logMass, y = GhAhSkew, color = ability_to_dive))+
geom_point()
unique(df_dive_mass$ability_to_dive)
df_dive_mass1 = df_dive_mass[df_dive_mass$ability_to_fly == "Charadriiformes",]
ggplot(df_fdive_mass, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_dive_mass1 = df_dive_mass[df_dive_mass$ability_to_fly == "Charadriiformes",]
ggplot(df_dive_mass1, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_dive_mass1 = df_dive_mass[df_dive_mass$ability_to_dive == "Charadriiformes",]
ggplot(df_dive_mass1, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_dive_mass2 = df_dive_mass[df_dive_mass$ability_to_dive == "Anseriformes",]
ggplot(df_dive_mass2, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_dive_mass3 = df_dive_mass[df_dive_mass$ability_to_dive == "Coraciiformes",]
ggplot(df_dive_mass3, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_dive_mass4 = df_dive_mass[df_dive_mass$ability_to_dive == "Suliformes",]
ggplot(df_dive_mass4, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_dive_mass5 = df_dive_mass[df_dive_mass$ability_to_dive == "Sphenisciformes",]
ggplot(df_dive_mass5, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_dive_mass6 = df_dive_mass[df_dive_mass$ability_to_dive == "Passeriformes",]
ggplot(df_dive_mass6, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_dive_mass7 = df_dive_mass[df_dive_mass$ability_to_dive == "Procellariiformes",]
ggplot(df_dive_mass7, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_dive_mass8 = df_dive_mass[df_dive_mass$ability_to_dive == "Gruiformes",]
ggplot(df_dive_mass8, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_dive_mass7 = df_dive_mass[df_dive_mass$ability_to_dive == "Procellariiformes",]
ggplot(df_dive_mass7, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_dive_mass8 = df_dive_mass[df_dive_mass$ability_to_dive == "Gruiformes",]
ggplot(df_dive_mass8, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_dive_mass9 = df_dive_mass[df_dive_mass$ability_to_dive == "Gaviiformes",]
ggplot(df_dive_mass9, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
df_dive_mass10 = df_dive_mass[df_dive_mass$ability_to_dive == "Podicipediformes",]
ggplot(df_dive_mass10, aes(x = logMass, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)
#new PGLS for birds
rm(list = ls(all=TRUE))
df_mtdna = read.csv('Birds_dataset_paper.csv')
View(df_mtdna)
rm(list=ls(all=T))
rm(list=ls(all=T))
library(ggtree)
library(ggplot2)
library(treeio)
library(dplyr)
library(ape)
library(geiger)
df_mtdna = read.csv('Birds_dataset_paper.csv')
View(df_mtdna)
a = sub('formes.*', '', df_mtdna$taxonomy)
a
b = sub(".* ", "", a)
df_mtdna1 = df_mtdna
df_mtdna1$taxonomy = sub('formes.*', '', df_mtdna1$taxonomy)
View(df_mtdna1)
df_mtdna1$taxonomy = sub(".* ", "", a)
df_mtdna1$taxonomy = paste(df_mtdna1$taxonomy, 'formes')
df_mtdna1 = df_mtdna
df_mtdna1$taxonomy = sub('formes.*', '', df_mtdna1$taxonomy)
df_mtdna1$taxonomy = sub(".* ", "", a)
df_mtdna1$taxonomy = paste(df_mtdna1$taxonomy, 'formes', sep = '')
df_tax = df_mtdna1[,c(2,5)]
df_tax = unique(df_mtdna1[,c(2,5)])
df_flight = read.csv('flight_and_gene.csv')
View(df_flight)
df_temp_fly = read.csv('birds_metrics.csv')
View(df_temp_fly)
colnames(df_mtdna)
rm(list=ls(all=T))
df_mtdna = read.csv('Birds_dataset_paper.csv')
df_mtdna1 = df_mtdna
df_mtdna1$taxonomy = sub('formes.*', '', df_mtdna1$taxonomy)
df_mtdna1$taxonomy = sub(".* ", "", a)
df_mtdna1$taxonomy = paste(df_mtdna1$taxonomy, 'formes', sep = '')
df_tax = unique(df_mtdna1[,c(2,5)])
View(df_tax)
rm(list=ls(all=T))
df_mtdna = read.csv('Birds_dataset_paper.csv')
df_mtdna1 = df_mtdna
df_mtdna1$taxonomy = sub('formes.*', '', df_mtdna1$taxonomy)
df_mtdna1$taxonomy = sub(".* ", "", df_mtdna1$taxonomy)
df_mtdna1$taxonomy = paste(df_mtdna1$taxonomy, 'formes', sep = '')
df_tax = unique(df_mtdna1[,c(2,5)])
View(df_tax)
df_need = data.frame()
for (i in unique(df_mtdna$species_name))
{
a = df_mtdna[df_mtdna$species_name == i,]
b = sum(a$ghahSkew)/12
ab = c(i,b)
df_need = rbind(df_need, ab)
}
View(df_need)
names(df_need) = c('species_name', 'GhAhSkew')
df_tax = unique(df_mtdna1[,c(2,5, 'Mass')])
df_tax = unique(df_mtdna1[,c(2,5,117)])
View(df_tax)
rm(list=ls(all=T))
df_mtdna = read.csv('Birds_dataset_paper.csv')
df_mtdna1 = df_mtdna
df_mtdna1$taxonomy = sub('formes.*', '', df_mtdna1$taxonomy)
df_mtdna1$taxonomy = sub(".* ", "", df_mtdna1$taxonomy)
df_mtdna1$taxonomy = paste(df_mtdna1$taxonomy, 'formes', sep = '')
df_tax = unique(df_mtdna1[,c(2,5,117)])
View(df_tax)
df_tax$logMass = log10(df_tax$Mass)
df_need = data.frame()
for (i in unique(df_mtdna$species_name))
{
a = df_mtdna[df_mtdna$species_name == i,]
b = sum(a$ghahSkew)/12
ab = c(i,b)
df_need = rbind(df_need, ab)
}
names(df_need) = c('species_name', 'GhAhSkew')
df_tax = merge(df_tax, df_need)
View(df_tax)
ggplot(df_tax, aes(x = logMass,y = GhAhSkew))+
geom_point()
df_tax$GhAhSkew = as.numeric(df_tax$GhAhSkew)
ggplot(df_tax, aes(x = logMass,y = GhAhSkew))+
geom_point()
ggplot(df_tax, aes(x = logMass,y = GhAhSkew, color = taxonomy))+
geom_point()
ggplot(df_tax, aes(x = logMass,y = GhAhSkew))+
geom_point()
ggplot(df_tax, aes(x = logMass,y = GhAhSkew))+
geom_point()+
labs('AAA')
ggplot(df_tax, aes(x = logMass,y = GhAhSkew))+
geom_point()+
labs('AAA')
ggplot(df_tax, aes(x = logMass,y = GhAhSkew))+
geom_point()+
labs('AAA')
ggplot(df_tax, aes(x = logMass,y = GhAhSkew))+
geom_point()+
ggtitle('AAA')
ggplot(df_tax, aes(x = logMass,y = GhAhSkew))+
geom_point()+
ggtitle('AAAaaaaaaaaaaaa')
for (i in unique(df_tax$taxonomy))
{
a = df_tax[df_tax$taxonomy == i,]
b = ggplot(a, aes(x = logMass, y = GhAhSkew))+
geom_point()+
ggtitle(i)
assign(paste0("Order_", i), b)
counter = counter + 1
}
counter = 0
for (i in unique(df_tax$taxonomy))
{
a = df_tax[df_tax$taxonomy == i,]
b = ggplot(a, aes(x = logMass, y = GhAhSkew))+
geom_point()+
ggtitle(i)
assign(paste0("Order_", i), b)
counter = counter + 1
}
Order_Apodiformes
rm(list=ls(all=T))
df_mtdna = read.csv('Birds_dataset_paper.csv')
df_mtdna1 = df_mtdna
df_mtdna1$taxonomy = sub('formes.*', '', df_mtdna1$taxonomy)
df_mtdna1$taxonomy = sub(".* ", "", df_mtdna1$taxonomy)
df_mtdna1$taxonomy = paste(df_mtdna1$taxonomy, 'formes', sep = '')
df_tax = unique(df_mtdna1[,c(2,5,117)])
df_tax$logMass = log10(df_tax$Mass)
df_need = data.frame()
for (i in unique(df_mtdna$species_name))
{
a = df_mtdna[df_mtdna$species_name == i,]
b = sum(a$ghahSkew)/12
ab = c(i,b)
df_need = rbind(df_need, ab)
}
names(df_need) = c('species_name', 'GhAhSkew')
df_tax = merge(df_tax, df_need)
df_tax$GhAhSkew = as.numeric(df_tax$GhAhSkew)
counter = 0
for (i in unique(df_tax$taxonomy))
{
a = df_tax[df_tax$taxonomy == i,]
b = ggplot(a, aes(x = logMass, y = GhAhSkew))+
geom_point()+
ggtitle(i)+
geom_smooth(method = 'lm', formula = y~x)
assign(paste0("Order_", i), b)
counter = counter + 1
}
Order_Apodiformes
library(ggpubr)
ggarrange(Order_Accipitriformes, Order_Anseriformes, Order_Apodiformes, Order_Apterygiformes, Order_Bucerotiformes, Order_Caprimulgiformes, Order_Casuariiformes, Order_Charadriiformes, Order_Ciconiiformes, Order_Coliiformes, Order_Columbiformes, Order_Coraciiformes, Order_Cuculiformes, Order_Falconiformes, Order_Galbuliformes, Order_Galliformes, Order_Gaviiformes, Order_Gruiformes, Order_Musophagiformes, Order_Passeriformes, Order_Pelecaniformes, Order_Phoenicopteriformes, Order_Piciformes, Order_Podicipediformes, Order_Procellariiformes, Order_Psittaciformes, Order_Rheiformes, Order_Sphenisciformes, Order_Strigiformes, Order_Struthioniformes, Order_Tinamiformes, Order_Trogoniformes, Order_Upupiformes,
ncol = 3, nrow = 11)
rm(list=ls(all=T))
