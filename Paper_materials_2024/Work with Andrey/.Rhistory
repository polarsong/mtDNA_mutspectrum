rm(list = ls(all=TRUE))
library(ggfortify)
library(ggplot2)
library(ggpubr)
library(ggbiplot)
library(phytools)
library(nlme)
library(geiger)
library(ggtree)
library(stringr)
library(dplyr)
df_mtdna = read.csv('../../Paper_materials_2024/Birds_dataset_paper.csv')
View(df_mtdna)
unique(df_mtdna$Primary_lifestyle)
unique(df_mtdna$Habitat)
df_eco = read.csv('final_birds_list_with_no_mistakes.csv')
View(df_eco)
df_eco = df_eco[,c(2,6)]
View(df_eco)
df_mtdna1 = merge(df_mtdna, df_eco)
names(df_eco) = c('species_name', 'foraging niche')
df_mtdna1 = merge(df_mtdna, df_eco, by = 'species_name')
View(df_mtdna1)
View(df_eco)
na.omit(df_eco)
df_eco = na.omit(df_eco)
View(df_eco)
df_mtdna1 = merge(df_mtdna, df_eco, by = 'species_name')
View(df_mtdna1)
df_mtdna1 = unique(df_mtdna1)
ggplot(df_mtdna1, x = foraging niche, y = GhAhSkew)+
names(df_eco) = c('species_name', 'foraging_niche')
df_mtdna1 = merge(df_mtdna, df_eco, by = 'species_name')
df_mtdna1 = unique(df_mtdna1)
ggplot(df_mtdna1, x = foraging_niche, y = GhAhSkew)+
geom_boxplot()
ggplot(df_mtdna1, x = foraging_niche, y = ghahSkew)+
geom_boxplot()
ggplot(df_mtdna1, x = foraging_niche, y = ghahskew)+
geom_boxplot()
df_mtdna1$
ggplot(df_mtdna1, aes(x = foraging_niche, y = ghahSkew))+
geom_boxplot()
df_mtdna1$
ggplot(df_mtdna1, aes(x = foraging_niche, y = ghahSkew))+
geom_boxplot()
ggplot(df_mtdna1, aes(x = foraging_niche, y = ghahSkew))+
geom_boxplot()
ggplot(df_mtdna1, aes(x = foraging_niche, y = ghahSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
df_mtdna2 = df_mtdna1[df_mtdna1$foraging_niche == 'Vertivore ground',]
View(df_mtdna2)
df_short = data.frame()
names_v = unique(df_mtdna1$species_name)
for (i in names_v)
{
df1 = df_mtdna1[df_mtdna1$species_name == i,]
a = sum(df1$ghahSkew)/12
b = sum(df1$chthSkew)/12
v = sum(df1$Mass)/12
ab = c(i, a, b, v)
df_short = rbind(df_short, ab)
}
View(df_short)
names_v = unique(df_mtdna$species_name)
df_short = data.frame()
names_v = unique(df_mtdna1$species_name)
df_short = data.frame()
for (i in names_v)
{
df1 = df_mtdna1[df_mtdna1$species_name == i,]
a = sum(df1$ghahSkew)/12
b = sum(df1$chthSkew)/12
v = unique(df1$foraging_niche)
ab = c(i, a, b, v)
df_short = rbind(df_short, ab)
}
View(df_short)
names(df_short) = c('species_name', 'GhAhSkew', 'ThChSkew', 'Foraging_niche')
ggplot(df_short, aes(x = foraging_niche, y = GhAhSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(df_short, aes(x = Foraging_niche, y = GhAhSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
df_short$GhAhSkew = as.numeric(df_short$GhAhSkew)
ggplot(df_short, aes(x = Foraging_niche, y = GhAhSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
rm(list = ls(all=TRUE))
rm(list = ls(all=TRUE))
library(ggbiplot)
library(ggplot2)
library(ggpubr)
df_mtdna = read.csv('../../Paper_materials/Birds_dataset_paper_extra.csv')
rm(list = ls(all=TRUE))
library(ggfortify)
library(ggplot2)
library(ggpubr)
library(ggbiplot)
library(phytools)
library(nlme)
library(geiger)
library(ggtree)
library(stringr)
library(dplyr)
df_mtdna = read.csv('../../Paper_materials_2024/Birds_dataset_paper.csv')
unique(df_mtdna$Habitat)
df_eco = read.csv('final_birds_list_with_no_mistakes.csv')
df_eco = df_eco[,c(2,6)]
names(df_eco) = c('species_name', 'foraging_niche')
df_eco = na.omit(df_eco)
df_mtdna1 = merge(df_mtdna, df_eco, by = 'species_name')
df_mtdna1 = unique(df_mtdna1)
ggplot(df_mtdna1, aes(x = foraging_niche, y = ghahSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
df_mtdna2 = df_mtdna1[df_mtdna1$foraging_niche == 'Vertivore ground',]
names_v = unique(df_mtdna1$species_name)
df_short = data.frame()
for (i in names_v)
{
df1 = df_mtdna1[df_mtdna1$species_name == i,]
a = sum(df1$ghahSkew)/12
b = sum(df1$chthSkew)/12
v = unique(df1$foraging_niche)
ab = c(i, a, b, v)
df_short = rbind(df_short, ab)
}
names(df_short) = c('species_name', 'GhAhSkew', 'ThChSkew', 'Foraging_niche')
df_short$GhAhSkew = as.numeric(df_short$GhAhSkew)
ggplot(df_short, aes(x = Foraging_niche, y = GhAhSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
df_int = read.csv('../Body/1Raw/Avonet_data.csv')
df_int = read.csv('../../Body/1Raw/Avonet_data.csv')
View(df_int)
df_migr = df_int[,c('Species3', 'Migration')]
names(df_migr) = c('species_name', 'migration')
df_migr_mtdna = merge(df_mtdna, df_migr, by = 'species_name')
df_migr_mtdna$migration = as.character(df_migr_mtdna$migration)
ggplot(df_migr_mtdna, aes(x = migration, y = ghahSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
df_short1 = merge(df_short, df_int)
View(df_short)
df_short1 = merge(df_short, df_migr)
ggplot(df_short1, aes(x = migration, y = GhAhSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
View(df_short1)
df_short1$migration = as.character(df_short1$migration)
ggplot(df_short1, aes(x = migration, y = GhAhSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
names_v = unique(df_mtdna$species_name)
df_short1 = data.frame()
for (i in names_v)
{
df1 = df_mtdna[df_mtdna$species_name == i,]
a = sum(df1$ghahSkew)/12
b = sum(df1$chthSkew)/12
ab = c(i, a, b)
df_short = rbind(df_short, ab)
}
rm(list = ls(all=TRUE))
rm(list = ls(all=TRUE))
library(ggfortify)
library(ggplot2)
library(ggpubr)
library(ggbiplot)
library(phytools)
library(nlme)
library(geiger)
library(ggtree)
library(stringr)
library(dplyr)
df_mtdna = read.csv('../../Paper_materials_2024/Birds_dataset_paper.csv')
unique(df_mtdna$Habitat)
df_eco = read.csv('final_birds_list_with_no_mistakes.csv')
df_eco = df_eco[,c(2,6)]
names(df_eco) = c('species_name', 'foraging_niche')
df_eco = na.omit(df_eco)
df_mtdna1 = merge(df_mtdna, df_eco, by = 'species_name')
df_mtdna1 = unique(df_mtdna1)
ggplot(df_mtdna1, aes(x = foraging_niche, y = ghahSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
df_mtdna2 = df_mtdna1[df_mtdna1$foraging_niche == 'Vertivore ground',]
names_v = unique(df_mtdna1$species_name)
df_short = data.frame()
for (i in names_v)
{
df1 = df_mtdna1[df_mtdna1$species_name == i,]
a = sum(df1$ghahSkew)/12
b = sum(df1$chthSkew)/12
v = unique(df1$foraging_niche)
ab = c(i, a, b, v)
df_short = rbind(df_short, ab)
}
names(df_short) = c('species_name', 'GhAhSkew', 'ThChSkew', 'Foraging_niche')
df_short$GhAhSkew = as.numeric(df_short$GhAhSkew)
ggplot(df_short, aes(x = Foraging_niche, y = GhAhSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
df_int = read.csv('../../Body/1Raw/Avonet_data.csv')
df_migr = df_int[,c('Species3', 'Migration')]
names(df_migr) = c('species_name', 'migration')
df_migr_mtdna = merge(df_mtdna, df_migr, by = 'species_name')
df_migr_mtdna$migration = as.character(df_migr_mtdna$migration)
names_v = unique(df_mtdna$species_name)
df_short1 = data.frame()
for (i in names_v)
{
df1 = df_mtdna[df_mtdna$species_name == i,]
a = sum(df1$ghahSkew)/12
b = sum(df1$chthSkew)/12
ab = c(i, a, b)
df_short1 = rbind(df_short1, ab)
}
names(df_short1) = c('species_name', 'GhAhSkew', 'ThChSkew', 'Foraging_niche')
View(df_short1)
names(df_short1) = c('species_name', 'GhAhSkew', 'ThChSkew')
df_short1$GhAhSkew = as.numeric(df_short1$GhAhSkew)
df_short1 = merge(df_short1, df_migr)
df_short1$migration = as.character(df_short1$migration)
ggplot(df_migr_mtdna, aes(x = migration, y = ghahSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(df_short1, aes(x = migration, y = GhAhSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
wilcox.test(df_short1[df_short1$migration == '2',]$species_name, df_short1[df_short1$migration == '1',]$species_name)
wilcox.test(df_short1[df_short1$migration == '2',]$GhAhSkew, df_short1[df_short1$migration == '1',]$GhAhSkew)
wilcox.test(df_short1[df_short1$migration == '2',]$GhAhSkew, df_short1[df_short1$migration == '3',]$GhAhSkew)
wilcox.test(df_short1[df_short1$migration == '3',]$GhAhSkew, df_short1[df_short1$migration == '1',]$GhAhSkew)
View(df_mtdna)
#HWI and Kipp's distance
df_metrics = df_mtdna[,c('realm', 'trophic_niche', 'Hand-wing index', "Kipp's distance")]
df_mtdna$
#HWI and Kipp's distance
df_metrics = df_mtdna[,c('realm', 'Trophic_niche', 'Hand_wing_index', "Kipps_distance")]
df_mtdna$
#HWI and Kipp's distance
df_metrics = df_mtdna[,c('realm', 'Trophic_niche', 'Hand_wing_index', "Kipps_distance")]
#HWI and Kipp's distance
df_metrics = df_mtdna[,c('realm', 'Trophic_niche', 'Hand_wing_index', "Kipps_distance")]
View(df_metrics)
#HWI and Kipp's distance
df_metrics = unique(df_mtdna[,c('realm', 'Trophic_niche', 'Hand_wing_index', "Kipps_distance")])
View(df_metrics)
#HWI and Kipp's distance
df_metrics = unique(df_mtdna[,c('species_name', 'realm', 'Trophic_niche', 'Hand_wing_index', "Kipps_distance")])
View(df_short1)
df_short2 = merge(df_short1, df_metrics)
View(df_short2)
ggplot(df_short2, aes(x = Hand_wing_index, y = GhAhSkew))+
geom_point()+
geom_smooth(method=lm)
View(df_mtdna)
#Orders
df_mtdna_orders = df_mtdna[,c(2,5)]
View(df_mtdna_orders)
df_mtdna_orders$taxonomy = gsub("^.*?_"," ","ATGAS_1121")
#Orders
df_mtdna_orders = df_mtdna[,c(2,5)]
df_mtdna_orders$taxonomy = gsub("^.*?_"," ", df_mtdna_orders$taxonomy)
df_mtdna_orders$taxonomy = gsub("\\..*"," ", df_mtdna_orders$taxonomy)
df_mtdna_orders$taxonomy = gsub("\\ .*"," ", df_mtdna_orders$taxonomy)
#Orders
df_mtdna_orders = unique(df_mtdna[,c(2,5)])
df_mtdna_orders$taxonomy = gsub("^.*?_"," ", df_mtdna_orders$taxonomy)
df_mtdna_orders$taxonomy = gsub("\\ .*"," ", df_mtdna_orders$taxonomy)
#Orders
df_mtdna_orders = unique(df_mtdna[,c(2,5)])
df_mtdna_orders$taxonomy = gsub("^.*?_","formes", df_mtdna_orders$taxonomy)
df_mtdna_orders$taxonomy = gsub("\\formes.*"," ", df_mtdna_orders$taxonomy)
df_mtdna_orders$taxonomy = gsub("\\ .*"," ", df_mtdna_orders$taxonomy)
#Orders
df_mtdna_orders = unique(df_mtdna[,c(2,5)])
df_mtdna_orders$taxonomy = gsub("^.*?_"," ", df_mtdna_orders$taxonomy)
df_mtdna_orders$taxonomy = gsub("^.*?_"," ", df_mtdna_orders$taxonomy)
df_mtdna_orders$taxonomy = gsub("^.*?_"," ", df_mtdna_orders$taxonomy)
df_mtdna_orders$taxonomy = sub('.*formes', '', df_mtdna_orders$taxonomy)
#Orders
df_mtdna_orders = unique(df_mtdna[,c(2,5)])
df_mtdna_orders$taxonomy = sub('formes.*', '', df_mtdna_orders$taxonomy)
df_mtdna_orders$taxonomy = sub(' *\\.', '', x)
df_mtdna_orders$taxonomy = sub(' *\\.', '', df_mtdna_orders$taxonomy)
df_mtdna_orders$taxonomy = sub('.*\\ ', '', df_mtdna_orders$taxonomy)
df_mtdna_orders$taxonomy = paste(df_mtdna_orders$taxonomy, 'formes', sep = '')
df_short2 = merge(df_short2, df_mtdna_orders)
ggplot(df_short2, aes(x = Hand_wing_index, y = GhAhSkew, color = taxonomy))+
geom_point()+
geom_smooth(method=lm)
ggplot(df_short2, aes(x = Hand_wing_index, y = GhAhSkew))+
geom_point(color = taxonomy)+
geom_smooth(method=lm)
ggplot(df_short2, aes(x = Hand_wing_index, y = GhAhSkew, fill = taxonomy))+
geom_point()+
geom_smooth(method=lm)
ggplot(df_short2, aes(x = Hand_wing_index, y = GhAhSkew))+
geom_point(aes(colour = factor(taxonomy)))+
geom_smooth(method=lm)
ggplot(df_short2, aes(x = Hand_wing_index, y = GhAhSkew))+
geom_point()+
geom_smooth(method=lm)
ggplot(df_short2, aes(x = Kipps_distance, y = GhAhSkew))+
geom_point()+
geom_smooth(method=lm)
ggplot(df_short2, aes(x = log10(Kipps_distance), y = GhAhSkew))+
geom_point()+
geom_smooth(method=lm)
ggplot(df_short2, aes(x = Hand_wing_index, y = GhAhSkew))+
geom_point()+
geom_smooth(method=lm)
ggplot(df_short2, aes(x = taxonomy, y = GhAhSkew))+
geom_boxplot()
ggplot(df_short2, aes(x = taxonomy, y = GhAhSkew))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
View(df_short2)
rm(list = ls(all=TRUE))
