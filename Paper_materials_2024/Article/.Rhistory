rm(list = ls(all=TRUE))
library(ggfortify)
library(ggplot2)
library(ggpubr)
library(ggbiplot)
library(phytools)
library(nlme)
library(geiger)
library(ggtree)
library(stringr)
library(dplyr)
#preparing datasets
df_mtdna = read.csv('Birds_dataset_paper.csv')
df_nd6 = read.csv('Birds_mtDNA_data.csv')
df_nd6$GhAhSkew = (df_nd6$neutral_g - df_nd6$neutral_A)/(df_nd6$neutral_g + df_nd6$neutral_A)
df_nd6$ThChSkew = (df_nd6$neutral_T - df_nd6$neutral_c)/(df_nd6$neutral_T + df_nd6$neutral_c)
df_nd6$fTn = df_nd6$neutral_T/df_nd6$neutral_amount
df_nd6$fAn = df_nd6$neutral_A/df_nd6$neutral_amount
#preparing datasets
df_mtdna = read.csv('../../Work_with_AndreyBirds_dataset_paper.csv')
#preparing datasets
df_mtdna = read.csv('../Work_with_AndreyBirds_dataset_paper.csv')
#preparing datasets
df_mtdna = read.csv('../../Work_with_Andrey/Birds_dataset_paper.csv')
#preparing datasets
df_mtdna = read.csv('../Work_with_Andrey/Birds_dataset_paper.csv')
#preparing datasets
df_mtdna = read.csv('../Work_with_Andrey/Birds_dataset_paper.csv', header = TRUE, sep = ';')
View(df_mtdna)
df_nd6 = read.csv('../Birds_mtDNA_data.csv')
df_nd6$GhAhSkew = (df_nd6$neutral_g - df_nd6$neutral_A)/(df_nd6$neutral_g + df_nd6$neutral_A)
df_nd6$ThChSkew = (df_nd6$neutral_T - df_nd6$neutral_c)/(df_nd6$neutral_T + df_nd6$neutral_c)
df_nd6$fTn = df_nd6$neutral_T/df_nd6$neutral_amount
df_nd6$fAn = df_nd6$neutral_A/df_nd6$neutral_amount
df_nd6$fCn = df_nd6$neutral_c/df_nd6$neutral_amount
df_nd6$fGn = df_nd6$neutral_g/df_nd6$neutral_amount
df_nd6$GhAhSkew = (df_nd6$neutral_c- df_nd6$neutral_T)/(df_nd6$neutral_c + df_nd6$neutral_T)
df_nd6$ThChSkew = (df_nd6$neutral_A - df_nd6$neutral_g)/(df_nd6$neutral_A + df_nd6$neutral_g)
df_nd6$fTn = df_nd6$neutral_A/df_nd6$neutral_amount
df_nd6$fAn = df_nd6$neutral_T/df_nd6$neutral_amount
df_nd6$fCn = df_nd6$neutral_g/df_nd6$neutral_amount
df_nd6$fGn = df_nd6$neutral_c/df_nd6$neutral_amount
View(df_mtdna)
#TBSS statistics
col1 = df_mtdna[df_mtdna$gene_name == 'COX1',]
col2 = df_mtdna[df_mtdna$gene_name == 'CYTB',]
wilcox.test(col1$ghahSkew, col2$ghahSkew)
wilcox.test(as.numeric(as.character(col1$ghahSkew)), as.numeric(as.character(col2$ghahSkew)))
col1$ghahSkew
col1$ghahSkew = as.numeric(as.character(col1$ghahSkew))
col1$ghahSkew
#TBSS statistics
col1 = df_mtdna[df_mtdna$gene_name == 'COX1',]
col1$ghahSkew = as.numeric(col1$ghahSkew)
col1$ghahSkew
#TBSS statistics
col1 = df_mtdna[df_mtdna$gene_name == 'COX1',]
col1$ghahSkew
#TBSS statistics
col1 = df_nd6[df_nd6$gene_name == 'COX1',]
col1$GhAhSkew
col2 = df_nd6[df_nd6$gene_name == 'CYTB',]
wilcox.test(col1$ghahSkew,col2$ghahSkew)
wilcox.test(col1$GhAhSkew,col2$GhAhSkew)
#TBSS statistics
col1 = df_nd6[df_nd6$gene_name == 'ND1',]
col2 = df_nd6[df_nd6$gene_name == 'ND2',]
wilcox.test(col1$GhAhSkew,col2$GhAhSkew)
wilcox.test(col1$ThChSkew, col2$ThChSkew)
col1 = df_nd6[df_nd6$gene_name == 'ND1',]
col2 = df_nd6[df_nd6$gene_name == 'ND2',]
wilcox.test(col1$GhAhSkew,col2$GhAhSkew)
wilcox.test(col1$ThChSkew, col2$ThChSkew
wilcox.test(col1$ThChSkew, col2$ThChSkew)
wilcox.test(col1$ThChSkew, col2$ThChSkew)
df_mtdna$ghahSkew = gsub(',', '.', df_mtdna$ghahSkew)
df_mtdna$chthSkew = gsub(',', '.', df_mtdna$chthSkew)
df_mtdna$ghahSkew = as.numeric(as.character(df_mtdna$ghahSkew))
df_mtdna$chthSkew = as.numeric(as.character(df_mtdna$chthSkew))
b_names = df_mtdna$Species
b_names = unique(df_mtdna$Species)
b_names
spearman_rhos = data.frame()
df_mtdna_cut = df_mtdna[df_mtdna$gene_name != 'ND1',]
df_mtdna_cut = df_mtdna[df_mtdna$gene_name != 'ND2',]
df_mtdna_cut = df_mtdna[df_mtdna$gene_name != 'ND1',]
df_mtdna_cut = df_mtdna_cut[df_mtdna_cut$gene_name != 'ND2',]
b_names = unique(df_mtdna$Species)
tbss = c(1,2,3,4,5,6,7,8,9,10)
cor.test(x,y)
x = c(12,534,2414)
y = (124124, 1241, 13123)
y = (124124, 1241, 13123)
y = (124124,1241,13123)
y = c(124124,1241,13123)
cor.test(x,y)
a = cor.test(x,y)
a$p.value
for (i in b_names)
{
df_bird = df_mtdna[df_mtdna$Species == i,]
speart = cor.test(df_bird$ghahSkew, tbss)
b_names = rbind(b_names, c(i, speart$p.value))
}
View(df_bird)
b_names = unique(df_mtdna$Species)
spearman_rhos = data.frame()
tbss = c(1,2,3,4,5,6,7,8,9,10)
for (i in b_names)
{
df_bird = df_mtdna_cut[df_mtdna_cut$Species == i,]
speart = cor.test(df_bird$ghahSkew, tbss)
b_names = rbind(b_names, c(i, speart$p.value))
}
View(speart)
View(df_mtdna_cut)
View(df_bird)
View(df_mtdna)
df_mtdna[df_mtdna_cut$Species == "Drepanis coccinea",]$Species = "Vestiaria coccinea"
b_names = unique(df_mtdna$Species)
df_mtdna_cut[df_mtdna_cut$Species == "Drepanis coccinea",]$Species = "Vestiaria coccinea"
b_names = unique(df_mtdna_cut$Species)
spearman_rhos = data.frame()
tbss = c(1,2,3,4,5,6,7,8,9,10)
for (i in b_names)
{
df_bird = df_mtdna_cut[df_mtdna_cut$Species == i,]
speart = cor.test(df_bird$ghahSkew, tbss)
b_names = rbind(b_names, c(i, speart$p.value))
}
View(speart)
View(spearman_rhos)
b_names = unique(df_mtdna_cut$Species)
spearman_rhos = data.frame()
tbss = c(1,2,3,4,5,6,7,8,9,10)
for (i in b_names)
{
df_bird = df_mtdna_cut[df_mtdna_cut$Species == i,]
speart = cor.test(df_bird$ghahSkew, tbss)
spearman_rhos = rbind(b_names, c(i, speart$p.value))
}
b_names = unique(df_mtdna_cut$Species)
spearman_rhos = data.frame()
tbss = c(1,2,3,4,5,6,7,8,9,10)
for (i in b_names)
{
df_bird = df_mtdna_cut[df_mtdna_cut$Species == i,]
speart = cor.test(df_bird$ghahSkew, tbss)
spearman_rhos = rbind(spearman_rhos, c(i, speart$p.value))
}
spearman_rhos_thchskew = data.frame()
rm(list = ls(all=TRUE))
