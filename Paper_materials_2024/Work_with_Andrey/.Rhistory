ols_plot_resid_hist(model) # Histogram of residuals for detecting violation of normality assumption
ols_plot_resid_fit(model) # Residual vs Fitted Values Plot (scatter plot of residuals on the y axis and fitted values on the x axis to detect non-linearity, unequal error variances, and outliers)
plot(model)
library(nortest); library(see); library (performance)
check_normality(model) # same as shapiro.test(rstandard(model)) for LM
library(nortest)
library(see)
library (performance)
check_normality(model) # same as shapiro.test(rstandard(model)) for LM
plot(check_normality(model)) # plot residuals and Gaussian distribution
check_normality(model) # same as shapiro.test(rstandard(model)) for LM
plot(check_normality(model)) # plot residuals and Gaussian distribution
shapiro.test(residuals(model))
shapiro.test(rstandard(model))
shapiro.test(rstudent(model))
library(gvlma)
summary(gvlma(model)) #Tests the main assumptions of regression analysis
plot(gvlma(model))
# Evaluate homoscedasticity
library(car)
ncvTest(model) # non-constant error variance test (Breusch–Pagan test). Null-hypothesis (homoskedasticity) is rejected when p < 0.05 (i.e. presence of Heteroscedasticity)
spreadLevelPlot(model) # plot studentized residuals vs. fitted values
summary (model_1)
plot(residuals(lm(log_BMR~log_Mass, data=BMR)) ~ log10(chthSkew), data=BMR)
abline(lm(residuals(lm(log_BMR~log_Mass, data=BMR)) ~ log10(chthSkew), data=BMR))
###########################################################
library(ape); library(phytools);  library(geiger)
feathertree <- read.tree("anc_kg.tre")
feathertree <- read.tree("anc_kg.tre")
feathertree$node.label <- NULL # Remove internal node labels (if any)
is.ultrametric(feathertree)
is.binary(feathertree)
is.rooted(feathertree)
feathertree <- root(feathertree, outgroup = "Struthio_camelus", resolve.root = TRUE)
mycalibration <- makeChronosCalib(feathertree, node="root", age.max=94)
feathertree <- chronos(feathertree, lambda=0, model = 'correlated', calibration = mycalibration)
is.ultrametric(feathertree)
is.binary(feathertree)
is.rooted(feathertree)
BMR$Species <- gsub(" ", "_", fixed = TRUE, BMR$Species) # Replaces spaces with _
listBMR <- BMR$Species
listTree <- feathertree$tip.label
View(DNA)
#PGLS  for binar metrics
df_flight = read.csv('../../Paper_materials_2024/flight_and_gene.csv')
View(df_flight)
df_flight = df_flight[,c(2,3,4,5,6)]
df_flight$flight_num = 0
df_flight[df_flight$ability_to_fly != 'Flying',]$flight_num = 1
rownames(df_flight) = df_flight$species_name
listSkew = df_flight$species_name
SpeciesToDrop <- setdiff(listTree, listSkew)
drop.tip(feathertree, SpeciesToDrop) -> Fly_skew_tree
plotTree(Fly_skew_tree, fsize=0.5)
rownames(df_flight) <- df_flight[,1]
View(feathertree)
df_flight <- df_flight[match(Fly_skew_tree$tip.label,rownames(df_flight)),]
attach(df_flight)
names(flight_num) = rownames(df_flight)
name.check(Fly_skew_tree, df_flight)
m1 <- gls(GhAhSkew~flight_num, data=df_flight, correlation=corPagel(value = 1, Fly_skew_tree, form = ~species_name, fixed=FALSE), method="ML") # ML estimation
summary(m1)
View(Fly_skew_tree)
#PGLS  for binar metrics
df_flight = read.csv('../../Paper_materials_2024/flight_and_gene.csv')
df_flight = df_flight[,c(2,3,4,5,6)]
df_flight$flight_num = 0
df_flight[df_flight$ability_to_fly != 'Flying',]$flight_num = 1
df_flight = df_flight[df_flight$ability_to_fly !='Sphenisciformes',]
rownames(df_flight) = df_flight$species_name
listSkew = df_flight$species_name
SpeciesToDrop <- setdiff(listTree, listSkew)
fly_tree
drop.tip(feathertree, SpeciesToDrop) -> Fly_skew_tree
rownames(df_flight) <- df_flight[,1]
df_flight <- df_flight[match(Fly_skew_tree$tip.label,rownames(df_flight)),]
attach(df_flight)
names(GhAhSkew) = rownames(df_flight)
names(flight_num) = rownames(df_flight)
name.check(Fly_skew_tree, df_flight)
library(nlme)
m1 <- gls(GhAhSkew~flight_num, data=df_flight, correlation=corPagel(value = 1, Fly_skew_tree, form = ~species_name, fixed=FALSE), method="ML") # ML estimation
summary(m1)
CompBMR <- comparative.data(Fly_skew_tree, df_flight, 'species_name', na.omit=FALSE, vcv=TRUE, vcv.dim=3) #vcv.dim=2 is default
library(caper)
CompBMR <- comparative.data(Fly_skew_tree, df_flight, 'species_name', na.omit=FALSE, vcv=TRUE, vcv.dim=3) #vcv.dim=2 is default
CompBMR <- comparative.data(Fly_skew_tree, df_flight, 'species_name', na.omit=FALSE, vcv=TRUE, vcv.dim=2) #vcv.dim=2 is default
SpeciesToDrop <- setdiff(listTree, listBMR) #Вычисляет, какие виды убрать из общего дерева
drop.tip(feathertree, SpeciesToDrop) -> BMRTree #Убирает лишние виды из дерева
plotTree(BMRTree, fsize=0.5)
rownames(BMR) <- BMR[,1]
BMR <- BMR[match(BMRTree$tip.label,rownames(BMR)),] # rearranging the rows of the data frame to match the order of species names in the tree object.
names(log_Mass) <- rownames(BMR)
names(log_BMR) <- rownames(BMR)
attach(BMR)
names(log_Mass) <- rownames(BMR)
names(log_BMR) <- rownames(BMR)
names(chthSkew) <- rownames(BMR)
names(ghahSkew) <- rownames(BMR)
name.check(BMRTree, BMR)
library(nlme)
library(caper)
CompBMR <- comparative.data(BMRTree, BMR, 'Species', na.omit=FALSE, vcv=TRUE, vcv.dim=3) #vcv.dim=2 is default
View(BMR)
rm(list = ls(all=TRUE))
BMR <- read.csv2("GlobalBMRbase.csv", header=T)
DNA <- read.csv2("Birds_dataset_paper.csv", header=T)
DNA <- DNA[c('Species', 'ghahSkew', 'chthSkew')]
DNA <- subset(DNA, Species!="Nothoprocta perdicaria")
BMR <- BMR[c('Species', 'Mass', 'TraitValue')]
DNA <- aggregate (DNA[,-1], by=list(DNA$Species), mean)
BMR <- aggregate (BMR[,-1], by=list(BMR$Species), mean)
BMR$log_Mass <- log10(BMR$Mass)
BMR$log_BMR <- log10(BMR$TraitValue)
BMR <- merge(BMR, DNA, by="Group.1", all.x=T)
BMR <- na.omit(BMR)
colnames(BMR)[1] <- "Species"
model_1 <- lm(ghahSkew ~ log_Mass + log_BMR, data=BMR)
model_2 <- lm(log10(ghahSkew) ~ log_Mass + log_BMR, data=BMR)
model_3 <- lm(chthSkew ~ log_Mass + log_BMR, data=BMR)
model_4 <- lm(log10(chthSkew) ~ log_Mass + log_BMR, data=BMR)
library(bbmle)
AICctab (model_1, model_2, weights=T)
AICctab (model_3, model_4, weights=T)
model <- model_1
library(olsrr) # To perform Residual Diagnostics
ols_plot_resid_qq(model) # Graph for detecting violation of normality assumption
ols_test_normality(model) # Test for detecting violation of normality assumption
ols_test_correlation(model) # Correlation between observed residuals and expected residuals under normality
ols_plot_resid_hist(model) # Histogram of residuals for detecting violation of normality assumption
ols_plot_resid_fit(model) # Residual vs Fitted Values Plot (scatter plot of residuals on the y axis and fitted values on the x axis to detect non-linearity, unequal error variances, and outliers)
library(nortest)
library(see)
library (performance)
check_normality(model) # same as shapiro.test(rstandard(model)) for LM
plot(check_normality(model)) # plot residuals and Gaussian distribution
shapiro.test(rstandard(model))
shapiro.test(rstudent(model))
###########################################################
library(ape); library(phytools);  library(geiger)
feathertree <- read.tree("anc_kg.tre")
feathertree$node.label <- NULL # Remove internal node labels (if any)
is.ultrametric(feathertree)
is.binary(feathertree)
is.rooted(feathertree)
feathertree <- root(feathertree, outgroup = "Struthio_camelus", resolve.root = TRUE)
mycalibration <- makeChronosCalib(feathertree, node="root", age.max=94)
feathertree <- chronos(feathertree, lambda=0, model = 'correlated', calibration = mycalibration)
is.ultrametric(feathertree)
is.binary(feathertree)
is.rooted(feathertree)
BMR$Species <- gsub(" ", "_", fixed = TRUE, BMR$Species) # Replaces spaces with _
listBMR <- BMR$Species
listTree <- feathertree$tip.label
SpeciesToDrop <- setdiff(listTree, listBMR) #Вычисляет, какие виды убрать из общего дерева
drop.tip(feathertree, SpeciesToDrop) -> BMRTree #Убирает лишние виды из дерева
plotTree(BMRTree, fsize=0.5)
rownames(BMR) <- BMR[,1]
BMR <- BMR[match(BMRTree$tip.label,rownames(BMR)),] # rearranging the rows of the data frame to match the order of species names in the tree object.
attach(BMR)
names(log_Mass) <- rownames(BMR)
names(log_BMR) <- rownames(BMR)
names(chthSkew) <- rownames(BMR)
names(ghahSkew) <- rownames(BMR)
name.check(BMRTree, BMR)
library(nlme)
m1 <- gls(log_BMR~log_Mass, data=BMR, correlation=corPagel(value = 1, BMRTree, form = ~Species, fixed=FALSE), method="ML") # ML estimation
summary(m1)
library(caper)
CompBMR <- comparative.data(BMRTree, BMR, 'Species', na.omit=FALSE, vcv=TRUE, vcv.dim=3) #vcv.dim=2 is default
View(BMRTree)
rm(list = ls(all=TRUE))
rm(list = ls(all=TRUE))
BMR <- read.csv2("GlobalBMRbase.csv", header=T)
DNA <- read.csv2("Birds_dataset_paper.csv", header=T)
DNA <- DNA[c('Species', 'ghahSkew', 'chthSkew')]
DNA <- subset(DNA, Species!="Nothoprocta perdicaria")
BMR <- BMR[c('Species', 'Mass', 'TraitValue')]
DNA <- aggregate (DNA[,-1], by=list(DNA$Species), mean)
BMR <- aggregate (BMR[,-1], by=list(BMR$Species), mean)
BMR$log_Mass <- log10(BMR$Mass)
BMR$log_BMR <- log10(BMR$TraitValue)
BMR <- merge(BMR, DNA, by="Group.1", all.x=T)
BMR <- na.omit(BMR)
colnames(BMR)[1] <- "Species"
model_1 <- lm(ghahSkew ~ log_Mass + log_BMR, data=BMR)
model_2 <- lm(log10(ghahSkew) ~ log_Mass + log_BMR, data=BMR)
model_3 <- lm(chthSkew ~ log_Mass + log_BMR, data=BMR)
model_4 <- lm(log10(chthSkew) ~ log_Mass + log_BMR, data=BMR)
library(bbmle)
AICctab (model_1, model_2, weights=T)
AICctab (model_3, model_4, weights=T)
model <- model_1
###########################################################
library(ape); library(phytools);  library(geiger)
feathertree <- read.tree("anc_kg.tre")
feathertree$node.label <- NULL # Remove internal node labels (if any)
is.ultrametric(feathertree)
is.binary(feathertree)
is.rooted(feathertree)
feathertree <- root(feathertree, outgroup = "Struthio_camelus", resolve.root = TRUE)
mycalibration <- makeChronosCalib(feathertree, node="root", age.max=94)
feathertree <- chronos(feathertree, lambda=0, model = 'correlated', calibration = mycalibration)
is.ultrametric(feathertree)
is.binary(feathertree)
is.rooted(feathertree)
BMR$Species <- gsub(" ", "_", fixed = TRUE, BMR$Species) # Replaces spaces with _
listBMR <- BMR$Species
listTree <- feathertree$tip.label
#PGLS  for binar metrics
df_flight = read.csv('../../Paper_materials_2024/flight_and_gene.csv')
df_flight = df_flight[,c(2,3,4,5,6)]
SpeciesToDrop <- setdiff(listTree, listBMR) #Вычисляет, какие виды убрать из общего дерева
drop.tip(feathertree, SpeciesToDrop) -> BMRTree #Убирает лишние виды из дерева
plotTree(BMRTree, fsize=0.5)
rownames(BMR) <- BMR[,1]
BMR <- BMR[match(BMRTree$tip.label,rownames(BMR)),] # rearranging the rows of the data frame to match the order of species names in the tree object.
attach(BMR)
names(log_Mass) <- rownames(BMR)
names(log_BMR) <- rownames(BMR)
names(chthSkew) <- rownames(BMR)
names(ghahSkew) <- rownames(BMR)
name.check(BMRTree, BMR)
library(nlme)
m1 <- gls(log_BMR~log_Mass, data=BMR, correlation=corPagel(value = 1, BMRTree, form = ~Species, fixed=FALSE), method="ML") # ML estimation
summary(m1)
library(caper)
CompBMR <- comparative.data(BMRTree, BMR, 'Species', na.omit=FALSE, vcv=TRUE, vcv.dim=3) #vcv.dim=2 is default
str(BMRTree)
rm(list = ls(all=TRUE))
library(ggfortify)
library(ggfortify)
library(ggfortify)
library(ggfortify)
library(ggplot2)
library(ggpubr)
library(ggbiplot)
library(phytools)
library(nlme)
library(geiger)
library(ggtree)
library(stringr)
library(dplyr)
df_mtdna = read.csv('../../Paper_materials_2024/Birds_dataset_paper.csv')
names_v = unique(df_mtdna$species_name)
df_mtdna$Mass = as.numeric(as.character(df_mtdna$Mass))
df_short = data.frame()
for (i in names_v)
{
df1 = df_mtdna[df_mtdna$species_name == i,]
a = sum(df1$ghahSkew)/12
b = sum(df1$chthSkew)/12
v = sum(df1$Mass)/12
ab = c(i, a, b, v)
df_short = rbind(df_short, ab)
}
names(df_short) = c('Species', 'GhAhSkew', 'ThChSkew', 'Mass')
df_short$GhAhSkew = as.numeric(df_short$GhAhSkew)
df_temp = read.csv('temp_new_data.csv')
df_big = merge(df_short, df_temp, by = 'Species')
View(df_big)
View(df_temp)
View(df_temp)
View(df_temp)
df_big$Mass.x = as.numeric(df_big$Mass.x)
df_big$logmass = log10(df_big$Mass.x)
lm_temp = lm(GhAhSkew~TNZ+log_Mass, data=df_big)
lm_temp = lm(GhAhSkew~TNZ+logmass, data=df_big)
modelSummary = summary(lm_temp)
ggplot(df_big, aes(x = TNZ, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)+
annotate('text', x = (min(df_big$TNZ)+1), y = min(df_big$GhAhSkew), label = round(modelSummary$coefficients[,4][2], digits = 4))
library(ggfortify)
library(ggplot2)
ggplot(df_big, aes(x = TNZ, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)+
annotate('text', x = (min(df_big$TNZ)+1), y = min(df_big$GhAhSkew), label = round(modelSummary$coefficients[,4][2], digits = 4))
library(ggplot2)
install.packages('ggplot2')
install.packages("ggplot2")
library(ggplot2)
ggplot(df_big, aes(x = TNZ, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)+
annotate('text', x = (min(df_big$TNZ)+1), y = min(df_big$GhAhSkew), label = round(modelSummary$coefficients[,4][2], digits = 4))
plot(lm_temp)
rm(list = ls(all=TRUE))
library(ggplot2)
remove.packages('ggplot2')
install.packages('ggplot2')
library(ggplot2)
df_mtdna = read.csv('../../Paper_materials_2024/Birds_dataset_paper.csv')
names_v = unique(df_mtdna$species_name)
df_mtdna$Mass = as.numeric(as.character(df_mtdna$Mass))
df_short = data.frame()
for (i in names_v)
{
df1 = df_mtdna[df_mtdna$species_name == i,]
a = sum(df1$ghahSkew)/12
b = sum(df1$chthSkew)/12
v = sum(df1$Mass)/12
ab = c(i, a, b, v)
df_short = rbind(df_short, ab)
}
names(df_short) = c('Species', 'GhAhSkew', 'ThChSkew', 'Mass')
df_short$GhAhSkew = as.numeric(df_short$GhAhSkew)
df_temp = read.csv('temp_new_data.csv')
df_big = merge(df_short, df_temp, by = 'Species')
df_big$Mass.x = as.numeric(df_big$Mass.x)
df_big$logmass = log10(df_big$Mass.x)
lm_temp = lm(GhAhSkew~TNZ+logmass, data=df_big)
modelSummary = summary(lm_temp)
ggplot(df_big, aes(x = TNZ, y = GhAhSkew))+
geom_point()+
geom_smooth(method = 'lm', formula = y~x)+
annotate('text', x = (min(df_big$TNZ)+1), y = min(df_big$GhAhSkew), label = round(modelSummary$coefficients[,4][2], digits = 4))
plot(lm_temp)
shapiro.test(rstandard(lm_temp))
modelSummary
rm(list = ls(all=TRUE))
rm(list = ls(all=TRUE))
BMR <- read.csv2("GlobalBMRbase.csv", header=T)
DNA <- read.csv2("Birds_dataset_paper.csv", header=T)
DNA <- DNA[c('Species', 'ghahSkew', 'chthSkew')]
DNA <- subset(DNA, Species!="Nothoprocta perdicaria")
BMR <- BMR[c('Species', 'Mass', 'TraitValue')]
DNA <- aggregate (DNA[,-1], by=list(DNA$Species), mean)
BMR <- aggregate (BMR[,-1], by=list(BMR$Species), mean)
BMR$log_Mass <- log10(BMR$Mass)
BMR$log_BMR <- log10(BMR$TraitValue)
BMR <- merge(BMR, DNA, by="Group.1", all.x=T)
BMR <- na.omit(BMR)
colnames(BMR)[1] <- "Species"
###########################################################
library(ape); library(phytools);  library(geiger)
feathertree <- read.tree("anc_kg.tre")
feathertree$node.label <- NULL # Remove internal node labels (if any)
is.ultrametric(feathertree)
is.binary(feathertree)
is.rooted(feathertree)
feathertree <- root(feathertree, outgroup = "Struthio_camelus", resolve.root = TRUE)
mycalibration <- makeChronosCalib(feathertree, node="root", age.max=94)
feathertree <- chronos(feathertree, lambda=0, model = 'correlated', calibration = mycalibration)
is.ultrametric(feathertree)
is.binary(feathertree)
is.rooted(feathertree)
BMR$Species <- gsub(" ", "_", fixed = TRUE, BMR$Species) # Replaces spaces with _
listBMR <- BMR$Species
listTree <- feathertree$tip.label
SpeciesToDrop <- setdiff(listTree, listBMR) #Вычисляет, какие виды убрать из общего дерева
drop.tip(feathertree, SpeciesToDrop) -> BMRTree #Убирает лишние виды из дерева
plotTree(BMRTree, fsize=0.5)
rownames(BMR) <- BMR[,1]
BMR <- BMR[match(BMRTree$tip.label,rownames(BMR)),] # rearranging the rows of the data frame to match the order of species names in the tree object.
attach(BMR)
names(log_Mass) <- rownames(BMR)
names(log_BMR) <- rownames(BMR)
names(chthSkew) <- rownames(BMR)
names(ghahSkew) <- rownames(BMR)
name.check(BMRTree, BMR)
BMRTree
library(nlme)
m1 <- gls(log_BMR~log_Mass, data=BMR, correlation=corPagel(value = 1, BMRTree, form = ~Species, fixed=FALSE), method="ML") # ML estimation
summary(m1)
library(caper)
CompBMR <- comparative.data(BMRTree, BMR, 'Species', na.omit=FALSE, vcv=TRUE) #vcv.dim=2 is default
str(BMRTree)
feathertree
rm(list = ls(all=TRUE))
BMR <- read.csv2("GlobalBMRbase.csv", header=T)
DNA <- read.csv2("Birds_dataset_paper.csv", header=T)
DNA <- DNA[c('Species', 'ghahSkew', 'chthSkew')]
DNA <- subset(DNA, Species!="Nothoprocta perdicaria")
BMR <- BMR[c('Species', 'Mass', 'TraitValue')]
DNA <- aggregate (DNA[,-1], by=list(DNA$Species), mean)
BMR <- aggregate (BMR[,-1], by=list(BMR$Species), mean)
BMR$log_Mass <- log10(BMR$Mass)
BMR$log_BMR <- log10(BMR$TraitValue)
BMR <- merge(BMR, DNA, by="Group.1", all.x=T)
BMR <- na.omit(BMR)
colnames(BMR)[1] <- "Species"
###########################################################
library(ape); library(phytools);  library(geiger)
FullTree <- read.nexus("Ultrametric_feathertree.nex")
feathertree = FullTree
BMR$Species <- gsub(" ", "_", fixed = TRUE, BMR$Species) # Replaces spaces with _
listBMR <- BMR$Species
listTree <- feathertree$tip.label
#PGLS  for binar metrics
df_flight = read.csv('../../Paper_materials_2024/flight_and_gene.csv')
df_flight = df_flight[,c(2,3,4,5,6)]
df_flight$flight_num = 0
SpeciesToDrop <- setdiff(listTree, listBMR) #Вычисляет, какие виды убрать из общего дерева
drop.tip(feathertree, SpeciesToDrop) -> BMRTree #Убирает лишние виды из дерева
plotTree(BMRTree, fsize=0.5)
rownames(BMR) <- BMR[,1]
BMR <- BMR[match(BMRTree$tip.label,rownames(BMR)),] # rearranging the rows of the data frame to match the order of species names in the tree object.
attach(BMR)
names(log_Mass) <- rownames(BMR)
names(log_BMR) <- rownames(BMR)
names(chthSkew) <- rownames(BMR)
names(ghahSkew) <- rownames(BMR)
name.check(BMRTree, BMR)
BMRTree
library(nlme)
m1 <- gls(log_BMR~log_Mass, data=BMR, correlation=corPagel(value = 1, BMRTree, form = ~Species, fixed=FALSE), method="ML") # ML estimation
summary(m1)
library(caper)
CompBMR <- comparative.data(BMRTree, BMR, 'Species', na.omit=FALSE, vcv=TRUE, vcv.dim=3) #vcv.dim=2 is default
m2 <- pgls(log_BMR~log_Mass, data=CompBMR, lambda='ML') #The branch length transformations can be optimised between bounds using maximum likelihood by setting the value for a transformation to 'ML'
summary(m2)
rm(list = ls(all=TRUE))
###########################################################
library(ape); library(phytools);  library(geiger)
feathertree <- read.tree("Ultrametric_feathertree.nex")
feathertree <- read.nexus("Ultrametric_feathertree.nex")
feathertree$node.label <- NULL # Remove internal node labels (if any)
is.ultrametric(feathertree)
is.binary(feathertree)
is.rooted(feathertree)
#PGLS  for binar metrics
df_flight = read.csv('../../Paper_materials_2024/flight_and_gene.csv')
df_flight = df_flight[,c(2,3,4,5,6)]
df_flight$flight_num = 0
df_flight[df_flight$ability_to_fly != 'Flying',]$flight_num = 1
df_flight = df_flight[df_flight$ability_to_fly !='Sphenisciformes',]
rownames(df_flight) = df_flight$species_name
listSkew = df_flight$species_name
SpeciesToDrop <- setdiff(listTree, listSkew)
listTree <- feathertree$tip.label
SpeciesToDrop <- setdiff(listTree, listSkew)
drop.tip(feathertree, SpeciesToDrop) -> Fly_skew_tree
rownames(df_flight) <- df_flight[,1]
df_flight <- df_flight[match(Fly_skew_tree$tip.label,rownames(df_flight)),]
attach(df_flight)
names(GhAhSkew) = rownames(df_flight)
names(flight_num) = rownames(df_flight)
name.check(Fly_skew_tree, df_flight)
library(nlme)
m1 <- gls(GhAhSkew~flight_num, data=df_flight, correlation=corPagel(value = 1, Fly_skew_tree, form = ~species_name, fixed=FALSE), method="ML") # ML estimation
summary(m1)
library(caper)
CompBMR <- comparative.data(Fly_skew_tree, df_flight, 'species_name', na.omit=FALSE, vcv=TRUE, vcv.dim=3) #vcv.dim=2 is default
m2 <- pgls(log_BMR~log_Mass, data=CompBMR, lambda='ML') #The branch length transformations can be optimised between bounds using maximum likelihood by setting the value for a transformation to 'ML'
m2 <- pgls(GhAhSkew~flight_num, data=CompBMR, lambda='ML') #The branch length transformations can be optimised between bounds using maximum likelihood by setting the value for a transformation to 'ML'
summary(m2)
#diving
df_dive = read.csv('../../Paper_materials_2024/dive_and_gene.csv')
df_dive = df_dive[,c(2:6)]
#diving
df_dive1 = read.csv('../../Paper_materials_2024/dive_and_gene.csv')
df_dive1 = df_dive[,c(2:6)]
df_dive1 = df_dive1[,c(2:6)]
df_dive1[df_dive1$ability_to_dive == 'Anseriformes',]$ability_to_dive = 'Diving_all_species'
df_dive1[df_dive1$ability_to_dive == "Sphenisciformes",]$ability_to_dive = 'Diving_all_species'
df_dive1[df_dive1$ability_to_dive == "Podicipediformes",]$ability_to_dive = 'Diving_all_species'
df_dive1[df_dive1$ability_to_dive == "Gaviiformes",]$ability_to_dive = 'Diving_all_species'
df_dive1[df_dive1$ability_to_dive == "Suliformes",]$ability_to_dive = 'Diving_all_species'
df_dive1[df_dive1$ability_to_dive == "Charadriiformes",]$ability_to_dive = 'Diving_some_species'
df_dive1[df_dive1$ability_to_dive == "Coraciiformes",]$ability_to_dive = 'Diving_some_species'
df_dive1[df_dive1$ability_to_dive == "Passeriformes",]$ability_to_dive = 'Diving_some_species'
df_dive1[df_dive1$ability_to_dive == "Procellariiformes",]$ability_to_dive = 'Diving_some_species'
df_dive1[df_dive1$ability_to_dive == "Gruiformes",]$ability_to_dive = 'Diving_some_species'
df_dive1$GhAhSkew = as.numeric(as.character(df_dive1$GhAhSkew))
listSkew = df_dive1$species_name
listTree <- feathertree$tip.label
SpeciesToDrop <- setdiff(listTree, listSkew)
listSkew = df_flight$species_name
listSkew = df_dive1$species_name
listTree <- feathertree$tip.label
SpeciesToDrop <- setdiff(listTree, listSkew)
View(df_dive1)
df_dive1$ability_to_dive_binar = 0
df_dive1[df_dive1$ability_to_dive != 'Non-diving',]$ability_to_dive_binar = 1
df_dive2 = df_dive1[df_dive1$ability_to_dive == 'Diving_all_species',]
df_dive2 = df_dive1[df_dive1$ability_to_dive != 'Diving_some_species',]
df_dive3 = df_dive1[df_dive1$ability_to_dive != 'Diving_all_species',]
#all divers
listSkew = df_dive1$species_name
listTree <- feathertree$tip.label
SpeciesToDrop <- setdiff(listTree, listSkew)
drop.tip(feathertree, SpeciesToDrop) -> Dive_skew_tree
rownames(df_flight) <- df_flight[,1]
rownames(df_dive1) <- df_dive1[,1]
df_dive1 <- df_dive1[match(Dive_skew_tree$tip.label,rownames(df_dive1)),]
attach(df_dive1)
names(GhAhSkew) = rownames(df_dive1)
names(ability_to_dive_binar) = rownames(df_dive1)
name.check(Dive_skew_tree, df_dive1)
m3 <- gls(GhAhSkew~ability_to_dive_binar, data=df_dive1, correlation=corPagel(value = 1, Dive_skew_tree, form = ~species_name, fixed=FALSE), method="ML") # ML estimation
summary(m3)
#all species divers
listSkew = df_dive2$species_name
listTree <- feathertree$tip.label
SpeciesToDrop <- setdiff(listTree, listSkew)
drop.tip(feathertree, SpeciesToDrop) -> Dive_skew_tree
rownames(df_dive2) <- df_dive2[,1]
df_dive2 <- df_dive2[match(Dive_skew_tree$tip.label,rownames(df_dive2)),]
attach(df_dive2)
names(GhAhSkew) = rownames(df_dive2)
names(ability_to_dive_binar) = rownames(df_dive2)
name.check(Dive_skew_tree, df_dive2)
m3 <- gls(GhAhSkew~ability_to_dive_binar, data=df_dive2, correlation=corPagel(value = 1, Dive_skew_tree, form = ~species_name, fixed=FALSE), method="ML") # ML estimation
summary(m3)
View(df_dive2)
View(Dive_skew_tree)
CompBMR <- comparative.data(Dive_skew_tree, df_dive2, 'species_name', na.omit=FALSE, vcv=TRUE, vcv.dim=3) #vcv.dim=2 is default
m4 <- pgls(GhAhSkew~ability_to_dive_binar, data=CompBMR, lambda='ML') #The branch length transformations can be optimised between bounds using maximum likelihood by setting the value for a transformation to 'ML'
summary(m4)
rm(list = ls(all=TRUE))
