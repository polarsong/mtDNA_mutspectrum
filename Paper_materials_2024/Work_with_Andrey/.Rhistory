df_ex = df_mtdna[,c(32,33)]
View(df_ex)
df_ex = df_mtdna[,c(1,32,33)]
df_ex = df_mtdna[,c(2,32,33)]
df_ex1 = mean(df_ex)
df_ex1 = aggregate(species_name ~ TTT + TTC, FUN = mean, data = df_ex)
View(df_ex1)
df_ex1 = aggregate(species_name, FUN = mean, data = df_ex)
df_ex1 = aggregate(df_ex$species_name, FUN = mean, data = df_ex)
df_ex1 = aggregate(TTT ~ species_name, FUN = mean, data = df_ex)
df_ex1 = aggregate(TTT + TTC ~ species_name, FUN = mean, data = df_ex)
df_ex1 = aggregate(TTT ~ species_name + TTC, FUN = mean, data = df_ex)
df_ex1 = aggregate(TTT ~ species_name, FUN = mean, data = df_ex)
rm(df_ex)
rm(df_ex1)
names(df_mtdna)
df_ex = df_mtdna[,c(2,32,33)]
df_ex1 = aggregate(. ~ species_name, FUN = mean, data = df_ex)
View(df_ex1)
df_ex1 = aggregate(. ~ species_name, FUN = mean, data = df_mtdna)
df_ex = df_mtdna[,c(2,16:95,97:102,105:107)]
df_ex1 = aggregate(. ~ species_name, FUN = mean, data = df_mtdna)
View(df_ex1)
warnings()
df_ex1 = aggregate(. ~ species_name, FUN = mean, data = df_ex)
View(df_ex1)
View(df_mtdna)
df_ex = df_mtdna[,c(2,17:95,97:102,105:107)]
df_ex1 = aggregate(. ~ species_name, FUN = mean, data = df_ex)
View(df_ex1)
df_ex1$ghahSkew
df_ex2 = unique(df_mtdna[,c(2,4)])
df_ex1 = merge(df_ex1, df_ex2)
df_short = df_ex1
View(df_short)
colnames(df_short) <- paste(colnames(df_short),"refseq",sep="_")
names(df_short$species_name_refseq) = 'species_name'
names(df_short)[names(df_short) == 'species_name_refseq'] <- 'species_name'
names(avo_data)[names(avo_data) == 'Species3'] <- 'species_name'
names(avo_data)[names(avo_data) == 'Family3'] <- 'family'
names(avo_data)[names(avo_data) == 'Order3'] <- 'order'
names(df_short) = c('species_name', 'GhAhSkew_refseq', 'ThChSkew_refseq')
df_fly = na.omit(df_fly)
df_midori_birds = merge(df_midori1, avo_data)
names_v1 = unique(df_midori_birds$species_name)
df_short1 = data.frame()
for (i in names_v1)
{
df1 = df_midori_birds[df_midori_birds$species_name == i,]
a = (sum(df1$Mutation_AG_midori))/(nrow(df1))
b = (sum(df1$Mutation_CT_midori))/(nrow(df1))
ab = c(i, a, b)
df_short1 = rbind(df_short1, ab)
}
names(df_short1) = c('species_name', 'Mutation_AG_midori', 'Mutation_CT_midori')
#write.csv(df_short1, file = 'New_midori_mutations_birds_only.csv')
df_cytb = read.csv('Midori2_birds_cytb_ghahskew_better.csv')
df_syst = read.csv('TaxonomyIOC14_1.csv', sep = ';')
df_midori_eco = read.csv('Midori_birds_eco.csv')
df_midori_eco = df_midori_eco[,c(2,3,4)]
df_midori_eco$species_name = gsub('_',' ', df_midori_eco$species_name)
names(df_midori_eco) = c('species_name', 'ability_to_fly_midori', 'ability_to_dive_midori')
names(df_syst)[names(df_syst) == 'species_name'] <- 'species_name_IOC'
names(df_syst) = c('order', 'family', 'genus', 'species_name_IOC')
df_syst = df_syst[,c(1,4)]
library(dplyr)
df_cytb = df_cytb[,c(2,3,4)]
names(df_cytb) = c('species_name', 'GhAhSkew_seq_beg', 'GhAhSkew_start_codon')
df_long = read.csv('AVES_longevity.csv')
firstup <- function(x) {
substr(x, 1, 1) <- toupper(substr(x, 1, 1))
x
}
df_long$scinam = firstup(df_long$scinam)
df_long = df_long[,c(1,2)]
names(df_long) = c('species_name', 'longevity')
df_lf = read.csv ('Species_life-histories.csv')
df_lf = df_lf[,c(1,5:16)]
names(df_lf)  = c('species_name',"oscine", 'migration_andrey', 'habitat_andrey', 'foraging_environment_andrey',
'daily_activity_andrey', 'diet_andrey', 'clutch_abdrey', 'clutch_min_andrey', 'clutch_max_andrey',
'nesting_period_andrey', 'after_fledging_period_andrey', 'lifespan_andrey')
df_bmr = read.csv('GlobalBMRbase.csv', sep = ';')
df_bmr = df_bmr[,c(1,7,8)]
names(df_bmr) = c('species_name', 'trait', 'trait_value')
df_bmr$trait_value =gsub(',','.', df_bmr$trait_value)
df_bmr$trait_value = as.numeric(df_bmr$trait_value)
df_bmr1 = df_bmr[df_bmr$trait == 'BMR',]
names_v1 = unique(df_bmr1$species_name)
df_bmr11 = data.frame()
for (i in names_v1)
{
df_1 = df_bmr1[df_bmr1$species_name == i,]
a = (sum(df_1$trait_value))/(nrow(df1))
b = unique(df_1$trait)
ab = c(i, b, a)
df_bmr11 = rbind(df_bmr11, ab)
}
names(df_bmr11) = c('species_name', 'trait_bmr', 'trait_value_bmr')
df_bmr2 = df_bmr[df_bmr$trait == 'SMR',]
names_v1 = unique(df_bmr2$species_name)
df_bmr21 = data.frame()
for (i in names_v1)
{
df_1 = df_bmr2[df_bmr2$species_name == i,]
a = (sum(df_1$trait_value))/(nrow(df1))
b = unique(df_1$trait)
ab = c(i, b, a)
df_bmr21 = rbind(df_bmr21, ab)
}
names(df_bmr21) = c('species_name', 'trait_smr', 'trait_value_smr')
df_bmr3 = df_bmr[df_bmr$trait == 'RMR',]
names_v1 = unique(df_bmr3$species_name)
df_bmr31 = data.frame()
for (i in names_v1)
{
df_1 = df_bmr3[df_bmr3$species_name == i,]
a = (sum(df_1$trait_value))/(nrow(df1))
b = unique(df_1$trait)
ab = c(i, b, a)
df_bmr31 = rbind(df_bmr31, ab)
}
names(df_bmr31) = c('species_name', 'trait_rmr', 'trait_value_rmr')
df_temp = read.csv('temp_new_data.csv')
df_temp = df_temp[,c(11, 4:8)]
names(df_temp) = c('species_name', 'LTNZ', 'UTNZ', 'TNZ', 'latitude', 'longitude')
df_extra = read.csv('mcnab_2009_data.csv')
df_extra = df_extra[,c(2, 6, 11, 14)]
names(df_extra) = c('species_name', 'bmr_kj_h', 'torpor', 'mountains')
df_vhi = read.table('Valya_high_alt.txt', header = TRUE, sep = ',')
names(df_vhi) = c('species_name', 'high_alt_value')
df_vhi$species_name = gsub('_',' ',df_vhi$species_name)
#df_midori_birds = merge(df_midori1, avo_data, by = 'Species3')
df_big = full_join(df_short, df_fly)
df_big1 = full_join(df_big, df_short1)
View(df_short)
df_ex = df_mtdna[,c(2,17:95,97:102,105:107)]
df_ex1 = aggregate(. ~ species_name, FUN = mean, data = df_ex)
df_ex2 = unique(df_mtdna[,c(2,4)])
df_ex1 = merge(df_ex1, df_ex2)
df_short = df_ex1
colnames(df_short) <- paste(colnames(df_short),"refseq",sep="_")
names(df_short)[names(df_short) == 'species_name_refseq'] <- 'species_name'
names(df_short$species_name_refseq) = 'species_name'
df_ex = df_mtdna[,c(2,17:95,97:102,105:107)]
df_ex1 = aggregate(. ~ species_name, FUN = mean, data = df_ex)
df_ex2 = unique(df_mtdna[,c(2,4)])
df_ex1 = merge(df_ex1, df_ex2)
df_short = df_ex1
colnames(df_short) <- paste(colnames(df_short),"refseq",sep="_")
names(df_short)[names(df_short) == 'species_name_refseq'] <- 'species_name'
names(df_short$species_name_refseq) = 'species_name'
names(avo_data)[names(avo_data) == 'Species3'] <- 'species_name'
names(avo_data)[names(avo_data) == 'Family3'] <- 'family'
names(avo_data)[names(avo_data) == 'Order3'] <- 'order'
df_fly = na.omit(df_fly)
df_midori_birds = merge(df_midori1, avo_data)
names_v1 = unique(df_midori_birds$species_name)
df_short1 = data.frame()
for (i in names_v1)
{
df1 = df_midori_birds[df_midori_birds$species_name == i,]
a = (sum(df1$Mutation_AG_midori))/(nrow(df1))
b = (sum(df1$Mutation_CT_midori))/(nrow(df1))
ab = c(i, a, b)
df_short1 = rbind(df_short1, ab)
}
names(df_short1) = c('species_name', 'Mutation_AG_midori', 'Mutation_CT_midori')
#write.csv(df_short1, file = 'New_midori_mutations_birds_only.csv')
df_cytb = read.csv('Midori2_birds_cytb_ghahskew_better.csv')
df_syst = read.csv('TaxonomyIOC14_1.csv', sep = ';')
df_midori_eco = read.csv('Midori_birds_eco.csv')
df_midori_eco = df_midori_eco[,c(2,3,4)]
df_midori_eco$species_name = gsub('_',' ', df_midori_eco$species_name)
names(df_midori_eco) = c('species_name', 'ability_to_fly_midori', 'ability_to_dive_midori')
names(df_syst)[names(df_syst) == 'species_name'] <- 'species_name_IOC'
names(df_syst) = c('order', 'family', 'genus', 'species_name_IOC')
df_syst = df_syst[,c(1,4)]
library(dplyr)
df_cytb = df_cytb[,c(2,3,4)]
names(df_cytb) = c('species_name', 'GhAhSkew_seq_beg', 'GhAhSkew_start_codon')
df_long = read.csv('AVES_longevity.csv')
firstup <- function(x) {
substr(x, 1, 1) <- toupper(substr(x, 1, 1))
x
}
df_long$scinam = firstup(df_long$scinam)
df_long = df_long[,c(1,2)]
names(df_long) = c('species_name', 'longevity')
df_lf = read.csv ('Species_life-histories.csv')
df_lf = df_lf[,c(1,5:16)]
names(df_lf)  = c('species_name',"oscine", 'migration_andrey', 'habitat_andrey', 'foraging_environment_andrey',
'daily_activity_andrey', 'diet_andrey', 'clutch_abdrey', 'clutch_min_andrey', 'clutch_max_andrey',
'nesting_period_andrey', 'after_fledging_period_andrey', 'lifespan_andrey')
df_bmr = read.csv('GlobalBMRbase.csv', sep = ';')
df_bmr = df_bmr[,c(1,7,8)]
names(df_bmr) = c('species_name', 'trait', 'trait_value')
df_bmr$trait_value =gsub(',','.', df_bmr$trait_value)
df_bmr$trait_value = as.numeric(df_bmr$trait_value)
df_bmr1 = df_bmr[df_bmr$trait == 'BMR',]
names_v1 = unique(df_bmr1$species_name)
df_bmr11 = data.frame()
for (i in names_v1)
{
df_1 = df_bmr1[df_bmr1$species_name == i,]
a = (sum(df_1$trait_value))/(nrow(df1))
b = unique(df_1$trait)
ab = c(i, b, a)
df_bmr11 = rbind(df_bmr11, ab)
}
names(df_bmr11) = c('species_name', 'trait_bmr', 'trait_value_bmr')
df_bmr2 = df_bmr[df_bmr$trait == 'SMR',]
names_v1 = unique(df_bmr2$species_name)
df_bmr21 = data.frame()
for (i in names_v1)
{
df_1 = df_bmr2[df_bmr2$species_name == i,]
a = (sum(df_1$trait_value))/(nrow(df1))
b = unique(df_1$trait)
ab = c(i, b, a)
df_bmr21 = rbind(df_bmr21, ab)
}
names(df_bmr21) = c('species_name', 'trait_smr', 'trait_value_smr')
df_bmr3 = df_bmr[df_bmr$trait == 'RMR',]
names_v1 = unique(df_bmr3$species_name)
df_bmr31 = data.frame()
for (i in names_v1)
{
df_1 = df_bmr3[df_bmr3$species_name == i,]
a = (sum(df_1$trait_value))/(nrow(df1))
b = unique(df_1$trait)
ab = c(i, b, a)
df_bmr31 = rbind(df_bmr31, ab)
}
names(df_bmr31) = c('species_name', 'trait_rmr', 'trait_value_rmr')
df_temp = read.csv('temp_new_data.csv')
df_temp = df_temp[,c(11, 4:8)]
names(df_temp) = c('species_name', 'LTNZ', 'UTNZ', 'TNZ', 'latitude', 'longitude')
df_extra = read.csv('mcnab_2009_data.csv')
df_extra = df_extra[,c(2, 6, 11, 14)]
names(df_extra) = c('species_name', 'bmr_kj_h', 'torpor', 'mountains')
df_vhi = read.table('Valya_high_alt.txt', header = TRUE, sep = ',')
names(df_vhi) = c('species_name', 'high_alt_value')
df_vhi$species_name = gsub('_',' ',df_vhi$species_name)
#df_midori_birds = merge(df_midori1, avo_data, by = 'Species3')
df_big = full_join(df_short, df_fly)
View(df_big)
df_big1 = full_join(df_big, df_short1)
df_big11 = full_join(df_big1, df_cytb)
df_big2 = full_join(df_big11, avo_data)
df_big3 = full_join(df_big2, df_midori_eco)
df_big4 = full_join(df_big3, df_long)
df_big5 = full_join(df_big4, df_lf)
df_big6 = full_join(df_big5, df_bmr11)
df_big7 = full_join(df_big6, df_bmr21)
df_big8 = full_join(df_big7, df_bmr31)
df_big9 = full_join(df_big8, df_temp)
df_big10 = full_join(df_big9, df_extra)
df_big12 = full_join(df_big10, df_vhi)
write.csv(df_big12, file = 'big_birds_new_data.csv')
rm(list = ls(all=TRUE))
unzip("../Body/3Results/AllGenesCodonUsageNoOverlap.txt.zip", exdir = "../../Body/3Results/")
SynNuc = read.table("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
unzip("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt.zip", exdir = "../../Body/3Results/")
SynNuc = read.table("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
if (file.exists("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")) file.remove("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")
SynNuc$ghahSkew = ((SynNuc$NeutralC - SynNuc$NeutralT))/((SynNuc$NeutralC + SynNuc$NeutralT))
SynNuc$chthSkew = ((SynNuc$NeutralA - SynNuc$NeutralG))/((SynNuc$NeutralA + SynNuc$NeutralG))
View(SynNuc)
names(SynNuc)
View(SynNuc)
SynNuc$Taxonomy
library(data.table)
df1 = SynNuc[rownames(SynNuc) %like% "Mammalia", ]
View(df1)
df1 = SynNuc[grep("Mammalia", rownames(SynNuc)), ]
SynNuc[grep("Mammalia", rownames(SynNuc)), ]
library(data.table)
df1 = SynNuc[SynNuc$Taxonomy %like% "Mammalia", ]
View(df1)
df_bats = SynNuc[SynNuc$Taxonomy %like% "Chiroptera", ]
View(df_bats)
df_bats = aggregate(.~Species, FUN = mean, data = df_bats)
View(df_bats)
names(df_bats)
df_bats = df_bats[,c(1,79)]
df_bats = aggregate(.~Species, FUN = mean, data = df_bats)
View(df_bats)
df1 = SynNuc[SynNuc$Taxonomy %like% "Mammalia", ]
df_bats = SynNuc[SynNuc$Taxonomy %like% "Chiroptera", ]
names(df_bats)
df_bats = df_bats[,c(1,79)]
df_bats = aggregate(.~Species, FUN = mean, data = df_bats)
df_mammals = df1[,c(1,79)]
View(df_mammals)
df_mammals = aggregate(.~Species, FUN = mean, data = df_mammals)
library(dplyr)
df_mammals %>% anti_join(df_bats)
df_mammals[!df_mammals$Species %in% df_bats$Species,]
df_mammals = df_mammals[!df_mammals$Species %in% df_bats$Species,]
library(ggplot2)
df_bats$animal = 'Bats'
View(df_bats)
df_mammals$animal = 'Mammals'
ggplot(data=df_bats, aes(x = animal, y = ghahSkew))+
geom_boxplot()
ggplot(data=df_mammals, aes(x = animal, y = ghahSkew))+
geom_boxplot()
b = ggplot(data=df_mammals, aes(x = animal, y = ghahSkew))+
geom_boxplot()
library(ggpubr)
animals = ggarrange(a, b,
ncol = 2, nrow = 1)
a = ggplot(data=df_bats, aes(x = animal, y = ghahSkew))+
geom_boxplot()
b = ggplot(data=df_mammals, aes(x = animal, y = ghahSkew))+
geom_boxplot()
animals = ggarrange(a, b,
ncol = 2, nrow = 1)
animals
a = ggplot(data=df_bats, aes(x = animal, y = ghahSkew))+
geom_boxplot()+
ylim(-0.4,0.6)
b = ggplot(data=df_mammals, aes(x = animal, y = ghahSkew))+
geom_boxplot()+
ylim(-0.4,0.6)
animals = ggarrange(a, b,
ncol = 2, nrow = 1)
animals
b = ggplot(data=df_mammals, aes(x = animal, y = ghahSkew))+
geom_boxplot()
animals = ggarrange(a, b,
ncol = 2, nrow = 1)
animals
a = ggplot(data=df_bats, aes(x = animal, y = ghahSkew))+
geom_boxplot()
b = ggplot(data=df_mammals, aes(x = animal, y = ghahSkew))+
geom_boxplot()
library(ggpubr)
animals = ggarrange(a, b,
ncol = 2, nrow = 1)
animals
df_mtdna = read.csv('../../Paper_materials_2024/Birds_dataset_paper.csv')
names(df_mtdna)
df_ex = df_mtdna[,c(2,97)]
View(df_ex)
df_ex1 = aggregate(. ~ species_name, FUN = mean, data = df_ex)
View(df_ex1)
df_ex1$animal = 'Birds'
c = ggplot(data=df_ex1, aes(x = animal, y = ghahSkew))+
geom_boxplot()
animals = ggarrange(a, b, c,
ncol = 3, nrow = 1)
animals
a = ggplot(data=df_bats, aes(x = animal, y = ghahSkew))+
geom_boxplot()+
ylim(-0.4,1)
b = ggplot(data=df_mammals, aes(x = animal, y = ghahSkew))+
geom_boxplot()+
ylim(-0.4,1)
c = ggplot(data=df_ex1, aes(x = animal, y = ghahSkew))+
geom_boxplot()+
ylim(-0.4,1)
animals = ggarrange(a, b, c,
ncol = 3, nrow = 1)
animals
rm(list = ls(all=TRUE))
rm(list = ls(all=TRUE))
library(ggplot2)
df_midori = read.csv('Midori2_new_mutspec.csv')
df_midori = df_midori[,c(2,5,6,7)]
df_midori$gene_and_species = paste(df_midori$Gene, df_midori$Species)
df_midori$gene_and_species = gsub(' ', '_', df_midori$gene_and_species)
df_midori = df_midori[,c(1,2,5)]
df_mtdna = read.csv('../../Paper_materials_2024/Birds_dataset_paper.csv')
df_midori1 = reshape(data = df_midori, idvar = 'gene_and_species',
timevar = 'Mut',
direction = 'wide')
library(stringr)
df_midori1[,c('gene', 'species_name')] = str_split_fixed(df_midori1$gene_and_species, "_", 2)
df_midori1 = df_midori1[,c(2:15)]
names(df_midori1) = c('Mutation_TC_midori', 'Mutation_GA_midori', 'Mutation_CT_midori', 'Mutation_AG_midori',
'Mutation_AT_midori', 'Mutation_GT_midori', 'Mutation_TA_midori', 'Mutation_CG_midori',
'Mutation_TG_midori', 'Mutation_CA_midori', 'Mutation_GC_midori', 'Mutation_AC_midori',
'gene', 'species_name')
df_midori1$species_name = gsub('_', ' ', df_midori1$species_name)
df_fly = read.csv('../../Paper_materials_2024/flying_birds.csv')
df_fly = df_fly[,c(2,3,4)]
names(df_fly) = c('species_name', 'ability_to_fly', 'ability_to_dive')
avo_data = read.csv('../../Body/1Raw/Avonet_data.csv')
df_ex = df_mtdna[,c(2,17:95,97:102,105:107)]
df_ex1 = aggregate(. ~ species_name, FUN = mean, data = df_ex)
df_ex2 = unique(df_mtdna[,c(2,4)])
df_ex1 = merge(df_ex1, df_ex2)
df_short = df_ex1
colnames(df_short) <- paste(colnames(df_short),"refseq",sep="_")
names(df_short)[names(df_short) == 'species_name_refseq'] <- 'species_name'
names(avo_data)[names(avo_data) == 'Species3'] <- 'species_name'
names(avo_data)[names(avo_data) == 'Family3'] <- 'family'
names(avo_data)[names(avo_data) == 'Order3'] <- 'order'
df_fly = na.omit(df_fly)
df_midori_birds = merge(df_midori1, avo_data)
names_v1 = unique(df_midori_birds$species_name)
df_short1 = data.frame()
for (i in names_v1)
{
df1 = df_midori_birds[df_midori_birds$species_name == i,]
a = (sum(df1$Mutation_AG_midori))/(nrow(df1))
b = (sum(df1$Mutation_CT_midori))/(nrow(df1))
ab = c(i, a, b)
df_short1 = rbind(df_short1, ab)
}
names(df_short1) = c('species_name', 'Mutation_AG_midori', 'Mutation_CT_midori')
#write.csv(df_short1, file = 'New_midori_mutations_birds_only.csv')
df_cytb = read.csv('Midori2_birds_cytb_ghahskew_better.csv')
df_syst = read.csv('TaxonomyIOC14_1.csv', sep = ';')
df_midori_eco = read.csv('Midori_birds_eco.csv')
df_midori_eco = df_midori_eco[,c(2,3,4)]
df_midori_eco$species_name = gsub('_',' ', df_midori_eco$species_name)
names(df_midori_eco) = c('species_name', 'ability_to_fly_midori', 'ability_to_dive_midori')
names(df_syst)[names(df_syst) == 'species_name'] <- 'species_name_IOC'
names(df_syst) = c('order', 'family', 'genus', 'species_name_IOC')
df_syst = df_syst[,c(1,4)]
library(dplyr)
df_cytb = df_cytb[,c(2,3,4)]
names(df_cytb) = c('species_name', 'GhAhSkew_seq_beg', 'GhAhSkew_start_codon')
df_long = read.csv('AVES_longevity.csv')
firstup <- function(x) {
substr(x, 1, 1) <- toupper(substr(x, 1, 1))
x
}
df_long$scinam = firstup(df_long$scinam)
df_long = df_long[,c(1,2)]
names(df_long) = c('species_name', 'longevity')
df_lf = read.csv ('Species_life-histories.csv')
df_lf = df_lf[,c(1,5:16)]
names(df_lf)  = c('species_name',"oscine", 'migration_andrey', 'habitat_andrey', 'foraging_environment_andrey',
'daily_activity_andrey', 'diet_andrey', 'clutch_abdrey', 'clutch_min_andrey', 'clutch_max_andrey',
'nesting_period_andrey', 'after_fledging_period_andrey', 'lifespan_andrey')
df_bmr = read.csv('GlobalBMRbase.csv', sep = ';')
df_bmr = df_bmr[,c(1,7,8)]
names(df_bmr) = c('species_name', 'trait', 'trait_value')
df_bmr$trait_value =gsub(',','.', df_bmr$trait_value)
df_bmr$trait_value = as.numeric(df_bmr$trait_value)
df_bmr1 = df_bmr[df_bmr$trait == 'BMR',]
names_v1 = unique(df_bmr1$species_name)
df_bmr11 = data.frame()
for (i in names_v1)
{
df_1 = df_bmr1[df_bmr1$species_name == i,]
a = (sum(df_1$trait_value))/(nrow(df1))
b = unique(df_1$trait)
ab = c(i, b, a)
df_bmr11 = rbind(df_bmr11, ab)
}
names(df_bmr11) = c('species_name', 'trait_bmr', 'trait_value_bmr')
df_bmr2 = df_bmr[df_bmr$trait == 'SMR',]
names_v1 = unique(df_bmr2$species_name)
df_bmr21 = data.frame()
for (i in names_v1)
{
df_1 = df_bmr2[df_bmr2$species_name == i,]
a = (sum(df_1$trait_value))/(nrow(df1))
b = unique(df_1$trait)
ab = c(i, b, a)
df_bmr21 = rbind(df_bmr21, ab)
}
names(df_bmr21) = c('species_name', 'trait_smr', 'trait_value_smr')
df_bmr3 = df_bmr[df_bmr$trait == 'RMR',]
names_v1 = unique(df_bmr3$species_name)
df_bmr31 = data.frame()
for (i in names_v1)
{
df_1 = df_bmr3[df_bmr3$species_name == i,]
a = (sum(df_1$trait_value))/(nrow(df1))
b = unique(df_1$trait)
ab = c(i, b, a)
df_bmr31 = rbind(df_bmr31, ab)
}
names(df_bmr31) = c('species_name', 'trait_rmr', 'trait_value_rmr')
df_temp = read.csv('temp_new_data.csv')
df_temp = df_temp[,c(11, 4:8)]
names(df_temp) = c('species_name', 'LTNZ', 'UTNZ', 'TNZ', 'latitude', 'longitude')
df_extra = read.csv('mcnab_2009_data.csv')
df_extra = df_extra[,c(2, 6, 11, 14)]
names(df_extra) = c('species_name', 'bmr_kj_h', 'torpor', 'mountains')
df_vhi = read.table('Valya_high_alt.txt', header = TRUE, sep = ',')
names(df_vhi) = c('species_name', 'high_alt_value')
df_vhi$species_name = gsub('_',' ',df_vhi$species_name)
View(df_midori_eco)
View(df_short1)
df_short1$AGdivCT = df_short1$Mutation_AG_midori/df_short1$Mutation_CT_midori
df_short1$Mutation_CT_midori = as.numeric(as.character(df_short1$Mutation_CT_midori))
df_short1$AGdivCT = df_short1$Mutation_AG_midori/df_short1$Mutation_CT_midori
df_short1$Mutation_AG_midori = as.numeric(as.character(df_short1$Mutation_AG_midori))
df_short1$Mutation_CT_midori = as.numeric(as.character(df_short1$Mutation_CT_midori))
df_short1$AGdivCT = df_short1$Mutation_AG_midori/df_short1$Mutation_CT_midori
#df_midori_birds = merge(df_midori1, avo_data, by = 'Species3')
df_big = full_join(df_short, df_fly)
df_big1 = full_join(df_big, df_short1)
df_big11 = full_join(df_big1, df_cytb)
df_big2 = full_join(df_big11, avo_data)
df_big3 = full_join(df_big2, df_midori_eco)
df_big4 = full_join(df_big3, df_long)
df_big5 = full_join(df_big4, df_lf)
df_big6 = full_join(df_big5, df_bmr11)
df_big7 = full_join(df_big6, df_bmr21)
df_big8 = full_join(df_big7, df_bmr31)
df_big9 = full_join(df_big8, df_temp)
df_big10 = full_join(df_big9, df_extra)
df_big12 = full_join(df_big10, df_vhi)
write.csv(df_big12, file = 'big_birds_new_data.csv')
rm(list = ls(all=TRUE))
