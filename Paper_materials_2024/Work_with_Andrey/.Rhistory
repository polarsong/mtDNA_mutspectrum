View(df_mtdna_orders)
df_mtdna = read.csv('../../Paper_materials_2024/Birds_dataset_paper.csv')
df_mtdna_orders = unique(df_mtdna[,c(2,5)])
df_mtdna_orders$taxonomy = sub('formes.*', '', df_mtdna_orders$taxonomy)
df_mtdna_orders$taxonomy = sub('.*\\ ', '', df_mtdna_orders$taxonomy)
df_mtdna_orders$taxonomy = paste(df_mtdna_orders$taxonomy, 'formes', sep = '')
names(df_mtdna_orders) = c('Species', 'Orders')
View(df_mtdna_orders)
names(df_mtdna_orders$Species) = c('Species', 'Orders')
df_mtdna_orders$Species
df_mtdna = read.csv('../../Paper_materials_2024/Birds_dataset_paper.csv')
df_mtdna_orders = unique(df_mtdna[,c(2,5)])
df_mtdna_orders$taxonomy = sub('formes.*', '', df_mtdna_orders$taxonomy)
df_mtdna_orders$taxonomy = sub('.*\\ ', '', df_mtdna_orders$taxonomy)
df_mtdna_orders$taxonomy = paste(df_mtdna_orders$taxonomy, 'formes', sep = '')
names(df_mtdna_orders) = c('Species', 'Orders')
write.csv(df_mtdna_orders, file = 'birds_names.csv')
rm(list = ls(all=TRUE))
rm(list = ls(all=TRUE))
library(ggplot2)
df_mtdna = read.csv('../../Paper_materials_2024/Birds_dataset_paper.csv')
names_v = unique(df_mtdna$species_name)
df_mtdna$Mass = as.numeric(as.character(df_mtdna$Mass))
df_short = data.frame()
for (i in names_v)
{
df1 = df_mtdna[df_mtdna$species_name == i,]
a = sum(df1$ghahSkew)/12
b = sum(df1$chthSkew)/12
v = sum(df1$Mass)/12
ab = c(i, a, b, v)
df_short = rbind(df_short, ab)
}
names(df_short) = c('Species', 'GhAhSkew', 'ThChSkew', 'Mass')
df_short$GhAhSkew = as.numeric(df_short$GhAhSkew)
df_temp = read.csv('temp_new_data.csv')
df_big = merge(df_short, df_temp, by = 'Species')
df_big$Mass.x = as.numeric(df_big$Mass.x)
df_big$logmass = log10(df_big$Mass.x)
lm_temp = lm(GhAhSkew~TNZ, data=df_big)
modelSummary = summary(lm_temp)
modelSummary
rm(list = ls(all=TRUE))
library(ape); library(phytools);  library(geiger)
#root - Node494
birds_tree = read.tree('anc_kg.tre')
birds_tree$node.label <- NULL
birds_tree_correct = root(birds_tree, outgroup = 'Node494', resolve.root = TRUE)
View(birds_tree)
is.root(birds_tree)
is.rooted(birds_tree)
View(birds_tree)
#root - Node494
birds_tree = read.tree('anc_kg.tre')
birds_tree_correct = root(birds_tree, outgroup = 'Node494', resolve.root = TRUE)
birds_tree_correct = root(birds_tree, node = 'Node494', resolve.root = TRUE)
birds_tree_correct = root(birds_tree, node = 'Node494')
birds_tree$node.label <- NULL
is.rooted(birds_tree)
birds_tree_correct = root(birds_tree, node = 'Node494')
birds_tree_correct = root(birds_tree, node = 494)
birds_tree_correct = root(birds_tree, outgroup = 'Node494')
birds_tree_correct = root(birds_tree, interactive = TRUE)
birds_tree
str(birds_tree)
birds_tree_correct = root(birds_tree, interactive = TRUE)
plot(birds_tree)
birds_tree_correct = read.nexus('Correct_rotted_tree.txt')
birds_tree_correct = read.nexus('Correct_rotted_tree.txt')
birds_tree_correct = read.nexus('Correct_rooted_tree.txt')
is.rooted(birds_tree_correct)
rm(list = ls(all=TRUE))
df_mtdna = read.csv('../../Paper_materials_2024/Birds_dataset_paper.csv')
View(df_mtdna)
rm(list = ls(all=TRUE))
rm(list = ls(all=TRUE))
df = read.csv('midory_to_correct_with_tips.csv')
library(ggplot2)
df_midori = read.csv('Midori2_new_mutspec.csv')
df_mtdna = read.csv('../../Paper_materials_2024/Birds_dataset_paper.csv')
df_midori = df_midori[,c(2,3,4,5,6,7)]
View(df_midori)
View(df_midori)
df_midori1 = reshape(data = df_midori, idvar = 'Species',
timevar = 'Mut',
direction = 'wide')
View(df_midori1)
df_midori = read.csv('Midori2_new_mutspec.csv')
df_midori = df_midori[,c(2,5,6,7)]
df_midori1 = reshape(data = df_midori, idvar = 'Species',
timevar = 'Mut',
direction = 'wide')
View(df_midori1)
warnings()
df_midori$gene_and_species = paste(df_midori$Gene, df_midori$Species)
df_midori$gene_and_species = gsub(' ', '_', df_midori$gene_and_species)
df_midori = df_midori[,c(1,2,5)]
df_midori1 = reshape(data = df_midori, idvar = 'gene_and_species',
timevar = 'Mut',
direction = 'wide')
View(df_midori1)
library(stringr)
df_midori1[,c('gene', 'species_name')] = str_split_fixed(df_midori1$gene_and_species, "_", 2)
df_midori1 = df_midori1[,c(2:15)]
unique(df_midori1$gene)
a = df_midori1[df_midori1$gene == "Cytb",]
nd1 = df_midori1[df_midori1$gene == "ND1",]
nd2 = df_midori1[df_midori1$gene == "ND2",]
nd6 = df_midori1[df_midori1$gene == "ND6",]
cox1 = df_midori1[df_midori1$gene == "CO1",]
cytb = df_midori1[df_midori1$gene == "Cytb",]
atp8 = df_midori1[df_midori1$gene == "A8",]
nd3 = df_midori1[df_midori1$gene == "ND3",]
cox3 = df_midori1[df_midori1$gene == "CO3",]
cox2 = df_midori1[df_midori1$gene == "CO2",]
nd4 = df_midori1[df_midori1$gene == "ND4",]
atp6 = df_midori1[df_midori1$gene == "A6",]
nd5 = df_midori1[df_midori1$gene == "ND5",]
nd4l = df_midori1[df_midori1$gene == "ND4L",]
df_need = data.frame()
for (i in unique(df_mtdna$species_name))
{
a = df_mtdna[df_mtdna$species_name == i,]
b = sum(a$ghahSkew)/12
ab = c(i,b)
df_need = rbind(df_need, ab)
}
View(df_need)
names(df_need) = c('species_name', 'GhAhSkew')
names(df_midori1) = c('Mutation_TC_midori', 'Mutation_GA_midori', 'Mutation_CT_midori', 'Mutation_AG_midori',
'Mutation_AT_midori', 'Mutation_GT_midori', 'Mutation_TA_midori', 'Mutation_CG_midori',
'Mutation_TG_midori', 'Mutation_CA_midori', 'Mutation_GC_midori', 'Mutation_AC_midori',
'gene', 'species_name')
nd1 = df_midori1[df_midori1$gene == "ND1",]
nd2 = df_midori1[df_midori1$gene == "ND2",]
nd6 = df_midori1[df_midori1$gene == "ND6",]
cox1 = df_midori1[df_midori1$gene == "CO1",]
cytb = df_midori1[df_midori1$gene == "Cytb",]
atp8 = df_midori1[df_midori1$gene == "A8",]
nd3 = df_midori1[df_midori1$gene == "ND3",]
cox3 = df_midori1[df_midori1$gene == "CO3",]
cox2 = df_midori1[df_midori1$gene == "CO2",]
nd4 = df_midori1[df_midori1$gene == "ND4",]
atp6 = df_midori1[df_midori1$gene == "A6",]
nd5 = df_midori1[df_midori1$gene == "ND5",]
nd4l = df_midori1[df_midori1$gene == "ND4L",]
df_need = data.frame()
for (i in unique(df_mtdna$species_name))
{
a = df_mtdna[df_mtdna$species_name == i,]
b = sum(a$ghahSkew)/12
ab = c(i,b)
df_need = rbind(df_need, ab)
}
View(df_need)
names(df_need) = c('species_name', 'GhAhSkew')
df_need$species_name = gsub(' ', '_', df_need$species_name)
df_b_cytb = merge(df_need, df_midori1, by = 'species_name')
View(df_b_cytb)
View(df_midori)
View(df_midori1)
View(cytb)
df_b_cytb = merge(df_need, cytb, by = 'species_name')
View(df_b_cytb)
df_b_nd2 = merge(df_need, nd2, by = 'species_name')
View(df_b_nd2)
View(nd2)
df_b_all = merge(df_need, df_midori1, by = 'species_name')
unique(df_b_all$species_name)
View(df_b_nd2)
View(df_b_cytb)
rm(list = ls(all=TRUE))
library(ggplot2)
df_midori = read.csv('Midori2_new_mutspec.csv')
df_midori = df_midori[,c(2,5,6,7)]
df_midori$gene_and_species = paste(df_midori$Gene, df_midori$Species)
df_midori$gene_and_species = gsub(' ', '_', df_midori$gene_and_species)
df_midori = df_midori[,c(1,2,5)]
df_mtdna = read.csv('../../Paper_materials_2024/Birds_dataset_paper.csv')
df_midori1 = reshape(data = df_midori, idvar = 'gene_and_species',
timevar = 'Mut',
direction = 'wide')
library(stringr)
df_midori1[,c('gene', 'species_name')] = str_split_fixed(df_midori1$gene_and_species, "_", 2)
df_midori1 = df_midori1[,c(2:15)]
names(df_midori1) = c('Mutation_TC_midori', 'Mutation_GA_midori', 'Mutation_CT_midori', 'Mutation_AG_midori',
'Mutation_AT_midori', 'Mutation_GT_midori', 'Mutation_TA_midori', 'Mutation_CG_midori',
'Mutation_TG_midori', 'Mutation_CA_midori', 'Mutation_GC_midori', 'Mutation_AC_midori',
'gene', 'species_name')
nd1 = df_midori1[df_midori1$gene == "ND1",]
nd2 = df_midori1[df_midori1$gene == "ND2",]
nd6 = df_midori1[df_midori1$gene == "ND6",]
cox1 = df_midori1[df_midori1$gene == "CO1",]
cytb = df_midori1[df_midori1$gene == "Cytb",]
atp8 = df_midori1[df_midori1$gene == "A8",]
nd3 = df_midori1[df_midori1$gene == "ND3",]
cox3 = df_midori1[df_midori1$gene == "CO3",]
cox2 = df_midori1[df_midori1$gene == "CO2",]
nd4 = df_midori1[df_midori1$gene == "ND4",]
atp6 = df_midori1[df_midori1$gene == "A6",]
nd5 = df_midori1[df_midori1$gene == "ND5",]
nd4l = df_midori1[df_midori1$gene == "ND4L",]
df_need = data.frame()
for (i in unique(df_mtdna$species_name))
{
a = df_mtdna[df_mtdna$species_name == i,]
b = sum(a$ghahSkew)/12
ab = c(i,b)
df_need = rbind(df_need, ab)
}
names(df_need) = c('species_name', 'GhAhSkew')
df_need$species_name = gsub(' ', '_', df_need$species_name)
df_b_cytb = merge(df_need, cytb, by = 'species_name')
df_b_nd2 = merge(df_need, nd2, by = 'species_name')
df_b_all = merge(df_need, df_midori1, by = 'species_name')
View(df_b_all)
View(df_midori)
View(df_mtdna)
View(df_need)
View(df_b_all)
df_fly = read.csv('../../Paper_materials_2024/flying_birds.csv')
View(df_fly)
df_fly = na.omit(df_fly)
df_fly = df_fly[,c(2,3)]
names(df_fly) = c('species_name', 'flightless')
View(df_b_cytb)
View(df_b_all)
df_fly$species_name = gsub(' ', '_')
df_fly$species_name = gsub(' ', '_'. by = 'species_name')
df_fly$species_name = gsub(' ', '_', by = 'species_name')
df_fly$species_name = gsub(' ', '_', df_fly$species_name)
df_check1 = merge(df_b_cytb, df_fly, by = 'species_name')
View(df_check1)
df_check2 = merge(df_b_all, df_fly, by = 'species_name')
View(df_check2)
rm(list = ls(all=TRUE))
library(ggplot2)
df_midori = read.csv('Midori2_new_mutspec.csv')
df_midori = df_midori[,c(2,5,6,7)]
df_midori$gene_and_species = paste(df_midori$Gene, df_midori$Species)
df_midori$gene_and_species = gsub(' ', '_', df_midori$gene_and_species)
df_midori = df_midori[,c(1,2,5)]
df_mtdna = read.csv('../../Paper_materials_2024/Birds_dataset_paper.csv')
df_midori1 = reshape(data = df_midori, idvar = 'gene_and_species',
timevar = 'Mut',
direction = 'wide')
library(stringr)
df_midori1[,c('gene', 'species_name')] = str_split_fixed(df_midori1$gene_and_species, "_", 2)
df_midori1 = df_midori1[,c(2:15)]
names(df_midori1) = c('Mutation_TC_midori', 'Mutation_GA_midori', 'Mutation_CT_midori', 'Mutation_AG_midori',
'Mutation_AT_midori', 'Mutation_GT_midori', 'Mutation_TA_midori', 'Mutation_CG_midori',
'Mutation_TG_midori', 'Mutation_CA_midori', 'Mutation_GC_midori', 'Mutation_AC_midori',
'gene', 'species_name')
nd1 = df_midori1[df_midori1$gene == "ND1",]
nd2 = df_midori1[df_midori1$gene == "ND2",]
nd6 = df_midori1[df_midori1$gene == "ND6",]
cox1 = df_midori1[df_midori1$gene == "CO1",]
cytb = df_midori1[df_midori1$gene == "Cytb",]
atp8 = df_midori1[df_midori1$gene == "A8",]
nd3 = df_midori1[df_midori1$gene == "ND3",]
cox3 = df_midori1[df_midori1$gene == "CO3",]
cox2 = df_midori1[df_midori1$gene == "CO2",]
nd4 = df_midori1[df_midori1$gene == "ND4",]
atp6 = df_midori1[df_midori1$gene == "A6",]
nd5 = df_midori1[df_midori1$gene == "ND5",]
nd4l = df_midori1[df_midori1$gene == "ND4L",]
df_need = data.frame()
for (i in unique(df_mtdna$species_name))
{
a = df_mtdna[df_mtdna$species_name == i,]
b = sum(a$ghahSkew)/12
ab = c(i,b)
df_need = rbind(df_need, ab)
}
names(df_need) = c('species_name', 'GhAhSkew')
df_need$species_name = gsub(' ', '_', df_need$species_name)
df_b_cytb = merge(df_need, cytb, by = 'species_name')
df_b_nd2 = merge(df_need, nd2, by = 'species_name')
df_b_all = merge(df_need, df_midori1, by = 'species_name')
unique(df_b_all$species_name)
df_fly = read.csv('../../Paper_materials_2024/flying_birds.csv')
df_fly = na.omit(df_fly)
df_fly = df_fly[,c(2,3)]
names(df_fly) = c('species_name', 'flightless')
df_fly$species_name = gsub(' ', '_', df_fly$species_name)
df_check1 = merge(df_b_cytb, df_fly, by = 'species_name')
df_check2 = merge(df_b_all, df_fly, by = 'species_name')
View(df_midori1)
avo_data = read.csv('../../Body/1Raw/Avonet_data')
avo_data = read.csv('../../Body/1Raw/Avonet_data.csv')
View(avo_data)
avo_data_check = avo_data[,c(1,3)]
names(avo_data_check) = c('species_name', 'order')
View(avo_data_check)
avo_data_check$species_name = gsub(' ','_', avo_data_check$species_name)
df_check_b = merge(df_midori1, avo_data_check, by = 'species_name')
View(df_check_b)
unique(df_check_b$species_name)
rm(list = ls(all=TRUE))
rm(list = ls(all=TRUE))
library(ggplot2)
df_midori = read.csv('Midori2_new_mutspec.csv')
df_midori = df_midori[,c(2,5,6,7)]
df_midori$gene_and_species = paste(df_midori$Gene, df_midori$Species)
df_midori$gene_and_species = gsub(' ', '_', df_midori$gene_and_species)
df_midori = df_midori[,c(1,2,5)]
df_mtdna = read.csv('../../Paper_materials_2024/Birds_dataset_paper.csv')
df_midori1 = reshape(data = df_midori, idvar = 'gene_and_species',
timevar = 'Mut',
direction = 'wide')
library(stringr)
df_midori1[,c('gene', 'species_name')] = str_split_fixed(df_midori1$gene_and_species, "_", 2)
df_midori1 = df_midori1[,c(2:15)]
names(df_midori1) = c('Mutation_TC_midori', 'Mutation_GA_midori', 'Mutation_CT_midori', 'Mutation_AG_midori',
'Mutation_AT_midori', 'Mutation_GT_midori', 'Mutation_TA_midori', 'Mutation_CG_midori',
'Mutation_TG_midori', 'Mutation_CA_midori', 'Mutation_GC_midori', 'Mutation_AC_midori',
'gene', 'species_name')
nd1 = df_midori1[df_midori1$gene == "ND1",]
nd2 = df_midori1[df_midori1$gene == "ND2",]
nd6 = df_midori1[df_midori1$gene == "ND6",]
cox1 = df_midori1[df_midori1$gene == "CO1",]
cytb = df_midori1[df_midori1$gene == "Cytb",]
atp8 = df_midori1[df_midori1$gene == "A8",]
nd3 = df_midori1[df_midori1$gene == "ND3",]
cox3 = df_midori1[df_midori1$gene == "CO3",]
cox2 = df_midori1[df_midori1$gene == "CO2",]
nd4 = df_midori1[df_midori1$gene == "ND4",]
atp6 = df_midori1[df_midori1$gene == "A6",]
nd5 = df_midori1[df_midori1$gene == "ND5",]
nd4l = df_midori1[df_midori1$gene == "ND4L",]
df_need = data.frame()
for (i in unique(df_mtdna$species_name))
{
a = df_mtdna[df_mtdna$species_name == i,]
b = sum(a$ghahSkew)/12
ab = c(i,b)
df_need = rbind(df_need, ab)
}
names(df_need) = c('species_name', 'GhAhSkew')
df_need$species_name = gsub(' ', '_', df_need$species_name)
df_b_cytb = merge(df_need, cytb, by = 'species_name')
df_b_nd2 = merge(df_need, nd2, by = 'species_name')
df_b_all = merge(df_need, df_midori1, by = 'species_name')
unique(df_b_all$species_name)
df_fly = read.csv('../../Paper_materials_2024/flying_birds.csv')
df_fly = na.omit(df_fly)
df_fly = df_fly[,c(2,3)]
names(df_fly) = c('species_name', 'flightless')
df_fly$species_name = gsub(' ', '_', df_fly$species_name)
df_check1 = merge(df_b_cytb, df_fly, by = 'species_name')
df_check2 = merge(df_b_all, df_fly, by = 'species_name')
avo_data = read.csv('../../Body/1Raw/Avonet_data.csv')
avo_data_check = avo_data[,c(1,3)]
names(avo_data_check) = c('species_name', 'order')
avo_data_check$species_name = gsub(' ','_', avo_data_check$species_name)
df_check_b = merge(df_midori1, avo_data_check, by = 'species_name')
unique(df_check_b$species_name)
View(df_check_b)
df_for_orn = df_check_b[,c(1,15)]
View(df_for_orn)
df_for_orn = unique(df_for_orn)
View(df_for_orn)
write.csv(df_for_orn, file = 'Midori_birds.csv')
rm(list = ls(all=TRUE))
df_midori1 = reshape(data = df_midori, idvar = 'gene_and_species',
timevar = 'Mut',
direction = 'wide')
df_midori = read.csv('Midori2_new_mutspec.csv')
df_midori = df_midori[,c(2,5,6,7)]
df_midori$gene_and_species = paste(df_midori$Gene, df_midori$Species)
df_midori$gene_and_species = gsub(' ', '_', df_midori$gene_and_species)
df_midori = df_midori[,c(1,2,5)]
df_mtdna = read.csv('../../Paper_materials_2024/Birds_dataset_paper.csv')
df_midori1 = reshape(data = df_midori, idvar = 'gene_and_species',
timevar = 'Mut',
direction = 'wide')
library(stringr)
df_midori1[,c('gene', 'species_name')] = str_split_fixed(df_midori1$gene_and_species, "_", 2)
df_midori1 = df_midori1[,c(2:15)]
names(df_midori1) = c('Mutation_TC_midori', 'Mutation_GA_midori', 'Mutation_CT_midori', 'Mutation_AG_midori',
'Mutation_AT_midori', 'Mutation_GT_midori', 'Mutation_TA_midori', 'Mutation_CG_midori',
'Mutation_TG_midori', 'Mutation_CA_midori', 'Mutation_GC_midori', 'Mutation_AC_midori',
'gene', 'species_name')
df_fly = read.csv('../../Paper_materials_2024/flying_birds.csv')
df_dive = read.csv('../../Paper_materials_2024/diving_birds.csv')
df_fly = read.csv('../../Paper_materials_2024/flying_birds.csv')
df_dive = read.csv('../../Paper_materials_2024/dive_and_gene.csv')
View(df_fly)
View(df_dive)
df_fly1 = read.csv('../../Paper_materials_2024/flight_and_gene.csv')
View(df_dive)
View(df_fly)
rm(df_dive)
rm(df_fly1)
avo_data = read.csv('../../Body/1Raw/Avonet_data.csv')
names_v = unique(df_mtdna$species_name)
df_short = data.frame()
for (i in names_v)
{
df1 = df_mtdna[df_mtdna$species_name == i,]
a = sum(df1$ghahSkew)/12
b = sum(df1$chthSkew)/12
v = sum(df1$Mass)/12
ab = c(i, a, b, v)
df_short = rbind(df_short, ab)
}
df_short = data.frame()
for (i in names_v)
{
df1 = df_mtdna[df_mtdna$species_name == i,]
a = sum(df1$ghahSkew)/12
b = sum(df1$chthSkew)/12
ab = c(i, a, b)
df_short = rbind(df_short, ab)
}
View(df_short)
names(df_short) = c('Species', 'GhAhSkew', 'ThChSkew')
names(df_short) = c('species_name', 'GhAhSkew', 'ThChSkew')
df_fly = df_fly[,c(2,3,4)]
names(df_fly) = c('species_name', 'ability_to_fly', 'ability_to_dive')
View(df_midori)
df_midori = read.csv('Midori2_new_mutspec.csv')
df_midori = df_midori[,c(2,5,6,7)]
df_midori$gene_and_species = paste(df_midori$Gene, df_midori$Species)
df_midori$gene_and_species = gsub(' ', '_', df_midori$gene_and_species)
df_midori = df_midori[,c(1,2,5)]
df_midori1 = reshape(data = df_midori, idvar = 'gene_and_species',
timevar = 'Mut',
direction = 'wide')
library(stringr)
df_midori1[,c('gene', 'species_name')] = str_split_fixed(df_midori1$gene_and_species, "_", 2)
df_midori1 = df_midori1[,c(2:15)]
names(df_midori1) = c('Mutation_TC_midori', 'Mutation_GA_midori', 'Mutation_CT_midori', 'Mutation_AG_midori',
'Mutation_AT_midori', 'Mutation_GT_midori', 'Mutation_TA_midori', 'Mutation_CG_midori',
'Mutation_TG_midori', 'Mutation_CA_midori', 'Mutation_GC_midori', 'Mutation_AC_midori',
'gene', 'species_name')
View(df_midori1)
df_midori1$species_name = gsub('_', ' ', df_midori1$species_name)
View(avo_data)
library(dplyr)
View(df_fly)
df_fly = na.omit(df_fly)
df_big = full_join(df_short, df_fly)
View(df_big)
df_big1 = full_join(df_big, df_midori1)
View(df_midori1)
View(avo_data)
rm(list = ls(all=TRUE))
library(ggplot2)
df_midori = read.csv('Midori2_new_mutspec.csv')
df_midori = df_midori[,c(2,5,6,7)]
df_midori$gene_and_species = paste(df_midori$Gene, df_midori$Species)
df_midori$gene_and_species = gsub(' ', '_', df_midori$gene_and_species)
df_midori = df_midori[,c(1,2,5)]
df_mtdna = read.csv('../../Paper_materials_2024/Birds_dataset_paper.csv')
df_midori1 = reshape(data = df_midori, idvar = 'gene_and_species',
timevar = 'Mut',
direction = 'wide')
library(stringr)
df_midori1[,c('gene', 'species_name')] = str_split_fixed(df_midori1$gene_and_species, "_", 2)
df_midori1 = df_midori1[,c(2:15)]
names(df_midori1) = c('Mutation_TC_midori', 'Mutation_GA_midori', 'Mutation_CT_midori', 'Mutation_AG_midori',
'Mutation_AT_midori', 'Mutation_GT_midori', 'Mutation_TA_midori', 'Mutation_CG_midori',
'Mutation_TG_midori', 'Mutation_CA_midori', 'Mutation_GC_midori', 'Mutation_AC_midori',
'gene', 'Species3')
View(df_midori1)
df_midori1$Species3 = gsub('_', ' ', df_midori1$Species3)
df_fly = read.csv('../../Paper_materials_2024/flying_birds.csv')
df_fly = df_fly[,c(2,3,4)]
names(df_fly) = c('Species3', 'ability_to_fly', 'ability_to_dive')
avo_data = read.csv('../../Body/1Raw/Avonet_data.csv')
names_v = unique(df_mtdna$species_name)
df_short = data.frame()
for (i in names_v)
{
df1 = df_mtdna[df_mtdna$species_name == i,]
a = sum(df1$ghahSkew)/12
b = sum(df1$chthSkew)/12
ab = c(i, a, b)
df_short = rbind(df_short, ab)
}
names(df_short) = c('Species3', 'GhAhSkew', 'ThChSkew')
df_fly = na.omit(df_fly)
View(df_fly)
View(df_short)
View(avo_data)
library(dplyr)
df_big = full_join(df_short, df_fly)
df_midori_birds = merge(df_midori1, avo_data, by = 'Species3')
View(df_midori_birds)
names_v1 = unique(df_midori_birds$Species3)
df_short1 = data.frame()
for (i in names_v1)
{
df1 = df_midori_birds[df_midori_birds$Species3 == i,]
a = (sum(df1$Mutation_AG_midori))/(nrow(df1))
b = (sum(df1$Mutation_CT_midori))/(nrow(df1))
ab = c(i, a, b)
df_short1 = rbind(df_short1, ab)
}
View(df_short1)
names(df_short1) = c('Species3', 'Mutation_AG_midori', 'Mutation_CT_midori')
library(dplyr)
rm(df_big)
df_big = full_join(df_short, df_fly)
View(df_short1)
#df_midori_birds = merge(df_midori1, avo_data, by = 'Species3')
df_big1 = full_join(df_big, df_short1)
df_big2 = full_join(df_big1, avo_data)
View(df_big2)
write.csv(df_big2, file = 'big_birds_new_data.csv')
rm(list = ls(all=TRUE))
